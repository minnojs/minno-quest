var minnoQuest=function(){"use strict";!function(e,t,n){function r(e){return function(){var t,n,r,i=arguments[0],o="["+(e?e+":":"")+i+"] ",a=arguments[1],s=arguments;for(t=(t=o+a.replace(/\{\d+\}/g,function(e){var t,n=+e.slice(1,-1);return n+2<s.length?"function"==typeof(t=s[n+2])?t.toString().replace(/ ?\{[\s\S]*$/,""):void 0===t?"undefined":"string"!=typeof t?te(t):t:e}))+"\nhttp://errors.angularjs.org/1.2.27/"+(e?e+"/":"")+i,n=2;n<arguments.length;n++)t=t+(2==n?"?":"&")+"p"+(n-2)+"="+encodeURIComponent("function"==typeof(r=arguments[n])?r.toString().replace(/ \{[\s\S]*$/,""):void 0===r?"undefined":"string"!=typeof r?JSON.stringify(r):r);return new Error(t)}}var i="validity",o=function(e){return D(e)?e.toLowerCase():e},a=Object.prototype.hasOwnProperty,s=function(e){return D(e)?e.toUpperCase():e};"i"!=="I".toLowerCase()&&(o=function(e){return D(e)?e.replace(/[A-Z]/g,function(e){return String.fromCharCode(32|e.charCodeAt(0))}):e},s=function(e){return D(e)?e.replace(/[a-z]/g,function(e){return String.fromCharCode(-33&e.charCodeAt(0))}):e});var u,l,c,f,d,p=[].slice,h=[].push,m=Object.prototype.toString,v=r("ng"),g=e.angular||(e.angular={}),$=["0","0","0"];function y(e){if(null==e||U(e))return!1;var t=e.length;return!(1!==e.nodeType||!t)||(D(e)||N(e)||0===t||"number"==typeof t&&t>0&&t-1 in e)}function w(e,t,n){var r;if(e)if(F(e))for(r in e)"prototype"==r||"length"==r||"name"==r||e.hasOwnProperty&&!e.hasOwnProperty(r)||t.call(n,e[r],r);else if(N(e)||y(e))for(r=0;r<e.length;r++)t.call(n,e[r],r);else if(e.forEach&&e.forEach!==w)e.forEach(t,n);else for(r in e)e.hasOwnProperty(r)&&t.call(n,e[r],r);return e}function b(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t.sort()}function x(e){return function(t,n){e(n,t)}}function C(){for(var e,t=$.length;t;){if(57==(e=$[--t].charCodeAt(0)))return $[t]="A",$.join("");if(90!=e)return $[t]=String.fromCharCode(e+1),$.join("");$[t]="0"}return $.unshift("0"),$.join("")}function S(e,t){t?e.$$hashKey=t:delete e.$$hashKey}function E(e){var t=e.$$hashKey;return w(arguments,function(t){t!==e&&w(t,function(t,n){e[n]=t})}),S(e,t),e}function q(e){return parseInt(e,10)}function k(e,t){return E(new(E(function(){},{prototype:e})),t)}function _(){}function A(e){return e}function P(e){return function(){return e}}function M(e){return void 0===e}function T(e){return void 0!==e}function j(e){return null!=e&&"object"==typeof e}function D(e){return"string"==typeof e}function O(e){return"number"==typeof e}function R(e){return"[object Date]"===m.call(e)}u=q((/msie (\d+)/.exec(o(navigator.userAgent))||[])[1]),isNaN(u)&&(u=q((/trident\/.*; rv:(\d+)/.exec(o(navigator.userAgent))||[])[1])),_.$inject=[],A.$inject=[];var N=F(Array.isArray)?Array.isArray:function(e){return"[object Array]"===m.call(e)};function F(e){return"function"==typeof e}function I(e){return"[object RegExp]"===m.call(e)}function U(e){return e&&e.document&&e.location&&e.alert&&e.setInterval}function L(e){return e&&e.$evalAsync&&e.$watch}function V(e){return e&&F(e.then)}var B=String.prototype.trim?function(e){return D(e)?e.trim():e}:function(e){return D(e)?e.replace(/^\s\s*/,"").replace(/\s\s*$/,""):e};function z(e){return!(!e||!(e.nodeName||e.prop&&e.attr&&e.find))}function H(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0;n<e.length;n++)if(t===e[n])return n;return-1}function W(e,t){var n=H(e,t);return n>=0&&e.splice(n,1),t}function G(e,t,n,r){if(U(e)||L(e))throw v("cpws","Can't copy! Making copies of Window or Scope instances is not supported.");if(t){if(e===t)throw v("cpi","Can't copy! Source and destination are identical.");if(n=n||[],r=r||[],j(e)){var i=H(n,e);if(-1!==i)return r[i];n.push(e),r.push(t)}var o;if(N(e)){t.length=0;for(var a=0;a<e.length;a++)o=G(e[a],null,n,r),j(e[a])&&(n.push(e[a]),r.push(o)),t.push(o)}else{var s=t.$$hashKey;for(var u in N(t)?t.length=0:w(t,function(e,n){delete t[n]}),e)o=G(e[u],null,n,r),j(e[u])&&(n.push(e[u]),r.push(o)),t[u]=o;S(t,s)}}else t=e,e&&(N(e)?t=G(e,[],n,r):R(e)?t=new Date(e.getTime()):I(e)?(t=new RegExp(e.source,e.toString().match(/[^\/]*$/)[0])).lastIndex=e.lastIndex:j(e)&&(t=G(e,{},n,r)));return t}function Q(e,t){if(N(e)){t=t||[];for(var n=0;n<e.length;n++)t[n]=e[n]}else if(j(e))for(var r in t=t||{},e)!a.call(e,r)||"$"===r.charAt(0)&&"$"===r.charAt(1)||(t[r]=e[r]);return t||e}function X(e,t){if(e===t)return!0;if(null===e||null===t)return!1;if(e!=e&&t!=t)return!0;var r,i,o,a=typeof e;if(a==typeof t&&"object"==a){if(!N(e)){if(R(e))return!!R(t)&&(isNaN(e.getTime())&&isNaN(t.getTime())||e.getTime()===t.getTime());if(I(e)&&I(t))return e.toString()==t.toString();if(L(e)||L(t)||U(e)||U(t)||N(t))return!1;for(i in o={},e)if("$"!==i.charAt(0)&&!F(e[i])){if(!X(e[i],t[i]))return!1;o[i]=!0}for(i in t)if(!o.hasOwnProperty(i)&&"$"!==i.charAt(0)&&t[i]!==n&&!F(t[i]))return!1;return!0}if(!N(t))return!1;if((r=e.length)==t.length){for(i=0;i<r;i++)if(!X(e[i],t[i]))return!1;return!0}}return!1}d=u<9?function(e){return(e=e.nodeName?e:e[0]).scopeName&&"HTML"!=e.scopeName?s(e.scopeName+":"+e.nodeName):e.nodeName}:function(e){return e.nodeName?e.nodeName:e[0].nodeName};var Y=function(){if(T(Y.isActive_))return Y.isActive_;var e=!(!t.querySelector("[ng-csp]")&&!t.querySelector("[data-ng-csp]"));if(!e)try{new Function("")}catch(t){e=!0}return Y.isActive_=e};function J(e,t,n){return e.concat(p.call(t,n))}function K(e,t){return p.call(e,t||0)}function Z(e,t){var n=arguments.length>2?K(arguments,2):[];return!F(t)||t instanceof RegExp?t:n.length?function(){return arguments.length?t.apply(e,n.concat(p.call(arguments,0))):t.apply(e,n)}:function(){return arguments.length?t.apply(e,arguments):t.call(e)}}function ee(e,r){var i=r;return"string"==typeof e&&"$"===e.charAt(0)?i=n:U(r)?i="$WINDOW":r&&t===r?i="$DOCUMENT":L(r)&&(i="$SCOPE"),i}function te(e,t){return void 0===e?n:JSON.stringify(e,ee,t?"  ":null)}function ne(e){return D(e)?JSON.parse(e):e}function re(e){if("function"==typeof e)e=!0;else if(e&&0!==e.length){var t=o(""+e);e=!("f"==t||"0"==t||"false"==t||"no"==t||"n"==t||"[]"==t)}else e=!1;return e}function ie(e){e=l(e).clone();try{e.empty()}catch(e){}var t=l("<div>").append(e).html();try{return 3===e[0].nodeType?o(t):t.match(/^(<[^>]+>)/)[1].replace(/^<([\w\-]+)/,function(e,t){return"<"+o(t)})}catch(e){return o(t)}}function oe(e){try{return decodeURIComponent(e)}catch(e){}}function ae(e){var t,n,r={};return w((e||"").split("&"),function(e){if(e&&(t=e.replace(/\+/g,"%20").split("="),T(n=oe(t[0])))){var i=!T(t[1])||oe(t[1]);a.call(r,n)?N(r[n])?r[n].push(i):r[n]=[r[n],i]:r[n]=i}}),r}function se(e){var t=[];return w(e,function(e,n){N(e)?w(e,function(e){t.push(le(n,!0)+(!0===e?"":"="+le(e,!0)))}):t.push(le(n,!0)+(!0===e?"":"="+le(e,!0)))}),t.length?t.join("&"):""}function ue(e){return le(e,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function le(e,t){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,t?"%20":"+")}function ce(n,r){var i=function(){if((n=l(n)).injector()){var e=n[0]===t?"document":ie(n);throw v("btstrpd","App Already Bootstrapped with this Element '{0}'",e.replace(/</,"&lt;").replace(/>/,"&gt;"))}(r=r||[]).unshift(["$provide",function(e){e.value("$rootElement",n)}]),r.unshift("ng");var i=st(r);return i.invoke(["$rootScope","$rootElement","$compile","$injector","$animate",function(e,t,n,r,i){e.$apply(function(){t.data("$injector",r),n(t)(e)})}]),i},o=/^NG_DEFER_BOOTSTRAP!/;if(e&&!o.test(e.name))return i();e.name=e.name.replace(o,""),g.resumeBootstrap=function(e){w(e,function(e){r.push(e)}),i()}}var fe=/[A-Z]/g;function de(e,t){return t=t||"_",e.replace(fe,function(e,n){return(n?t:"")+e.toLowerCase()})}function pe(e,t,n){if(!e)throw v("areq","Argument '{0}' is {1}",t||"?",n||"required");return e}function he(e,t,n){return n&&N(e)&&(e=e[e.length-1]),pe(F(e),t,"not a function, got "+(e&&"object"==typeof e?e.constructor.name||"Object":typeof e)),e}function me(e,t){if("hasOwnProperty"===e)throw v("badname","hasOwnProperty is not a valid {0} name",t)}function ve(e,t,n){if(!t)return e;for(var r,i=t.split("."),o=e,a=i.length,s=0;s<a;s++)r=i[s],e&&(e=(o=e)[r]);return!n&&F(e)?Z(o,e):e}function ge(e){var t=e[0],n=e[e.length-1];if(t===n)return l(t);var r=t,i=[r];do{if(!(r=r.nextSibling))break;i.push(r)}while(r!==n);return l(i)}var $e={full:"1.2.27",major:1,minor:2,dot:27,codeName:"prime-factorization"};Oe.expando="ng339";var ye=Oe.cache={},we=1,be=e.document.addEventListener?function(e,t,n){e.addEventListener(t,n,!1)}:function(e,t,n){e.attachEvent("on"+t,n)},xe=e.document.removeEventListener?function(e,t,n){e.removeEventListener(t,n,!1)}:function(e,t,n){e.detachEvent("on"+t,n)};Oe._data=function(e){return this.cache[e[this.expando]]||{}};var Ce=/([\:\-\_]+(.))/g,Se=/^moz([A-Z])/,Ee=r("jqLite");function qe(e){return e.replace(Ce,function(e,t,n,r){return r?n.toUpperCase():n}).replace(Se,"Moz$1")}function ke(e,t,n,r){var i=c.fn[e];function o(e){var o,a,s,u,f,d,p,h=n&&e?[this.filter(e)]:[this],m=t;if(!r||null!=e)for(;h.length;)for(a=0,s=(o=h.shift()).length;a<s;a++)for(u=l(o[a]),m?u.triggerHandler("$destroy"):m=!m,f=0,d=(p=u.children()).length;f<d;f++)h.push(c(p[f]));return i.apply(this,arguments)}i=i.$original||i,o.$original=i,c.fn[e]=o}var _e=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,Ae=/<|&#?\w+;/,Pe=/<([\w:]+)/,Me=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Te={option:[1,'<select multiple="multiple">',"</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function je(e){return!Ae.test(e)}function De(e,n){var r;return n=n||t,(r=_e.exec(e))?[n.createElement(r[1])]:function(e,t){var n,r,i,o,a,s,u=t.createDocumentFragment(),l=[];if(je(e))l.push(t.createTextNode(e));else{for(n=u.appendChild(t.createElement("div")),r=(Pe.exec(e)||["",""])[1].toLowerCase(),i=Te[r]||Te._default,n.innerHTML="<div>&#160;</div>"+i[1]+e.replace(Me,"<$1></$2>")+i[2],n.removeChild(n.firstChild),o=i[0];o--;)n=n.lastChild;for(a=0,s=n.childNodes.length;a<s;++a)l.push(n.childNodes[a]);(n=u.firstChild).textContent=""}return u.textContent="",u.innerHTML="",l}(e,n)}function Oe(e){if(e instanceof Oe)return e;if(D(e)&&(e=B(e)),!(this instanceof Oe)){if(D(e)&&"<"!=e.charAt(0))throw Ee("nosel","Looking up elements via selectors is not supported by jqLite! See: http://docs.angularjs.org/api/angular.element");return new Oe(e)}D(e)?(He(this,De(e)),l(t.createDocumentFragment()).append(this)):He(this,e)}function Re(e){return e.cloneNode(!0)}function Ne(e){Ie(e);for(var t=0,n=e.childNodes||[];t<n.length;t++)Ne(n[t])}function Fe(e,t,n,r){if(T(r))throw Ee("offargs","jqLite#off() does not support the `selector` argument");var i=Ue(e,"events");Ue(e,"handle")&&(M(t)?w(i,function(t,n){xe(e,n,t),delete i[n]}):w(t.split(" "),function(t){M(n)?(xe(e,t,i[t]),delete i[t]):W(i[t]||[],n)}))}function Ie(e,t){var r=e.ng339,i=ye[r];if(i){if(t)return void delete ye[r].data[t];i.handle&&(i.events.$destroy&&i.handle({},"$destroy"),Fe(e)),delete ye[r],e.ng339=n}}function Ue(e,t,n){var r=e.ng339,i=ye[r||-1];if(!T(n))return i&&i[t];i||(e.ng339=r=++we,i=ye[r]={}),i[t]=n}function Le(e,t,n){var r=Ue(e,"data"),i=T(n),o=!i&&T(t),a=o&&!j(t);if(r||a||Ue(e,"data",r={}),i)r[t]=n;else{if(!o)return r;if(a)return r&&r[t];E(r,t)}}function Ve(e,t){return!!e.getAttribute&&(" "+(e.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").indexOf(" "+t+" ")>-1}function Be(e,t){t&&e.setAttribute&&w(t.split(" "),function(t){e.setAttribute("class",B((" "+(e.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").replace(" "+B(t)+" "," ")))})}function ze(e,t){if(t&&e.setAttribute){var n=(" "+(e.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ");w(t.split(" "),function(e){e=B(e),-1===n.indexOf(" "+e+" ")&&(n+=e+" ")}),e.setAttribute("class",B(n))}}function He(e,t){if(t){t=t.nodeName||!T(t.length)||U(t)?[t]:t;for(var n=0;n<t.length;n++)e.push(t[n])}}function We(e,t){return Ge(e,"$"+(t||"ngController")+"Controller")}function Ge(e,t,r){9==e.nodeType&&(e=e.documentElement);for(var i=N(t)?t:[t];e;){for(var o=0,a=i.length;o<a;o++)if((r=l.data(e,i[o]))!==n)return r;e=e.parentNode||11===e.nodeType&&e.host}}function Qe(e){for(var t=0,n=e.childNodes;t<n.length;t++)Ne(n[t]);for(;e.firstChild;)e.removeChild(e.firstChild)}Te.optgroup=Te.option,Te.tbody=Te.tfoot=Te.colgroup=Te.caption=Te.thead,Te.th=Te.td;var Xe=Oe.prototype={ready:function(n){var r=!1;function i(){r||(r=!0,n())}"complete"===t.readyState?setTimeout(i):(this.on("DOMContentLoaded",i),Oe(e).on("load",i))},toString:function(){var e=[];return w(this,function(t){e.push(""+t)}),"["+e.join(", ")+"]"},eq:function(e){return l(e>=0?this[e]:this[this.length+e])},length:0,push:h,sort:[].sort,splice:[].splice},Ye={};w("multiple,selected,checked,disabled,readOnly,required,open".split(","),function(e){Ye[o(e)]=e});var Je={};function Ke(e,t){var n=Ye[t.toLowerCase()];return n&&Je[e.nodeName]&&n}function Ze(e,t){var r,i=typeof e;return"function"==i||"object"==i&&null!==e?"function"==typeof(r=e.$$hashKey)?r=e.$$hashKey():r===n&&(r=e.$$hashKey=(t||C)()):r=e,i+":"+r}function et(e,t){if(t){var n=0;this.nextUid=function(){return++n}}w(e,this.put,this)}w("input,select,option,textarea,button,form,details".split(","),function(e){Je[s(e)]=!0}),w({data:Le,removeData:Ie},function(e,t){Oe[t]=e}),w({data:Le,inheritedData:Ge,scope:function(e){return l.data(e,"$scope")||Ge(e.parentNode||e,["$isolateScope","$scope"])},isolateScope:function(e){return l.data(e,"$isolateScope")||l.data(e,"$isolateScopeNoTemplate")},controller:We,injector:function(e){return Ge(e,"$injector")},removeAttr:function(e,t){e.removeAttribute(t)},hasClass:Ve,css:function(e,t,r){var i;if(t=qe(t),!T(r))return u<=8&&""===(i=e.currentStyle&&e.currentStyle[t])&&(i="auto"),i=i||e.style[t],u<=8&&(i=""===i?n:i),i;e.style[t]=r},attr:function(e,t,r){var i=o(t);if(Ye[i]){if(!T(r))return e[t]||(e.attributes.getNamedItem(t)||_).specified?i:n;r?(e[t]=!0,e.setAttribute(t,i)):(e[t]=!1,e.removeAttribute(i))}else if(T(r))e.setAttribute(t,r);else if(e.getAttribute){var a=e.getAttribute(t,2);return null===a?n:a}},prop:function(e,t,n){if(!T(n))return e[t];e[t]=n},text:function(){var e=[];return u<9?(e[1]="innerText",e[3]="nodeValue"):e[1]=e[3]="textContent",t.$dv="",t;function t(t,n){var r=e[t.nodeType];if(M(n))return r?t[r]:"";t[r]=n}}(),val:function(e,t){if(M(t)){if("SELECT"===d(e)&&e.multiple){var n=[];return w(e.options,function(e){e.selected&&n.push(e.value||e.text)}),0===n.length?null:n}return e.value}e.value=t},html:function(e,t){if(M(t))return e.innerHTML;for(var n=0,r=e.childNodes;n<r.length;n++)Ne(r[n]);e.innerHTML=t},empty:Qe},function(e,t){Oe.prototype[t]=function(t,r){var i,o,a=this.length;if(e!==Qe&&(2==e.length&&e!==Ve&&e!==We?t:r)===n){if(j(t)){for(i=0;i<a;i++)if(e===Le)e(this[i],t);else for(o in t)e(this[i],o,t[o]);return this}for(var s=e.$dv,u=s===n?Math.min(a,1):a,l=0;l<u;l++){var c=e(this[l],t,r);s=s?s+c:c}return s}for(i=0;i<a;i++)e(this[i],t,r);return this}}),w({removeData:Ie,dealoc:Ne,on:function e(n,r,i,o){if(T(o))throw Ee("onargs","jqLite#on() does not support the `selector` or `eventData` parameters");var a,s,l,c=Ue(n,"events"),f=Ue(n,"handle");c||Ue(n,"events",c={}),f||Ue(n,"handle",(s=c,(l=function(e,n){if(e.preventDefault||(e.preventDefault=function(){e.returnValue=!1}),e.stopPropagation||(e.stopPropagation=function(){e.cancelBubble=!0}),e.target||(e.target=e.srcElement||t),M(e.defaultPrevented)){var r=e.preventDefault;e.preventDefault=function(){e.defaultPrevented=!0,r.call(e)},e.defaultPrevented=!1}e.isDefaultPrevented=function(){return e.defaultPrevented||!1===e.returnValue},w(Q(s[n||e.type]||[]),function(t){t.call(a,e)}),u<=8?(e.preventDefault=null,e.stopPropagation=null,e.isDefaultPrevented=null):(delete e.preventDefault,delete e.stopPropagation,delete e.isDefaultPrevented)}).elem=a=n,f=l)),w(r.split(" "),function(r){var o=c[r];if(!o){if("mouseenter"==r||"mouseleave"==r){var a=t.body.contains||t.body.compareDocumentPosition?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1};c[r]=[];e(n,{mouseleave:"mouseout",mouseenter:"mouseover"}[r],function(e){var t=e.relatedTarget;t&&(t===this||a(this,t))||f(e,r)})}else be(n,r,f),c[r]=[];o=c[r]}o.push(i)})},off:Fe,one:function(e,t,n){(e=l(e)).on(t,function r(){e.off(t,n),e.off(t,r)}),e.on(t,n)},replaceWith:function(e,t){var n,r=e.parentNode;Ne(e),w(new Oe(t),function(t){n?r.insertBefore(t,n.nextSibling):r.replaceChild(t,e),n=t})},children:function(e){var t=[];return w(e.childNodes,function(e){1===e.nodeType&&t.push(e)}),t},contents:function(e){return e.contentDocument||e.childNodes||[]},append:function(e,t){w(new Oe(t),function(t){1!==e.nodeType&&11!==e.nodeType||e.appendChild(t)})},prepend:function(e,t){if(1===e.nodeType){var n=e.firstChild;w(new Oe(t),function(t){e.insertBefore(t,n)})}},wrap:function(e,t){t=l(t)[0];var n=e.parentNode;n&&n.replaceChild(t,e),t.appendChild(e)},remove:function(e){Ne(e);var t=e.parentNode;t&&t.removeChild(e)},after:function(e,t){var n=e,r=e.parentNode;w(new Oe(t),function(e){r.insertBefore(e,n.nextSibling),n=e})},addClass:ze,removeClass:Be,toggleClass:function(e,t,n){t&&w(t.split(" "),function(t){var r=n;M(r)&&(r=!Ve(e,t)),(r?ze:Be)(e,t)})},parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},next:function(e){if(e.nextElementSibling)return e.nextElementSibling;for(var t=e.nextSibling;null!=t&&1!==t.nodeType;)t=t.nextSibling;return t},find:function(e,t){return e.getElementsByTagName?e.getElementsByTagName(t):[]},clone:Re,triggerHandler:function(e,t,n){var r,i,o,a=t.type||t,s=(Ue(e,"events")||{})[a];s&&(r={preventDefault:function(){this.defaultPrevented=!0},isDefaultPrevented:function(){return!0===this.defaultPrevented},stopPropagation:_,type:a,target:e},t.type&&(r=E(r,t)),i=Q(s),o=n?[r].concat(n):[r],w(i,function(t){t.apply(e,o)}))}},function(e,t){Oe.prototype[t]=function(t,n,r){for(var i,o=0;o<this.length;o++)M(i)?T(i=e(this[o],t,n,r))&&(i=l(i)):He(i,e(this[o],t,n,r));return T(i)?i:this},Oe.prototype.bind=Oe.prototype.on,Oe.prototype.unbind=Oe.prototype.off}),et.prototype={put:function(e,t){this[Ze(e,this.nextUid)]=t},get:function(e){return this[Ze(e,this.nextUid)]},remove:function(e){var t=this[e=Ze(e,this.nextUid)];return delete this[e],t}};var tt=/^function\s*[^\(]*\(\s*([^\)]*)\)/m,nt=/,/,rt=/^\s*(_?)(\S+?)\1\s*$/,it=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,ot=r("$injector");function at(e){var t,n;return"function"==typeof e?(t=e.$inject)||(t=[],e.length&&w(e.toString().replace(it,"").match(tt)[1].split(nt),function(e){e.replace(rt,function(e,n,r){t.push(r)})}),e.$inject=t):N(e)?(he(e[n=e.length-1],"fn"),t=e.slice(0,n)):he(e,"fn",!0),t}function st(e){var t={},n="Provider",r=[],i=new et([],!0),o={$provide:{provider:l(c),factory:l(d),service:l(function(e,t){return d(e,["$injector",function(e){return e.instantiate(t)}])}),value:l(function(e,t){return d(e,P(t))}),constant:l(function(e,t){me(e,"constant"),o[e]=t,s[e]=t}),decorator:function(e,t){var r=a.get(e+n),i=r.$get;r.$get=function(){var e=u.invoke(i,r);return u.invoke(t,null,{$delegate:e})}}}},a=o.$injector=p(o,function(){throw ot("unpr","Unknown provider: {0}",r.join(" <- "))}),s={},u=s.$injector=p(s,function(e){var t=a.get(e+n);return u.invoke(t.$get,t)});return w(function e(t){var n,r,o,s,u=[];w(t,function(t){if(!i.get(t)){i.put(t,!0);try{if(D(t))for(n=f(t),u=u.concat(e(n.requires)).concat(n._runBlocks),r=n._invokeQueue,o=0,s=r.length;o<s;o++){var l=r[o],c=a.get(l[0]);c[l[1]].apply(c,l[2])}else F(t)?u.push(a.invoke(t)):N(t)?u.push(a.invoke(t)):he(t,"module")}catch(e){throw N(t)&&(t=t[t.length-1]),e.message&&e.stack&&-1==e.stack.indexOf(e.message)&&(e=e.message+"\n"+e.stack),ot("modulerr","Failed to instantiate module {0} due to:\n{1}",t,e.stack||e.message||e)}}});return u}(e),function(e){u.invoke(e||_)}),u;function l(e){return function(t,n){if(!j(t))return e(t,n);w(t,x(e))}}function c(e,t){if(me(e,"service"),(F(t)||N(t))&&(t=a.instantiate(t)),!t.$get)throw ot("pget","Provider '{0}' must define $get factory method.",e);return o[e+n]=t}function d(e,t){return c(e,{$get:t})}function p(e,i){function a(n){if(e.hasOwnProperty(n)){if(e[n]===t)throw ot("cdep","Circular dependency found: {0}",n+" <- "+r.join(" <- "));return e[n]}try{return r.unshift(n),e[n]=t,e[n]=i(n)}catch(r){throw e[n]===t&&delete e[n],r}finally{r.shift()}}function s(e,t,n){var r,i,o,s=[],u=at(e);for(i=0,r=u.length;i<r;i++){if("string"!=typeof(o=u[i]))throw ot("itkn","Incorrect injection token! Expected service name as string, got {0}",o);s.push(n&&n.hasOwnProperty(o)?n[o]:a(o))}return N(e)&&(e=e[r]),e.apply(t,s)}return{invoke:s,instantiate:function(e,t){var n,r,i=function(){};return i.prototype=(N(e)?e[e.length-1]:e).prototype,j(r=s(e,n=new i,t))||F(r)?r:n},get:a,annotate:at,has:function(t){return o.hasOwnProperty(t+n)||e.hasOwnProperty(t)}}}}function ut(){var e=!0;this.disableAutoScrolling=function(){e=!1},this.$get=["$window","$location","$rootScope",function(t,n,r){var i=t.document;function a(){var e,r,a,s=n.hash();s?(e=i.getElementById(s))?e.scrollIntoView():(r=i.getElementsByName(s),a=null,w(r,function(e){a||"a"!==o(e.nodeName)||(a=e)}),(e=a)?e.scrollIntoView():"top"===s&&t.scrollTo(0,0)):t.scrollTo(0,0)}return e&&r.$watch(function(){return n.hash()},function(){r.$evalAsync(a)}),a}]}var lt=r("$animate"),ct=["$provide",function(e){this.$$selectors={},this.register=function(t,n){var r=t+"-animation";if(t&&"."!=t.charAt(0))throw lt("notcsel","Expecting class selector starting with '.' got '{0}'.",t);this.$$selectors[t.substr(1)]=r,e.factory(r,n)},this.classNameFilter=function(e){return 1===arguments.length&&(this.$$classNameFilter=e instanceof RegExp?e:null),this.$$classNameFilter},this.$get=["$timeout","$$asyncCallback",function(e,t){function n(e){e&&t(e)}return{enter:function(e,t,r,i){r?r.after(e):(t&&t[0]||(t=r.parent()),t.append(e)),n(i)},leave:function(e,t){e.remove(),n(t)},move:function(e,t,n,r){this.enter(e,t,n,r)},addClass:function(e,t,r){t=D(t)?t:N(t)?t.join(" "):"",w(e,function(e){ze(e,t)}),n(r)},removeClass:function(e,t,r){t=D(t)?t:N(t)?t.join(" "):"",w(e,function(e){Be(e,t)}),n(r)},setClass:function(e,t,r,i){w(e,function(e){ze(e,t),Be(e,r)}),n(i)},enabled:_}}]}];function ft(){this.$get=["$$rAF","$timeout",function(e,t){return e.supported?function(t){return e(t)}:function(e){return t(e,0,!1)}}]}function dt(e,t,r,i){var o=this,a=t[0],s=e.location,u=e.history,c=e.setTimeout,f=e.clearTimeout,d={};o.isMock=!1;var p=0,h=[];function m(e){try{e.apply(null,K(arguments,1))}finally{if(0===--p)for(;h.length;)try{h.pop()()}catch(e){r.error(e)}}}o.$$completeOutstandingRequest=m,o.$$incOutstandingRequestCount=function(){p++},o.notifyWhenNoOutstandingRequests=function(e){w(g,function(e){e()}),0===p?e():h.push(e)};var v,g=[];o.addPollFn=function(e){var t,n;return M(v)&&(t=100,n=c,function e(){w(g,function(e){e()}),v=n(e,t)}()),g.push(e),e};var $=s.href,y=t.find("base"),b=null;o.url=function(t,n){if(s!==e.location&&(s=e.location),u!==e.history&&(u=e.history),t){if($==t)return;var r=$&&Vt($)===Vt(t);return $=t,!r&&i.history?n?u.replaceState(null,"",t):(u.pushState(null,"",t),y.attr("href",y.attr("href"))):(r||(b=t),n?s.replace(t):s.href=t),o}return b||s.href.replace(/%27/g,"'")};var x=[],C=!1;function S(){$!=o.url()&&($=o.url(),w(x,function(e){e(o.url())}))}o.onUrlChange=function(t){return C||(i.history&&l(e).on("popstate",S),i.hashchange?l(e).on("hashchange",S):o.addPollFn(S),C=!0),x.push(t),t},o.$$checkUrlChange=S,o.baseHref=function(){var e=y.attr("href");return e?e.replace(/^(https?\:)?\/\/[^\/]*/,""):""};var E={},q="",k=o.baseHref();o.cookies=function(e,t){var i,o,s,u,l;if(!e){if(a.cookie!==q)for(o=(q=a.cookie).split("; "),E={},u=0;u<o.length;u++)(l=(s=o[u]).indexOf("="))>0&&(e=unescape(s.substring(0,l)),E[e]===n&&(E[e]=unescape(s.substring(l+1))));return E}t===n?a.cookie=escape(e)+"=;path="+k+";expires=Thu, 01 Jan 1970 00:00:00 GMT":D(t)&&(i=(a.cookie=escape(e)+"="+escape(t)+";path="+k).length+1)>4096&&r.warn("Cookie '"+e+"' possibly not set or overflowed because it was too large ("+i+" > 4096 bytes)!")},o.defer=function(e,t){var n;return p++,n=c(function(){delete d[n],m(e)},t||0),d[n]=!0,n},o.defer.cancel=function(e){return!!d[e]&&(delete d[e],f(e),m(_),!0)}}function pt(){this.$get=["$window","$log","$sniffer","$document",function(e,t,n,r){return new dt(e,r,t,n)}]}function ht(){this.$get=function(){var e={};function t(t,n){if(t in e)throw r("$cacheFactory")("iid","CacheId '{0}' is already taken!",t);var i=0,o=E({},n,{id:t}),a={},s=n&&n.capacity||Number.MAX_VALUE,u={},l=null,c=null;return e[t]={put:function(e,t){s<Number.MAX_VALUE&&f(u[e]||(u[e]={key:e}));if(!M(t))return e in a||i++,a[e]=t,i>s&&this.remove(c.key),t},get:function(e){if(s<Number.MAX_VALUE){var t=u[e];if(!t)return;f(t)}return a[e]},remove:function(e){if(s<Number.MAX_VALUE){var t=u[e];if(!t)return;t==l&&(l=t.p),t==c&&(c=t.n),d(t.n,t.p),delete u[e]}delete a[e],i--},removeAll:function(){a={},i=0,u={},l=c=null},destroy:function(){a=null,o=null,u=null,delete e[t]},info:function(){return E({},o,{size:i})}};function f(e){e!=l&&(c?c==e&&(c=e.n):c=e,d(e.n,e.p),d(e,l),(l=e).n=null)}function d(e,t){e!=t&&(e&&(e.p=t),t&&(t.n=e))}}return t.info=function(){var t={};return w(e,function(e,n){t[n]=e.info()}),t},t.get=function(t){return e[t]},t}}function mt(){this.$get=["$cacheFactory",function(e){return e("templates")}]}var vt=r("$compile");function gt(e,r){var i={},o="Directive",a=/^\s*directive\:\s*([\d\w_\-]+)\s+(.*)$/,s=/(([\d\w_\-]+)(?:\:([^;]+))?;?)/,c=/^(on[a-z]+|formaction)$/;this.directive=function t(n,r){return me(n,"directive"),D(n)?(pe(r,"directiveFactory"),i.hasOwnProperty(n)||(i[n]=[],e.factory(n+o,["$injector","$exceptionHandler",function(e,t){var r=[];return w(i[n],function(i,o){try{var a=e.invoke(i);F(a)?a={compile:P(a)}:!a.compile&&a.link&&(a.compile=P(a.link)),a.priority=a.priority||0,a.index=o,a.name=a.name||n,a.require=a.require||a.controller&&a.name,a.restrict=a.restrict||"A",r.push(a)}catch(e){t(e)}}),r}])),i[n].push(r)):w(n,x(t)),this},this.aHrefSanitizationWhitelist=function(e){return T(e)?(r.aHrefSanitizationWhitelist(e),this):r.aHrefSanitizationWhitelist()},this.imgSrcSanitizationWhitelist=function(e){return T(e)?(r.imgSrcSanitizationWhitelist(e),this):r.imgSrcSanitizationWhitelist()},this.$get=["$injector","$interpolate","$exceptionHandler","$http","$templateCache","$parse","$controller","$rootScope","$document","$sce","$animate","$$sanitizeUri",function(e,r,f,p,h,m,v,g,$,y,b,x){var C=function(e,t){this.$$element=e,this.$attr=t||{}};C.prototype={$normalize:yt,$addClass:function(e){e&&e.length>0&&b.addClass(this.$$element,e)},$removeClass:function(e){e&&e.length>0&&b.removeClass(this.$$element,e)},$updateClass:function(e,t){var n=wt(e,t),r=wt(t,e);0===n.length?b.removeClass(this.$$element,r):0===r.length?b.addClass(this.$$element,n):b.setClass(this.$$element,n,r)},$set:function(e,t,r,i){var o,a=Ke(this.$$element[0],e);a&&(this.$$element.prop(e,t),i=a),this[e]=t,i?this.$attr[e]=i:(i=this.$attr[e])||(this.$attr[e]=i=de(e,"-")),("A"===(o=d(this.$$element))&&"href"===e||"IMG"===o&&"src"===e)&&(this[e]=t=x(t,"src"===e)),!1!==r&&(null===t||t===n?this.$$element.removeAttr(i):this.$$element.attr(i,t));var s=this.$$observers;s&&w(s[e],function(e){try{e(t)}catch(e){f(e)}})},$observe:function(e,t){var n=this,r=n.$$observers||(n.$$observers={}),i=r[e]||(r[e]=[]);return i.push(t),g.$evalAsync(function(){i.$$inter||t(n[e])}),t}};var S=r.startSymbol(),q=r.endSymbol(),_="{{"==S||"}}"==q?A:function(e){return e.replace(/\{\{/g,S).replace(/}}/g,q)},P=/^ngAttr[A-Z]/;return M;function M(e,t,n,r,i){e instanceof l||(e=l(e)),w(e,function(t,n){3==t.nodeType&&t.nodeValue.match(/\S+/)&&(e[n]=t=l(t).wrap("<span></span>").parent()[0])});var o=O(e,t,e,n,r,i);return T(e,"ng-scope"),function(t,n,r,i){pe(t,"scope");var a=n?Xe.clone.call(e):e;w(r,function(e,t){a.data("$"+t+"Controller",e)});for(var s=0,u=a.length;s<u;s++){var l=a[s].nodeType;1!==l&&9!==l||a.eq(s).data("$scope",t)}return n&&n(a,t),o&&o(t,a,a,i),a}}function T(e,t){try{e.addClass(t)}catch(e){}}function O(e,t,r,i,o,a){for(var s,u,c,f,d,p,h=[],m=0;m<e.length;m++)s=new C,(c=(u=I(e[m],[],s,0===m?i:n,o)).length?V(u,e[m],s,t,r,null,[],[],a):null)&&c.scope&&T(s.$$element,"ng-scope"),d=c&&c.terminal||!(f=e[m].childNodes)||!f.length?null:O(f,c?(c.transcludeOnThisElement||!c.templateOnThisElement)&&c.transclude:t),h.push(c,d),p=p||c||d,a=null;return p?function(e,r,i,o){var a,s,u,c,f,d,p,m,v=r.length,g=new Array(v);for(f=0;f<v;f++)g[f]=r[f];for(f=0,p=0,d=h.length;f<d;p++)u=g[p],a=h[f++],s=h[f++],a?(a.scope?(c=e.$new(),l.data(u,"$scope",c)):c=e,m=a.transcludeOnThisElement?R(e,a.transclude,o):!a.templateOnThisElement&&o?o:!o&&t?R(e,t):null,a(s,c,u,i,m)):s&&s(e,u.childNodes,n,o)}:null}function R(e,t,n){return function(r,i,o){var a=!1;r||((r=e.$new()).$$transcluded=!0,a=!0);var s=t(r,i,o,n);return a&&s.on("$destroy",function(){r.$destroy()}),s}}function I(e,t,n,i,o){var l,c,f,p,h,m=e.nodeType,v=n.$attr;switch(m){case 1:H(t,yt(d(e).toLowerCase()),"E",i,o);for(var g,$,y,w,b,x,C=e.attributes,S=0,E=C&&C.length;S<E;S++){var q=!1,k=!1;if(g=C[S],!u||u>=8||g.specified)$=g.name,b=B(g.value),w=yt($),(x=P.test(w))&&($=de(w.substr(6),"-")),w===w.replace(/(Start|End)$/,"")+"Start"&&(q=$,k=$.substr(0,$.length-5)+"end",$=$.substr(0,$.length-6)),v[y=yt($.toLowerCase())]=$,!x&&n.hasOwnProperty(y)||(n[y]=b,Ke(e,y)&&(n[y]=!0)),Z(e,t,b,y),H(t,y,"A",i,o,q,k)}if(D(c=e.className)&&""!==c)for(;l=s.exec(c);)H(t,y=yt(l[2]),"C",i,o)&&(n[y]=B(l[3])),c=c.substr(l.index+l[0].length);break;case 3:f=t,p=e.nodeValue,(h=r(p,!0))&&f.push({priority:0,compile:function(e){var t=e.parent(),n=t.length;return n&&T(e.parent(),"ng-binding"),function(e,t){var r=t.parent(),i=r.data("$binding")||[];i.push(h),r.data("$binding",i),n||T(r,"ng-binding"),e.$watch(h,function(e){t[0].nodeValue=e})}}});break;case 8:try{(l=a.exec(e.nodeValue))&&H(t,y=yt(l[1]),"M",i,o)&&(n[y]=B(l[2]))}catch(e){}}return t.sort(Y),t}function U(e,t,n){var r=[],i=0;if(t&&e.hasAttribute&&e.hasAttribute(t))do{if(!e)throw vt("uterdir","Unterminated attribute, found '{0}' but no matching '{1}' found.",t,n);1==e.nodeType&&(e.hasAttribute(t)&&i++,e.hasAttribute(n)&&i--),r.push(e),e=e.nextSibling}while(i>0);else r.push(e);return l(r)}function L(e,t,n){return function(r,i,o,a,s){return i=U(i[0],t,n),e(r,i,o,a,s)}}function V(e,i,o,a,s,u,c,d,p){p=p||{};for(var h,g,$,y,b,x,S=-Number.MAX_VALUE,E=p.controllerDirectives,q=p.newIsolateScopeDirective,k=p.templateDirective,A=p.nonTlbTranscludeDirective,P=!1,O=!1,R=p.hasElementTranscludeDirective,V=o.$$element=l(i),H=u,Y=a,Z=0,ne=e.length;Z<ne;Z++){var re=(g=e[Z]).$$start,oe=g.$$end;if(re&&(V=U(i,re,oe)),y=n,S>g.priority)break;if((x=g.scope)&&(h=h||g,g.templateUrl||(J("new/isolated scope",q,g,V),j(x)&&(q=g))),$=g.name,!g.templateUrl&&g.controller&&(x=g.controller,J("'"+$+"' controller",(E=E||{})[$],g,V),E[$]=g),(x=g.transclude)&&(P=!0,g.$$tlb||(J("transclusion",A,g,V),A=g),"element"==x?(R=!0,S=g.priority,y=V,V=o.$$element=l(t.createComment(" "+$+": "+o[$]+" ")),i=V[0],ee(s,K(y),i),Y=M(y,a,S,H&&H.name,{nonTlbTranscludeDirective:A})):(y=l(Re(i)).contents(),V.empty(),Y=M(y,a))),g.template)if(O=!0,J("template",k,g,V),k=g,x=F(g.template)?g.template(V,o):g.template,x=_(x),g.replace){if(H=g,y=je(x)?[]:l(B(x)),i=y[0],1!=y.length||1!==i.nodeType)throw vt("tplrt","Template for directive '{0}' must have exactly one root element. {1}",$,"");ee(s,V,i);var ae={$attr:{}},se=I(i,[],ae),ue=e.splice(Z+1,e.length-(Z+1));q&&z(se),e=e.concat(se).concat(ue),W(o,ae),ne=e.length}else V.html(x);if(g.templateUrl)O=!0,J("template",k,g,V),k=g,g.replace&&(H=g),fe=G(e.splice(Z,e.length-Z),V,o,s,P&&Y,c,d,{controllerDirectives:E,newIsolateScopeDirective:q,templateDirective:k,nonTlbTranscludeDirective:A}),ne=e.length;else if(g.compile)try{F(b=g.compile(V,o,Y))?le(null,b,re,oe):b&&le(b.pre,b.post,re,oe)}catch(e){f(e,ie(V))}g.terminal&&(fe.terminal=!0,S=Math.max(S,g.priority))}return fe.scope=h&&!0===h.scope,fe.transcludeOnThisElement=P,fe.templateOnThisElement=O,fe.transclude=Y,p.hasElementTranscludeDirective=R,fe;function le(e,t,n,r){e&&(n&&(e=L(e,n,r)),e.require=g.require,e.directiveName=$,(q===g||g.$$isolateScope)&&(e=te(e,{isolateScope:!0})),c.push(e)),t&&(n&&(t=L(t,n,r)),t.require=g.require,t.directiveName=$,(q===g||g.$$isolateScope)&&(t=te(t,{isolateScope:!0})),d.push(t))}function ce(e,t,n,r){var i,o="data",a=!1;if(D(t)){for(;"^"==(i=t.charAt(0))||"?"==i;)t=t.substr(1),"^"==i&&(o="inheritedData"),a=a||"?"==i;if(i=null,r&&"data"===o&&(i=r[t]),!(i=i||n[o]("$"+t+"Controller"))&&!a)throw vt("ctreq","Controller '{0}', required by directive '{1}', can't be found!",t,e);return i}return N(t)&&(i=[],w(t,function(t){i.push(ce(e,t,n,r))})),i}function fe(e,t,a,s,u){var p,h,g,$,y,b,x,S,_={};if(p=i===a?o:Q(o,new C(l(a),o.$attr)),h=p.$$element,q){var A=/^\s*([@=&])(\??)\s*(\w*)\s*$/;x=t.$new(!0),!k||k!==q&&k!==q.$$originalDirective?h.data("$isolateScopeNoTemplate",x):h.data("$isolateScope",x),T(h,"ng-isolate-scope"),w(q.scope,function(e,n){var i,o,a,s,u=e.match(A)||[],l=u[3]||n,c="?"==u[2],f=u[1];switch(x.$$isolateBindings[n]=f+l,f){case"@":p.$observe(l,function(e){x[n]=e}),p.$$observers[l].$$scope=t,p[l]&&(x[n]=r(p[l])(t));break;case"=":if(c&&!p[l])return;o=m(p[l]),s=o.literal?X:function(e,t){return e===t||e!=e&&t!=t},a=o.assign||function(){throw i=x[n]=o(t),vt("nonassign","Expression '{0}' used with directive '{1}' is non-assignable!",p[l],q.name)},i=x[n]=o(t),x.$watch(function(){var e=o(t);return s(e,x[n])||(s(e,i)?a(t,e=x[n]):x[n]=e),i=e},null,o.literal);break;case"&":o=m(p[l]),x[n]=function(e){return o(t,e)};break;default:throw vt("iscp","Invalid isolate scope definition for directive '{0}'. Definition: {... {1}: '{2}' ...}",q.name,n,e)}})}for(S=u&&function(e,t){var r;arguments.length<2&&(t=e,e=n);R&&(r=_);return u(e,t,r)},E&&w(E,function(e){var n,r={$scope:e===q||e.$$isolateScope?x:t,$element:h,$attrs:p,$transclude:S};"@"==(b=e.controller)&&(b=p[e.name]),n=v(b,r),_[e.name]=n,R||h.data("$"+e.name+"Controller",n),e.controllerAs&&(r.$scope[e.controllerAs]=n)}),g=0,$=c.length;g<$;g++)try{(y=c[g])(y.isolateScope?x:t,h,p,y.require&&ce(y.directiveName,y.require,h,_),S)}catch(e){f(e,ie(h))}var P=t;for(q&&(q.template||null===q.templateUrl)&&(P=x),e&&e(P,a.childNodes,n,u),g=d.length-1;g>=0;g--)try{(y=d[g])(y.isolateScope?x:t,h,p,y.require&&ce(y.directiveName,y.require,h,_),S)}catch(e){f(e,ie(h))}}}function z(e){for(var t=0,n=e.length;t<n;t++)e[t]=k(e[t],{$$isolateScope:!0})}function H(t,r,a,s,u,l,c){if(r===u)return null;var d=null;if(i.hasOwnProperty(r))for(var p,h=e.get(r+o),m=0,v=h.length;m<v;m++)try{p=h[m],(s===n||s>p.priority)&&-1!=p.restrict.indexOf(a)&&(l&&(p=k(p,{$$start:l,$$end:c})),t.push(p),d=p)}catch(e){f(e)}return d}function W(e,t){var n=t.$attr,r=e.$attr,i=e.$$element;w(e,function(r,i){"$"!=i.charAt(0)&&(t[i]&&t[i]!==r&&(r+=("style"===i?";":" ")+t[i]),e.$set(i,r,!0,n[i]))}),w(t,function(t,o){"class"==o?(T(i,t),e.class=(e.class?e.class+" ":"")+t):"style"==o?(i.attr("style",i.attr("style")+";"+t),e.style=(e.style?e.style+";":"")+t):"$"==o.charAt(0)||e.hasOwnProperty(o)||(e[o]=t,r[o]=n[o])})}function G(e,t,n,r,i,o,a,s){var u,c,f=[],d=t[0],m=e.shift(),v=E({},m,{templateUrl:null,transclude:null,replace:null,$$originalDirective:m}),g=F(m.templateUrl)?m.templateUrl(t,n):m.templateUrl;return t.empty(),p.get(y.getTrustedResourceUrl(g),{cache:h}).success(function(p){var h,$,y,b;if(p=_(p),m.replace){if(y=je(p)?[]:l(B(p)),h=y[0],1!=y.length||1!==h.nodeType)throw vt("tplrt","Template for directive '{0}' must have exactly one root element. {1}",m.name,g);$={$attr:{}},ee(r,t,h);var x=I(h,[],$);j(m.scope)&&z(x),e=x.concat(e),W(n,$)}else h=d,t.html(p);for(e.unshift(v),u=V(e,h,n,i,t,m,o,a,s),w(r,function(e,n){e==h&&(r[n]=t[0])}),c=O(t[0].childNodes,i);f.length;){var C=f.shift(),S=f.shift(),E=f.shift(),q=f.shift(),k=t[0];if(S!==d){var A=S.className;s.hasElementTranscludeDirective&&m.replace||(k=Re(h)),ee(E,l(S),k),T(l(k),A)}b=u.transcludeOnThisElement?R(C,u.transclude,q):q,u(c,C,k,r,b)}f=null}).error(function(e,t,n,r){throw vt("tpload","Failed to load template: {0}",r.url)}),function(e,t,n,r,i){var o=i;f?(f.push(t),f.push(n),f.push(r),f.push(o)):(u.transcludeOnThisElement&&(o=R(t,u.transclude,i)),u(c,t,n,r,o))}}function Y(e,t){var n=t.priority-e.priority;return 0!==n?n:e.name!==t.name?e.name<t.name?-1:1:e.index-t.index}function J(e,t,n,r){if(t)throw vt("multidir","Multiple directives [{0}, {1}] asking for {2} on: {3}",t.name,n.name,e,ie(r))}function Z(e,t,n,i){var o=r(n,!0);if(o){if("multiple"===i&&"SELECT"===d(e))throw vt("selmulti","Binding to the 'multiple' attribute is not supported. Element: {0}",ie(e));t.push({priority:100,compile:function(){return{pre:function(t,n,a){var s=a.$$observers||(a.$$observers={});if(c.test(i))throw vt("nodomevents","Interpolations for HTML DOM event attributes are disallowed.  Please use the ng- versions (such as ng-click instead of onclick) instead.");(o=r(a[i],!0,function(e,t){if("srcdoc"==t)return y.HTML;var n=d(e);return"xlinkHref"==t||"FORM"==n&&"action"==t||"IMG"!=n&&("src"==t||"ngSrc"==t)?y.RESOURCE_URL:void 0}(e,i)))&&(a[i]=o(t),(s[i]||(s[i]=[])).$$inter=!0,(a.$$observers&&a.$$observers[i].$$scope||t).$watch(o,function(e,t){"class"===i&&e!=t?a.$updateClass(e,t):a.$set(i,e)}))}}}})}}function ee(e,n,r){var i,o,a=n[0],s=n.length,u=a.parentNode;if(e)for(i=0,o=e.length;i<o;i++)if(e[i]==a){e[i++]=r;for(var c=i,f=c+s-1,d=e.length;c<d;c++,f++)f<d?e[c]=e[f]:delete e[c];e.length-=s-1;break}u&&u.replaceChild(r,a);var p=t.createDocumentFragment();p.appendChild(a),r[l.expando]=a[l.expando];for(var h=1,m=n.length;h<m;h++){var v=n[h];l(v).remove(),p.appendChild(v),delete n[h]}n[0]=r,n.length=1}function te(e,t){return E(function(){return e.apply(null,arguments)},e,t)}}]}gt.$inject=["$provide","$$sanitizeUriProvider"];var $t=/^(x[\:\-_]|data[\:\-_])/i;function yt(e){return qe(e.replace($t,""))}function wt(e,t){var n="",r=e.split(/\s+/),i=t.split(/\s+/);e:for(var o=0;o<r.length;o++){for(var a=r[o],s=0;s<i.length;s++)if(a==i[s])continue e;n+=(n.length>0?" ":"")+a}return n}function bt(){var e={},t=/^(\S+)(\s+as\s+(\w+))?$/;this.register=function(t,n){me(t,"controller"),j(t)?E(e,t):e[t]=n},this.$get=["$injector","$window",function(n,i){return function(o,a){var s,u,l,c;if(D(o)&&(l=(u=o.match(t))[1],c=u[3],he(o=e.hasOwnProperty(l)?e[l]:ve(a.$scope,l,!0)||ve(i,l,!0),l,!0)),s=n.instantiate(o,a),c){if(!a||"object"!=typeof a.$scope)throw r("$controller")("noscp","Cannot export controller '{0}' as '{1}'! No $scope object provided via `locals`.",l||o.name,c);a.$scope[c]=s}return s}}]}function xt(){this.$get=["$window",function(e){return l(e.document)}]}function Ct(){this.$get=["$log",function(e){return function(t,n){e.error.apply(e,arguments)}}]}function St(e){var t,n,r,i={};return e?(w(e.split("\n"),function(e){r=e.indexOf(":"),t=o(B(e.substr(0,r))),n=B(e.substr(r+1)),t&&(i[t]=i[t]?i[t]+", "+n:n)}),i):i}function Et(e){var t=j(e)?e:n;return function(n){return t||(t=St(e)),n?t[o(n)]||null:t}}function qt(e,t,n){return F(n)?n(e,t):(w(n,function(n){e=n(e,t)}),e)}function kt(e){return 200<=e&&e<300}function _t(){var e=/^\s*(\[|\{[^\{])/,t=/[\}\]]\s*$/,r=/^\)\]\}',?\n/,i={"Content-Type":"application/json;charset=utf-8"},a=this.defaults={transformResponse:[function(n){return D(n)&&(n=n.replace(r,""),e.test(n)&&t.test(n)&&(n=ne(n))),n}],transformRequest:[function(e){return j(e)&&(n=e,"[object File]"!==m.call(n))&&(t=e,"[object Blob]"!==m.call(t))?te(e):e;var t,n}],headers:{common:{Accept:"application/json, text/plain, */*"},post:Q(i),put:Q(i),patch:Q(i)},xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN"},u=this.interceptors=[],l=this.responseInterceptors=[];this.$get=["$httpBackend","$browser","$cacheFactory","$rootScope","$q","$injector",function(e,t,r,i,c,f){var d=r("$http"),p=[];function h(r){var u={method:"get",transformRequest:a.transformRequest,transformResponse:a.transformResponse},l=function(e){var t,n,r,i=a.headers,s=E({},e.headers);i=E({},i.common,i[o(e.method)]);e:for(t in i){for(r in n=o(t),s)if(o(r)===n)continue e;s[t]=i[t]}return u=s,w(u,function(e,t){F(e)&&(null!=(l=e())?u[t]=l:delete u[t])}),s;var u,l}(r);E(u,r),u.headers=l,u.method=s(u.method);var f=[function(r){l=r.headers;var s=qt(r.data,Et(l),r.transformRequest);return M(s)&&w(l,function(e,t){"content-type"===o(t)&&delete l[t]}),M(r.withCredentials)&&!M(a.withCredentials)&&(r.withCredentials=a.withCredentials),function(r,o,s){var u,l,f=c.defer(),p=f.promise,m=function(e,t){if(!t)return e;var n=[];return function(e,t,n){for(var r=b(e),i=0;i<r.length;i++)t.call(n,e[r[i]],r[i])}(t,function(e,t){null===e||M(e)||(N(e)||(e=[e]),w(e,function(e){j(e)&&(e=R(e)?e.toISOString():te(e)),n.push(le(t)+"="+le(e))}))}),n.length>0&&(e+=(-1==e.indexOf("?")?"?":"&")+n.join("&")),e}(r.url,r.params);if(h.pendingRequests.push(r),p.then($,$),!r.cache&&!a.cache||!1===r.cache||"GET"!==r.method&&"JSONP"!==r.method||(u=j(r.cache)?r.cache:j(a.cache)?a.cache:d),u)if(T(l=u.get(m))){if(V(l))return l.then($,$),l;N(l)?g(l[1],l[0],Q(l[2]),l[3]):g(l,200,{},"OK")}else u.put(m,p);if(M(l)){var v=Mn(r.url)?t.cookies()[r.xsrfCookieName||a.xsrfCookieName]:n;v&&(s[r.xsrfHeaderName||a.xsrfHeaderName]=v),e(r.method,m,o,function(e,t,n,r){u&&(kt(e)?u.put(m,[e,t,St(n),r]):u.remove(m)),g(t,e,n,r),i.$$phase||i.$apply()},s,r.timeout,r.withCredentials,r.responseType)}return p;function g(e,t,n,i){(kt(t=Math.max(t,0))?f.resolve:f.reject)({data:e,status:t,headers:Et(n),config:r,statusText:i})}function $(){var e=H(h.pendingRequests,r);-1!==e&&h.pendingRequests.splice(e,1)}}(r,s,l).then($,$)},n],m=c.when(u);for(w(p,function(e){(e.request||e.requestError)&&f.unshift(e.request,e.requestError),(e.response||e.responseError)&&f.push(e.response,e.responseError)});f.length;){var v=f.shift(),g=f.shift();m=m.then(v,g)}return m.success=function(e){return m.then(function(t){e(t.data,t.status,t.headers,u)}),m},m.error=function(e){return m.then(null,function(t){e(t.data,t.status,t.headers,u)}),m},m;function $(e){var t=E({},e,{data:qt(e.data,e.headers,u.transformResponse)});return kt(e.status)?t:c.reject(t)}}return w(u,function(e){p.unshift(D(e)?f.get(e):f.invoke(e))}),w(l,function(e,t){var n=D(e)?f.get(e):f.invoke(e);p.splice(t,0,{response:function(e){return n(c.when(e))},responseError:function(e){return n(c.reject(e))}})}),h.pendingRequests=[],function(e){w(arguments,function(e){h[e]=function(t,n){return h(E(n||{},{method:e,url:t}))}})}("get","delete","head","jsonp"),function(e){w(arguments,function(e){h[e]=function(t,n,r){return h(E(r||{},{method:e,url:t,data:n}))}})}("post","put","patch"),h.defaults=a,h}]}function At(t){if(u<=8&&(!t.match(/^(get|post|head|put|delete|options)$/i)||!e.XMLHttpRequest))return new e.ActiveXObject("Microsoft.XMLHTTP");if(e.XMLHttpRequest)return new e.XMLHttpRequest;throw r("$httpBackend")("noxhr","This browser does not support XMLHttpRequest.")}function Pt(){this.$get=["$browser","$window","$document",function(e,t,n){return r=e,i=At,a=e.defer,s=t.angular.callbacks,l=n[0],c=-1,function(e,t,n,f,d,p,h,m){var v,g,$,y,b,x;if(r.$$incOutstandingRequestCount(),t=t||r.url(),"jsonp"==o(e)){var C="_"+(s.counter++).toString(36);s[C]=function(e){s[C].data=e,s[C].called=!0};var S=(g=t.replace("JSON_CALLBACK","angular.callbacks."+C),$=C,y=function(e,t){A(f,e,s[C].data,"",t),s[C]=_},b=l.createElement("script"),x=null,b.type="text/javascript",b.src=g,b.async=!0,x=function(e){xe(b,"load",x),xe(b,"error",x),l.body.removeChild(b),b=null;var t=-1,n="unknown";e&&("load"!==e.type||s[$].called||(e={type:"error"}),n=e.type,t="error"===e.type?404:200),y&&y(t,n)},be(b,"load",x),be(b,"error",x),u<=8&&(b.onreadystatechange=function(){D(b.readyState)&&/loaded|complete/.test(b.readyState)&&(b.onreadystatechange=null,x({type:"load"}))}),l.body.appendChild(b),x)}else{var E=i(e);if(E.open(e,t,!0),w(d,function(e,t){T(e)&&E.setRequestHeader(t,e)}),E.onreadystatechange=function(){if(E&&4==E.readyState){var e=null,t=null,n="";v!==c&&(e=E.getAllResponseHeaders(),t="response"in E?E.response:E.responseText),v===c&&u<10||(n=E.statusText),A(f,v||E.status,t,e,n)}},h&&(E.withCredentials=!0),m)try{E.responseType=m}catch(e){if("json"!==m)throw e}E.send(n||null)}if(p>0)var q=a(k,p);else V(p)&&p.then(k);function k(){v=c,S&&S(),E&&E.abort()}function A(e,n,i,o,s){q&&a.cancel(q),S=E=null,0===n&&(n=i?200:"file"==Pn(t).protocol?404:0),e(n=1223===n?204:n,i,o,s=s||""),r.$$completeOutstandingRequest(_)}};var r,i,a,s,l,c}]}var Mt=r("$interpolate");function Tt(){var e="{{",t="}}";this.startSymbol=function(t){return t?(e=t,this):e},this.endSymbol=function(e){return e?(t=e,this):t},this.$get=["$parse","$exceptionHandler","$sce",function(n,r,i){var o=e.length,a=t.length;function s(s,u,l){for(var c,f,d,p,h=0,m=[],v=s.length,g=!1,$=[];h<v;)-1!=(c=s.indexOf(e,h))&&-1!=(f=s.indexOf(t,c+o))?(h!=c&&m.push(s.substring(h,c)),m.push(d=n(p=s.substring(c+o,f))),d.exp=p,h=f+a,g=!0):(h!=v&&m.push(s.substring(h)),h=v);if((v=m.length)||(m.push(""),v=1),l&&m.length>1)throw Mt("noconcat","Error while interpolating: {0}\nStrict Contextual Escaping disallows interpolations that concatenate multiple expressions when a trusted value is required.  See http://docs.angularjs.org/api/ng.$sce",s);if(!u||g)return $.length=v,(d=function(e){try{for(var t,n=0,o=v;n<o;n++){if("function"==typeof(t=m[n]))if(t=t(e),null==(t=l?i.getTrusted(l,t):i.valueOf(t)))t="";else switch(typeof t){case"string":break;case"number":t=""+t;break;default:t=te(t)}$[n]=t}return $.join("")}catch(e){var a=Mt("interr","Can't interpolate: {0}\n{1}",s,e.toString());r(a)}}).exp=s,d.parts=m,d}return s.startSymbol=function(){return e},s.endSymbol=function(){return t},s}]}function jt(){this.$get=["$rootScope","$window","$q",function(e,t,n){var r={};function i(i,o,a,s){var u=t.setInterval,l=t.clearInterval,c=n.defer(),f=c.promise,d=0,p=T(s)&&!s;return a=T(a)?a:0,f.then(null,null,i),f.$$intervalId=u(function(){c.notify(d++),a>0&&d>=a&&(c.resolve(d),l(f.$$intervalId),delete r[f.$$intervalId]),p||e.$apply()},o),r[f.$$intervalId]=c,f}return i.cancel=function(e){return!!(e&&e.$$intervalId in r)&&(r[e.$$intervalId].reject("canceled"),t.clearInterval(e.$$intervalId),delete r[e.$$intervalId],!0)},i}]}function Dt(){this.$get=function(){return{id:"en-us",NUMBER_FORMATS:{DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{minInt:1,minFrac:0,maxFrac:3,posPre:"",posSuf:"",negPre:"-",negSuf:"",gSize:3,lgSize:3},{minInt:1,minFrac:2,maxFrac:2,posPre:"¤",posSuf:"",negPre:"(¤",negSuf:")",gSize:3,lgSize:3}],CURRENCY_SYM:"$"},DATETIME_FORMATS:{MONTH:"January,February,March,April,May,June,July,August,September,October,November,December".split(","),SHORTMONTH:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(","),DAY:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday".split(","),SHORTDAY:"Sun,Mon,Tue,Wed,Thu,Fri,Sat".split(","),AMPMS:["AM","PM"],medium:"MMM d, y h:mm:ss a",short:"M/d/yy h:mm a",fullDate:"EEEE, MMMM d, y",longDate:"MMMM d, y",mediumDate:"MMM d, y",shortDate:"M/d/yy",mediumTime:"h:mm:ss a",shortTime:"h:mm a"},pluralCat:function(e){return 1===e?"one":"other"}}}}var Ot=/^([^\?#]*)(\?([^#]*))?(#(.*))?$/,Rt={http:80,https:443,ftp:21},Nt=r("$location");function Ft(e){for(var t=e.split("/"),n=t.length;n--;)t[n]=ue(t[n]);return t.join("/")}function It(e,t,n){var r=Pn(e,n);t.$$protocol=r.protocol,t.$$host=r.hostname,t.$$port=q(r.port)||Rt[r.protocol]||null}function Ut(e,t,n){var r="/"!==e.charAt(0);r&&(e="/"+e);var i=Pn(e,n);t.$$path=decodeURIComponent(r&&"/"===i.pathname.charAt(0)?i.pathname.substring(1):i.pathname),t.$$search=ae(i.search),t.$$hash=decodeURIComponent(i.hash),t.$$path&&"/"!=t.$$path.charAt(0)&&(t.$$path="/"+t.$$path)}function Lt(e,t){if(0===t.indexOf(e))return t.substr(e.length)}function Vt(e){var t=e.indexOf("#");return-1==t?e:e.substr(0,t)}function Bt(e){return e.substr(0,Vt(e).lastIndexOf("/")+1)}function zt(e,t){this.$$html5=!0,t=t||"";var r=Bt(e);It(e,this,e),this.$$parse=function(t){var n=Lt(r,t);if(!D(n))throw Nt("ipthprfx",'Invalid url "{0}", missing path prefix "{1}".',t,r);Ut(n,this,e),this.$$path||(this.$$path="/"),this.$$compose()},this.$$compose=function(){var e=se(this.$$search),t=this.$$hash?"#"+ue(this.$$hash):"";this.$$url=Ft(this.$$path)+(e?"?"+e:"")+t,this.$$absUrl=r+this.$$url.substr(1)},this.$$parseLinkUrl=function(i,o){var a,s,u;return(a=Lt(e,i))!==n?(s=a,u=(a=Lt(t,a))!==n?r+(Lt("/",a)||a):e+s):(a=Lt(r,i))!==n?u=r+a:r==i+"/"&&(u=r),u&&this.$$parse(u),!!u}}function Ht(e,t){var n=Bt(e);It(e,this,e),this.$$parse=function(r){var i=Lt(e,r)||Lt(n,r),o="#"==i.charAt(0)?Lt(t,i):this.$$html5?i:"";if(!D(o))throw Nt("ihshprfx",'Invalid url "{0}", missing hash prefix "{1}".',r,t);Ut(o,this,e),this.$$path=function(e,t,n){var r,i=/^\/[A-Z]:(\/.*)/;0===t.indexOf(n)&&(t=t.replace(n,""));if(i.exec(t))return e;return(r=i.exec(e))?r[1]:e}(this.$$path,o,e),this.$$compose()},this.$$compose=function(){var n=se(this.$$search),r=this.$$hash?"#"+ue(this.$$hash):"";this.$$url=Ft(this.$$path)+(n?"?"+n:"")+r,this.$$absUrl=e+(this.$$url?t+this.$$url:"")},this.$$parseLinkUrl=function(t,n){return Vt(e)==Vt(t)&&(this.$$parse(t),!0)}}function Wt(e,t){this.$$html5=!0,Ht.apply(this,arguments);var n=Bt(e);this.$$parseLinkUrl=function(r,i){var o,a;return e==Vt(r)?o=r:(a=Lt(n,r))?o=e+t+a:n===r+"/"&&(o=n),o&&this.$$parse(o),!!o},this.$$compose=function(){var n=se(this.$$search),r=this.$$hash?"#"+ue(this.$$hash):"";this.$$url=Ft(this.$$path)+(n?"?"+n:"")+r,this.$$absUrl=e+t+this.$$url}}function Gt(e){return function(){return this[e]}}function Qt(e,t){return function(n){return M(n)?this[e]:(this[e]=t(n),this.$$compose(),this)}}function Xt(){var t="",n=!1;this.hashPrefix=function(e){return T(e)?(t=e,this):t},this.html5Mode=function(e){return T(e)?(n=e,this):n},this.$get=["$rootScope","$browser","$sniffer","$rootElement",function(r,i,a,s){var u,c,f,d,p=i.baseHref(),h=i.url();n?(f=(d=h).substring(0,d.indexOf("/",d.indexOf("//")+2))+(p||"/"),c=a.history?zt:Wt):(f=Vt(h),c=Ht),(u=new c(f,"#"+t)).$$parseLinkUrl(h,h);var m=/^\s*(javascript|mailto):/i;s.on("click",function(t){if(!t.ctrlKey&&!t.metaKey&&2!=t.which){for(var n=l(t.target);"a"!==o(n[0].nodeName);)if(n[0]===s[0]||!(n=n.parent())[0])return;var a=n.prop("href"),c=n.attr("href")||n.attr("xlink:href");j(a)&&"[object SVGAnimatedString]"===a.toString()&&(a=Pn(a.animVal).href),m.test(a)||!a||n.attr("target")||t.isDefaultPrevented()||u.$$parseLinkUrl(a,c)&&(t.preventDefault(),u.absUrl()!=i.url()&&(r.$apply(),e.angular["ff-684208-preventDefault"]=!0))}}),u.absUrl()!=h&&i.url(u.absUrl(),!0),i.onUrlChange(function(e){u.absUrl()!=e&&(r.$evalAsync(function(){var t=u.absUrl();u.$$parse(e),r.$broadcast("$locationChangeStart",e,t).defaultPrevented?(u.$$parse(t),i.url(t)):g(t)}),r.$$phase||r.$digest())});var v=0;return r.$watch(function(){var e=i.url(),t=u.$$replace;return v&&e==u.absUrl()||(v++,r.$evalAsync(function(){r.$broadcast("$locationChangeStart",u.absUrl(),e).defaultPrevented?u.$$parse(e):(i.url(u.absUrl(),t),g(e))})),u.$$replace=!1,v}),u;function g(e){r.$broadcast("$locationChangeSuccess",u.absUrl(),e)}}]}function Yt(){var e=!0,t=this;this.debugEnabled=function(t){return T(t)?(e=t,this):e},this.$get=["$window",function(n){return{log:i("log"),info:i("info"),warn:i("warn"),error:i("error"),debug:(r=i("debug"),function(){e&&r.apply(t,arguments)})};var r;function i(e){var t=n.console||{},r=t[e]||t.log||_,i=!1;try{i=!!r.apply}catch(e){}return i?function(){var e=[];return w(arguments,function(t){var n;e.push(((n=t)instanceof Error&&(n.stack?n=n.message&&-1===n.stack.indexOf(n.message)?"Error: "+n.message+"\n"+n.stack:n.stack:n.sourceURL&&(n=n.message+"\n"+n.sourceURL+":"+n.line)),n))}),r.apply(t,e)}:function(e,t){r(e,null==t?"":t)}}}]}Wt.prototype=Ht.prototype=zt.prototype={$$html5:!1,$$replace:!1,absUrl:Gt("$$absUrl"),url:function(e){if(M(e))return this.$$url;var t=Ot.exec(e);return t[1]&&this.path(decodeURIComponent(t[1])),(t[2]||t[1])&&this.search(t[3]||""),this.hash(t[5]||""),this},protocol:Gt("$$protocol"),host:Gt("$$host"),port:Gt("$$port"),path:Qt("$$path",function(e){return"/"==(e=null!==e?e.toString():"").charAt(0)?e:"/"+e}),search:function(e,t){switch(arguments.length){case 0:return this.$$search;case 1:if(D(e)||O(e))e=e.toString(),this.$$search=ae(e);else{if(!j(e))throw Nt("isrcharg","The first argument of the `$location#search()` call must be a string or an object.");w(e,function(t,n){null==t&&delete e[n]}),this.$$search=e}break;default:M(t)||null===t?delete this.$$search[e]:this.$$search[e]=t}return this.$$compose(),this},hash:Qt("$$hash",function(e){return null!==e?e.toString():""}),replace:function(){return this.$$replace=!0,this}};var Jt,Kt=r("$parse"),Zt={};function en(e,t){if("__defineGetter__"===e||"__defineSetter__"===e||"__lookupGetter__"===e||"__lookupSetter__"===e||"__proto__"===e)throw Kt("isecfld","Attempting to access a disallowed field in Angular expressions! Expression: {0}",t);return e}function tn(e,t){if(e){if(e.constructor===e)throw Kt("isecfn","Referencing Function in Angular expressions is disallowed! Expression: {0}",t);if(e.document&&e.location&&e.alert&&e.setInterval)throw Kt("isecwindow","Referencing the Window in Angular expressions is disallowed! Expression: {0}",t);if(e.children&&(e.nodeName||e.prop&&e.attr&&e.find))throw Kt("isecdom","Referencing DOM nodes in Angular expressions is disallowed! Expression: {0}",t);if(e===Object)throw Kt("isecobj","Referencing Object in Angular expressions is disallowed! Expression: {0}",t)}return e}var nn=Function.prototype.call,rn=Function.prototype.apply,on=Function.prototype.bind;var an={null:function(){return null},true:function(){return!0},false:function(){return!1},undefined:_,"+":function(e,t,r,i){return r=r(e,t),i=i(e,t),T(r)?T(i)?r+i:r:T(i)?i:n},"-":function(e,t,n,r){return n=n(e,t),r=r(e,t),(T(n)?n:0)-(T(r)?r:0)},"*":function(e,t,n,r){return n(e,t)*r(e,t)},"/":function(e,t,n,r){return n(e,t)/r(e,t)},"%":function(e,t,n,r){return n(e,t)%r(e,t)},"^":function(e,t,n,r){return n(e,t)^r(e,t)},"=":_,"===":function(e,t,n,r){return n(e,t)===r(e,t)},"!==":function(e,t,n,r){return n(e,t)!==r(e,t)},"==":function(e,t,n,r){return n(e,t)==r(e,t)},"!=":function(e,t,n,r){return n(e,t)!=r(e,t)},"<":function(e,t,n,r){return n(e,t)<r(e,t)},">":function(e,t,n,r){return n(e,t)>r(e,t)},"<=":function(e,t,n,r){return n(e,t)<=r(e,t)},">=":function(e,t,n,r){return n(e,t)>=r(e,t)},"&&":function(e,t,n,r){return n(e,t)&&r(e,t)},"||":function(e,t,n,r){return n(e,t)||r(e,t)},"&":function(e,t,n,r){return n(e,t)&r(e,t)},"|":function(e,t,n,r){return r(e,t)(e,t,n(e,t))},"!":function(e,t,n){return!n(e,t)}},sn={n:"\n",f:"\f",r:"\r",t:"\t",v:"\v","'":"'",'"':'"'},un=function(e){this.options=e};un.prototype={constructor:un,lex:function(e){for(this.text=e,this.index=0,this.ch=n,this.lastCh=":",this.tokens=[];this.index<this.text.length;){if(this.ch=this.text.charAt(this.index),this.is("\"'"))this.readString(this.ch);else if(this.isNumber(this.ch)||this.is(".")&&this.isNumber(this.peek()))this.readNumber();else if(this.isIdent(this.ch))this.readIdent();else if(this.is("(){}[].,;:?"))this.tokens.push({index:this.index,text:this.ch}),this.index++;else{if(this.isWhitespace(this.ch)){this.index++;continue}var t=this.ch+this.peek(),r=t+this.peek(2),i=an[this.ch],o=an[t],a=an[r];a?(this.tokens.push({index:this.index,text:r,fn:a}),this.index+=3):o?(this.tokens.push({index:this.index,text:t,fn:o}),this.index+=2):i?(this.tokens.push({index:this.index,text:this.ch,fn:i}),this.index+=1):this.throwError("Unexpected next character ",this.index,this.index+1)}this.lastCh=this.ch}return this.tokens},is:function(e){return-1!==e.indexOf(this.ch)},was:function(e){return-1!==e.indexOf(this.lastCh)},peek:function(e){var t=e||1;return this.index+t<this.text.length&&this.text.charAt(this.index+t)},isNumber:function(e){return"0"<=e&&e<="9"},isWhitespace:function(e){return" "===e||"\r"===e||"\t"===e||"\n"===e||"\v"===e||" "===e},isIdent:function(e){return"a"<=e&&e<="z"||"A"<=e&&e<="Z"||"_"===e||"$"===e},isExpOperator:function(e){return"-"===e||"+"===e||this.isNumber(e)},throwError:function(e,t,n){n=n||this.index;var r=T(t)?"s "+t+"-"+this.index+" ["+this.text.substring(t,n)+"]":" "+n;throw Kt("lexerr","Lexer Error: {0} at column{1} in expression [{2}].",e,r,this.text)},readNumber:function(){for(var e="",t=this.index;this.index<this.text.length;){var n=o(this.text.charAt(this.index));if("."==n||this.isNumber(n))e+=n;else{var r=this.peek();if("e"==n&&this.isExpOperator(r))e+=n;else if(this.isExpOperator(n)&&r&&this.isNumber(r)&&"e"==e.charAt(e.length-1))e+=n;else{if(!this.isExpOperator(n)||r&&this.isNumber(r)||"e"!=e.charAt(e.length-1))break;this.throwError("Invalid exponent")}}this.index++}e*=1,this.tokens.push({index:t,text:e,literal:!0,constant:!0,fn:function(){return e}})},readIdent:function(){for(var e,t,n,r,i=this,o="",a=this.index;this.index<this.text.length&&("."===(r=this.text.charAt(this.index))||this.isIdent(r)||this.isNumber(r));)"."===r&&(e=this.index),o+=r,this.index++;if(e)for(t=this.index;t<this.text.length;){if("("===(r=this.text.charAt(t))){n=o.substr(e-a+1),o=o.substr(0,e-a),this.index=t;break}if(!this.isWhitespace(r))break;t++}var s={index:a,text:o};if(an.hasOwnProperty(o))s.fn=an[o],s.literal=!0,s.constant=!0;else{var u=mn(o,this.options,this.text);s.fn=E(function(e,t){return u(e,t)},{assign:function(e,t){return cn(e,o,t,i.text,i.options)}})}this.tokens.push(s),n&&(this.tokens.push({index:e,text:"."}),this.tokens.push({index:e+1,text:n}))},readString:function(e){var t=this.index;this.index++;for(var n="",r=e,i=!1;this.index<this.text.length;){var o=this.text.charAt(this.index);if(r+=o,i){if("u"===o){var a=this.text.substring(this.index+1,this.index+5);a.match(/[\da-f]{4}/i)||this.throwError("Invalid unicode escape [\\u"+a+"]"),this.index+=4,n+=String.fromCharCode(parseInt(a,16))}else{n+=sn[o]||o}i=!1}else if("\\"===o)i=!0;else{if(o===e)return this.index++,void this.tokens.push({index:t,text:r,string:n,literal:!0,constant:!0,fn:function(){return n}});n+=o}this.index++}this.throwError("Unterminated quote",t)}};var ln=function(e,t,n){this.lexer=e,this.$filter=t,this.options=n};function cn(e,t,r,i,o){tn(e,i),o=o||{};for(var a,s=t.split("."),u=0;s.length>1;u++){var l=tn(e[a=en(s.shift(),i)],i);l||(l={},e[a]=l),(e=l).then&&o.unwrapPromises&&(Jt(i),"$$v"in e||function(e){e.then(function(t){e.$$v=t})}(e),e.$$v===n&&(e.$$v={}),e=e.$$v)}return tn(e[a=en(s.shift(),i)],i),e[a]=r,r}ln.ZERO=E(function(){return 0},{constant:!0}),ln.prototype={constructor:ln,parse:function(e){this.text=e,this.tokens=this.lexer.lex(e);var t=this.statements();return 0!==this.tokens.length&&this.throwError("is an unexpected token",this.tokens[0]),t.literal=!!t.literal,t.constant=!!t.constant,t},primary:function(){var e,t,n;if(this.expect("("))e=this.filterChain(),this.consume(")");else if(this.expect("["))e=this.arrayDeclaration();else if(this.expect("{"))e=this.object();else{var r=this.expect();(e=r.fn)||this.throwError("not a primary expression",r),e.literal=!!r.literal,e.constant=!!r.constant}for(;t=this.expect("(","[",".");)"("===t.text?(e=this.functionCall(e,n),n=null):"["===t.text?(n=e,e=this.objectIndex(e)):"."===t.text?(n=e,e=this.fieldAccess(e)):this.throwError("IMPOSSIBLE");return e},throwError:function(e,t){throw Kt("syntax","Syntax Error: Token '{0}' {1} at column {2} of the expression [{3}] starting at [{4}].",t.text,e,t.index+1,this.text,this.text.substring(t.index))},peekToken:function(){if(0===this.tokens.length)throw Kt("ueoe","Unexpected end of expression: {0}",this.text);return this.tokens[0]},peek:function(e,t,n,r){if(this.tokens.length>0){var i=this.tokens[0],o=i.text;if(o===e||o===t||o===n||o===r||!e&&!t&&!n&&!r)return i}return!1},expect:function(e,t,n,r){var i=this.peek(e,t,n,r);return!!i&&(this.tokens.shift(),i)},consume:function(e){this.expect(e)||this.throwError("is unexpected, expecting ["+e+"]",this.peek())},unaryFn:function(e,t){return E(function(n,r){return e(n,r,t)},{constant:t.constant})},ternaryFn:function(e,t,n){return E(function(r,i){return e(r,i)?t(r,i):n(r,i)},{constant:e.constant&&t.constant&&n.constant})},binaryFn:function(e,t,n){return E(function(r,i){return t(r,i,e,n)},{constant:e.constant&&n.constant})},statements:function(){for(var e=[];;)if(this.tokens.length>0&&!this.peek("}",")",";","]")&&e.push(this.filterChain()),!this.expect(";"))return 1===e.length?e[0]:function(t,n){for(var r,i=0;i<e.length;i++){var o=e[i];o&&(r=o(t,n))}return r}},filterChain:function(){for(var e,t=this.expression();;){if(!(e=this.expect("|")))return t;t=this.binaryFn(t,e.fn,this.filter())}},filter:function(){for(var e=this.expect(),t=this.$filter(e.text),n=[];;){if(!(e=this.expect(":"))){var r=function(e,r,i){for(var o=[i],a=0;a<n.length;a++)o.push(n[a](e,r));return t.apply(e,o)};return function(){return r}}n.push(this.expression())}},expression:function(){return this.assignment()},assignment:function(){var e,t,n=this.ternary();return(t=this.expect("="))?(n.assign||this.throwError("implies assignment but ["+this.text.substring(0,t.index)+"] can not be assigned to",t),e=this.ternary(),function(t,r){return n.assign(t,e(t,r),r)}):n},ternary:function(){var e,t,n=this.logicalOR();return(t=this.expect("?"))?(e=this.assignment(),(t=this.expect(":"))?this.ternaryFn(n,e,this.assignment()):void this.throwError("expected :",t)):n},logicalOR:function(){for(var e,t=this.logicalAND();;){if(!(e=this.expect("||")))return t;t=this.binaryFn(t,e.fn,this.logicalAND())}},logicalAND:function(){var e,t=this.equality();return(e=this.expect("&&"))&&(t=this.binaryFn(t,e.fn,this.logicalAND())),t},equality:function(){var e,t=this.relational();return(e=this.expect("==","!=","===","!=="))&&(t=this.binaryFn(t,e.fn,this.equality())),t},relational:function(){var e,t=this.additive();return(e=this.expect("<",">","<=",">="))&&(t=this.binaryFn(t,e.fn,this.relational())),t},additive:function(){for(var e,t=this.multiplicative();e=this.expect("+","-");)t=this.binaryFn(t,e.fn,this.multiplicative());return t},multiplicative:function(){for(var e,t=this.unary();e=this.expect("*","/","%");)t=this.binaryFn(t,e.fn,this.unary());return t},unary:function(){var e;return this.expect("+")?this.primary():(e=this.expect("-"))?this.binaryFn(ln.ZERO,e.fn,this.unary()):(e=this.expect("!"))?this.unaryFn(e.fn,this.unary()):this.primary()},fieldAccess:function(e){var t=this,n=this.expect().text,r=mn(n,this.options,this.text);return E(function(t,n,i){return r(i||e(t,n))},{assign:function(r,i,o){var a=e(r,o);return a||e.assign(r,a={}),cn(a,n,i,t.text,t.options)}})},objectIndex:function(e){var t=this,r=this.expression();return this.consume("]"),E(function(i,o){var a,s,u=e(i,o),l=r(i,o);return en(l,t.text),u?((a=tn(u[l],t.text))&&a.then&&t.options.unwrapPromises&&(s=a,"$$v"in a||(s.$$v=n,s.then(function(e){s.$$v=e})),a=a.$$v),a):n},{assign:function(n,i,o){var a=en(r(n,o),t.text),s=tn(e(n,o),t.text);return s||e.assign(n,s={}),s[a]=i}})},functionCall:function(e,t){var n=[];if(")"!==this.peekToken().text)for(;n.push(this.expression()),this.expect(","););this.consume(")");var r=this;return function(i,o){for(var a=[],s=t?t(i,o):i,u=0;u<n.length;u++)a.push(tn(n[u](i,o),r.text));var l=e(i,o,s)||_;return tn(s,r.text),function(e,t){if(e){if(e.constructor===e)throw Kt("isecfn","Referencing Function in Angular expressions is disallowed! Expression: {0}",t);if(e===nn||e===rn||on&&e===on)throw Kt("isecff","Referencing call, apply or bind in Angular expressions is disallowed! Expression: {0}",t)}}(l,r.text),tn(l.apply?l.apply(s,a):l(a[0],a[1],a[2],a[3],a[4]),r.text)}},arrayDeclaration:function(){var e=[],t=!0;if("]"!==this.peekToken().text)do{if(this.peek("]"))break;var n=this.expression();e.push(n),n.constant||(t=!1)}while(this.expect(","));return this.consume("]"),E(function(t,n){for(var r=[],i=0;i<e.length;i++)r.push(e[i](t,n));return r},{literal:!0,constant:t})},object:function(){var e=[],t=!0;if("}"!==this.peekToken().text)do{if(this.peek("}"))break;var n=this.expect(),r=n.string||n.text;this.consume(":");var i=this.expression();e.push({key:r,value:i}),i.constant||(t=!1)}while(this.expect(","));return this.consume("}"),E(function(t,n){for(var r={},i=0;i<e.length;i++){var o=e[i];r[o.key]=o.value(t,n)}return r},{literal:!0,constant:t})}};var fn={},dn={};function pn(e){return"constructor"==e}function hn(e,t,r,i,o,a,s){en(e,a),en(t,a),en(r,a),en(i,a),en(o,a);var u=function(e){return tn(e,a)},l=s.expensiveChecks,c=l||pn(e)?u:A,f=l||pn(t)?u:A,d=l||pn(r)?u:A,p=l||pn(i)?u:A,h=l||pn(o)?u:A;return s.unwrapPromises?function(s,u){var l,m=u&&u.hasOwnProperty(e)?u:s;return null==m?m:((m=c(m[e]))&&m.then&&(Jt(a),"$$v"in m||((l=m).$$v=n,l.then(function(e){l.$$v=c(e)})),m=c(m.$$v)),t?null==m?n:((m=f(m[t]))&&m.then&&(Jt(a),"$$v"in m||((l=m).$$v=n,l.then(function(e){l.$$v=f(e)})),m=f(m.$$v)),r?null==m?n:((m=d(m[r]))&&m.then&&(Jt(a),"$$v"in m||((l=m).$$v=n,l.then(function(e){l.$$v=d(e)})),m=d(m.$$v)),i?null==m?n:((m=p(m[i]))&&m.then&&(Jt(a),"$$v"in m||((l=m).$$v=n,l.then(function(e){l.$$v=p(e)})),m=p(m.$$v)),o?null==m?n:((m=h(m[o]))&&m.then&&(Jt(a),"$$v"in m||((l=m).$$v=n,l.then(function(e){l.$$v=h(e)})),m=h(m.$$v)),m):m):m):m):m)}:function(a,s){var u=s&&s.hasOwnProperty(e)?s:a;return null==u?u:(u=c(u[e]),t?null==u?n:(u=f(u[t]),r?null==u?n:(u=d(u[r]),i?null==u?n:(u=p(u[i]),o?null==u?n:u=h(u[o]):u):u):u):u)}}function mn(e,t,r){var i=t.expensiveChecks,o=i?dn:fn;if(o.hasOwnProperty(e))return o[e];var a,s,u,l=e.split("."),c=l.length;if(t.csp)a=c<6?hn(l[0],l[1],l[2],l[3],l[4],r,t):function(e,i){for(var o,a=0;o=hn(l[a++],l[a++],l[a++],l[a++],l[a++],r,t)(e,i),i=n,e=o,a<c;);return o};else{var f="var p;\n";i&&(f+="s = eso(s, fe);\nl = eso(l, fe);\n");var d=i;w(l,function(e,n){en(e,r);var o=(n?"s":'((l&&l.hasOwnProperty("'+e+'"))?l:s)')+'["'+e+'"]',a=i||pn(e);a&&(o="eso("+o+", fe)",d=!0),f+="if(s == null) return undefined;\ns="+o+";\n",t.unwrapPromises&&(f+='if (s && s.then) {\n pw("'+r.replace(/(["\r\n])/g,"\\$1")+'");\n if (!("$$v" in s)) {\n p=s;\n p.$$v = undefined;\n p.then(function(v) {p.$$v='+(a?"eso(v)":"v")+";});\n}\n s="+(a?"eso(s.$$v)":"s.$$v")+"\n}\n")}),f+="return s;";var p=new Function("s","l","pw","eso","fe",f);p.toString=P(f),(d||t.unwrapPromises)&&(s=p,u=r,p=function(e,t){return s(e,t,Jt,tn,u)}),a=p}return"hasOwnProperty"!==e&&(o[e]=a),a}function vn(){var e={},t={},n={csp:!1,unwrapPromises:!1,logPromiseWarnings:!0,expensiveChecks:!1};this.unwrapPromises=function(e){return T(e)?(n.unwrapPromises=!!e,this):n.unwrapPromises},this.logPromiseWarnings=function(e){return T(e)?(n.logPromiseWarnings=e,this):n.logPromiseWarnings},this.$get=["$filter","$sniffer","$log",function(r,i,o){n.csp=i.csp;var a={csp:n.csp,unwrapPromises:n.unwrapPromises,logPromiseWarnings:n.logPromiseWarnings,expensiveChecks:!0};return Jt=function(e){n.logPromiseWarnings&&!Zt.hasOwnProperty(e)&&(Zt[e]=!0,o.warn("[$parse] Promise found in the expression `"+e+"`. Automatic unwrapping of promises in Angular expressions is deprecated."))},function(i,o){var s;switch(typeof i){case"string":var u=o?t:e;if(u.hasOwnProperty(i))return u[i];var l=o?a:n,c=new un(l);return s=new ln(c,r,l).parse(i),"hasOwnProperty"!==i&&(u[i]=s),s;case"function":return i;default:return _}}}]}function gn(){this.$get=["$rootScope","$exceptionHandler",function(e,t){return function(e,t){var r=function(){var o,l,c=[];return l={resolve:function(t){if(c){var r=c;c=n,o=i(t),r.length&&e(function(){for(var e,t=0,n=r.length;t<n;t++)e=r[t],o.then(e[0],e[1],e[2])})}},reject:function(e){l.resolve(a(e))},notify:function(t){if(c){var n=c;c.length&&e(function(){for(var e=0,r=n.length;e<r;e++)n[e][2](t)})}},promise:{then:function(e,n,i){var a=r(),l=function(n){try{a.resolve((F(e)?e:s)(n))}catch(e){a.reject(e),t(e)}},f=function(e){try{a.resolve((F(n)?n:u)(e))}catch(e){a.reject(e),t(e)}},d=function(e){try{a.notify((F(i)?i:s)(e))}catch(e){t(e)}};return c?c.push([l,f,d]):o.then(l,f,d),a.promise},catch:function(e){return this.then(null,e)},finally:function(e){function t(e,t){var n=r();return t?n.resolve(e):n.reject(e),n.promise}function n(n,r){var i=null;try{i=(e||s)()}catch(e){return t(e,!1)}return V(i)?i.then(function(){return t(n,r)},function(e){return t(e,!1)}):t(n,r)}return this.then(function(e){return n(e,!0)},function(e){return n(e,!1)})}}}},i=function(t){return V(t)?t:{then:function(n){var i=r();return e(function(){i.resolve(n(t))}),i.promise}}},o=function(e){var t=r();return t.reject(e),t.promise},a=function(n){return{then:function(i,o){var a=r();return e(function(){try{a.resolve((F(o)?o:u)(n))}catch(e){a.reject(e),t(e)}}),a.promise}}};function s(e){return e}function u(e){return o(e)}return{defer:r,reject:o,when:function(n,a,l,c){var f,d=r(),p=function(e){try{return(F(a)?a:s)(e)}catch(e){return t(e),o(e)}},h=function(e){try{return(F(l)?l:u)(e)}catch(e){return t(e),o(e)}},m=function(e){try{return(F(c)?c:s)(e)}catch(e){t(e)}};return e(function(){i(n).then(function(e){f||(f=!0,d.resolve(i(e).then(p,h,m)))},function(e){f||(f=!0,d.resolve(h(e)))},function(e){f||d.notify(m(e))})}),d.promise},all:function(e){var t=r(),n=0,o=N(e)?[]:{};w(e,function(e,r){n++,i(e).then(function(e){o.hasOwnProperty(r)||(o[r]=e,--n||t.resolve(o))},function(e){o.hasOwnProperty(r)||t.reject(e)})}),0===n&&t.resolve(o);return t.promise}}}(function(t){e.$evalAsync(t)},t)}]}function $n(){this.$get=["$window","$timeout",function(e,t){var n=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame,r=e.cancelAnimationFrame||e.webkitCancelAnimationFrame||e.mozCancelAnimationFrame||e.webkitCancelRequestAnimationFrame,i=!!n,o=i?function(e){var t=n(e);return function(){r(t)}}:function(e){var n=t(e,16.66,!1);return function(){t.cancel(n)}};return o.supported=i,o}]}function yn(){var e=10,t=r("$rootScope"),n=null;this.digestTtl=function(t){return arguments.length&&(e=t),e},this.$get=["$injector","$exceptionHandler","$parse","$browser",function(r,i,o,s){function u(){this.$id=C(),this.$$phase=this.$parent=this.$$watchers=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=null,this.this=this.$root=this,this.$$destroyed=!1,this.$$asyncQueue=[],this.$$postDigestQueue=[],this.$$listeners={},this.$$listenerCount={},this.$$isolateBindings={}}u.prototype={constructor:u,$new:function(e){var t;return e?((t=new u).$root=this.$root,t.$$asyncQueue=this.$$asyncQueue,t.$$postDigestQueue=this.$$postDigestQueue):(this.$$childScopeClass||(this.$$childScopeClass=function(){this.$$watchers=this.$$nextSibling=this.$$childHead=this.$$childTail=null,this.$$listeners={},this.$$listenerCount={},this.$id=C(),this.$$childScopeClass=null},this.$$childScopeClass.prototype=this),t=new this.$$childScopeClass),t.this=t,t.$parent=this,t.$$prevSibling=this.$$childTail,this.$$childHead?(this.$$childTail.$$nextSibling=t,this.$$childTail=t):this.$$childHead=this.$$childTail=t,t},$watch:function(e,t,r){var i=d(e,"watch"),o=this.$$watchers,a={fn:t,last:h,get:i,exp:e,eq:!!r};if(n=null,!F(t)){var s=d(t||_,"listener");a.fn=function(e,t,n){s(n)}}if("string"==typeof e&&i.constant){var u=a.fn;a.fn=function(e,t,n){u.call(this,e,t,n),W(o,a)}}return o||(o=this.$$watchers=[]),o.unshift(a),function(){W(o,a),n=null}},$watchCollection:function(e,t){var n,r,i,s=this,u=t.length>1,l=0,c=o(e),f=[],d={},p=!0,h=0;return this.$watch(function(){var e,t;if(j(n=c(s)))if(y(n)){r!==f&&(h=(r=f).length=0,l++),e=n.length,h!==e&&(l++,r.length=h=e);for(var i=0;i<e;i++)r[i]!=r[i]&&n[i]!=n[i]||r[i]===n[i]||(l++,r[i]=n[i])}else{for(t in r!==d&&(r=d={},h=0,l++),e=0,n)n.hasOwnProperty(t)&&(e++,r.hasOwnProperty(t)?r[t]!=r[t]&&n[t]!=n[t]||r[t]===n[t]||(l++,r[t]=n[t]):(h++,r[t]=n[t],l++));if(h>e)for(t in l++,r)r.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(h--,delete r[t])}else r!==n&&(r=n,l++);return l},function(){if(p?(p=!1,t(n,n,s)):t(n,i,s),u)if(j(n))if(y(n)){i=new Array(n.length);for(var e=0;e<n.length;e++)i[e]=n[e]}else for(var r in i={},n)a.call(n,r)&&(i[r]=n[r]);else i=n})},$digest:function(){var r,o,a,u,l,d,p,m,v,g,$,y=this.$$asyncQueue,w=this.$$postDigestQueue,b=e,x=[];c("$digest"),s.$$checkUrlChange(),n=null;do{for(d=!1,m=this;y.length;){try{($=y.shift()).scope.$eval($.expression)}catch(e){f(),i(e)}n=null}e:do{if(u=m.$$watchers)for(l=u.length;l--;)try{if(r=u[l])if((o=r.get(m))===(a=r.last)||(r.eq?X(o,a):"number"==typeof o&&"number"==typeof a&&isNaN(o)&&isNaN(a))){if(r===n){d=!1;break e}}else d=!0,n=r,r.last=r.eq?G(o,null):o,r.fn(o,a===h?o:a,m),b<5&&(x[v=4-b]||(x[v]=[]),g=F(r.exp)?"fn: "+(r.exp.name||r.exp.toString()):r.exp,g+="; newVal: "+te(o)+"; oldVal: "+te(a),x[v].push(g))}catch(e){f(),i(e)}if(!(p=m.$$childHead||m!==this&&m.$$nextSibling))for(;m!==this&&!(p=m.$$nextSibling);)m=m.$parent}while(m=p);if((d||y.length)&&!b--)throw f(),t("infdig","{0} $digest() iterations reached. Aborting!\nWatchers fired in the last 5 iterations: {1}",e,te(x))}while(d||y.length);for(f();w.length;)try{w.shift()()}catch(e){i(e)}},$destroy:function(){if(!this.$$destroyed){var e=this.$parent;this.$broadcast("$destroy"),this.$$destroyed=!0,this!==l&&(w(this.$$listenerCount,Z(null,p,this)),e.$$childHead==this&&(e.$$childHead=this.$$nextSibling),e.$$childTail==this&&(e.$$childTail=this.$$prevSibling),this.$$prevSibling&&(this.$$prevSibling.$$nextSibling=this.$$nextSibling),this.$$nextSibling&&(this.$$nextSibling.$$prevSibling=this.$$prevSibling),this.$parent=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=this.$root=null,this.$$listeners={},this.$$watchers=this.$$asyncQueue=this.$$postDigestQueue=[],this.$destroy=this.$digest=this.$apply=_,this.$on=this.$watch=function(){return _})}},$eval:function(e,t){return o(e)(this,t)},$evalAsync:function(e){l.$$phase||l.$$asyncQueue.length||s.defer(function(){l.$$asyncQueue.length&&l.$digest()}),this.$$asyncQueue.push({scope:this,expression:e})},$$postDigest:function(e){this.$$postDigestQueue.push(e)},$apply:function(e){try{return c("$apply"),this.$eval(e)}catch(e){i(e)}finally{f();try{l.$digest()}catch(e){throw i(e),e}}},$on:function(e,t){var n=this.$$listeners[e];n||(this.$$listeners[e]=n=[]),n.push(t);for(var r=this;r.$$listenerCount[e]||(r.$$listenerCount[e]=0),r.$$listenerCount[e]++,r=r.$parent;);var i=this;return function(){var r=H(n,t);-1!==r&&(n[r]=null,p(i,1,e))}},$emit:function(e,t){var n,r,o,a=[],s=this,u=!1,l={name:e,targetScope:s,stopPropagation:function(){u=!0},preventDefault:function(){l.defaultPrevented=!0},defaultPrevented:!1},c=J([l],arguments,1);do{for(n=s.$$listeners[e]||a,l.currentScope=s,r=0,o=n.length;r<o;r++)if(n[r])try{n[r].apply(null,c)}catch(e){i(e)}else n.splice(r,1),r--,o--;if(u)return l;s=s.$parent}while(s);return l},$broadcast:function(e,t){for(var n,r,o,a=this,s=a,u=a,l={name:e,targetScope:a,preventDefault:function(){l.defaultPrevented=!0},defaultPrevented:!1},c=J([l],arguments,1);s=u;){for(l.currentScope=s,r=0,o=(n=s.$$listeners[e]||[]).length;r<o;r++)if(n[r])try{n[r].apply(null,c)}catch(e){i(e)}else n.splice(r,1),r--,o--;if(!(u=s.$$listenerCount[e]&&s.$$childHead||s!==a&&s.$$nextSibling))for(;s!==a&&!(u=s.$$nextSibling);)s=s.$parent}return l}};var l=new u;return l;function c(e){if(l.$$phase)throw t("inprog","{0} already in progress",l.$$phase);l.$$phase=e}function f(){l.$$phase=null}function d(e,t){var n=o(e);return he(n,t),n}function p(e,t,n){for(;e.$$listenerCount[n]-=t,0===e.$$listenerCount[n]&&delete e.$$listenerCount[n],e=e.$parent;);}function h(){}}]}function wn(){var e=/^\s*(https?|ftp|mailto|tel|file):/,t=/^\s*((https?|ftp|file):|data:image\/)/;this.aHrefSanitizationWhitelist=function(t){return T(t)?(e=t,this):e},this.imgSrcSanitizationWhitelist=function(e){return T(e)?(t=e,this):t},this.$get=function(){return function(n,r){var i,o=r?t:e;return u&&!(u>=8)||""===(i=Pn(n).href)||i.match(o)?n:"unsafe:"+i}}}var bn=r("$sce"),xn={HTML:"html",CSS:"css",URL:"url",RESOURCE_URL:"resourceUrl",JS:"js"};function Cn(e){var t=[];return T(e)&&w(e,function(e){t.push(function(e){if("self"===e)return e;if(D(e)){if(e.indexOf("***")>-1)throw bn("iwcard","Illegal sequence *** in string matcher.  String: {0}",e);return e=(t=e,t.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")).replace("\\*\\*",".*").replace("\\*","[^:/.?&;]*"),new RegExp("^"+e+"$")}if(I(e))return new RegExp("^"+e.source+"$");throw bn("imatcher",'Matchers may only be "self", string patterns or RegExp objects');var t}(e))}),t}function Sn(){this.SCE_CONTEXTS=xn;var e=["self"],t=[];this.resourceUrlWhitelist=function(t){return arguments.length&&(e=Cn(t)),e},this.resourceUrlBlacklist=function(e){return arguments.length&&(t=Cn(e)),t},this.$get=["$injector",function(r){var i=function(e){throw bn("unsafe","Attempting to use an unsafe value in a safe context.")};function o(e,t){return"self"===e?Mn(t):!!e.exec(t.href)}function a(e){var t=function(e){this.$$unwrapTrustedValue=function(){return e}};return e&&(t.prototype=new e),t.prototype.valueOf=function(){return this.$$unwrapTrustedValue()},t.prototype.toString=function(){return this.$$unwrapTrustedValue().toString()},t}r.has("$sanitize")&&(i=r.get("$sanitize"));var s=a(),u={};return u[xn.HTML]=a(s),u[xn.CSS]=a(s),u[xn.URL]=a(s),u[xn.JS]=a(s),u[xn.RESOURCE_URL]=a(u[xn.URL]),{trustAs:function(e,t){var r=u.hasOwnProperty(e)?u[e]:null;if(!r)throw bn("icontext","Attempted to trust a value in invalid context. Context: {0}; Value: {1}",e,t);if(null===t||t===n||""===t)return t;if("string"!=typeof t)throw bn("itype","Attempted to trust a non-string value in a content requiring a string: Context: {0}",e);return new r(t)},getTrusted:function(r,a){if(null===a||a===n||""===a)return a;var s=u.hasOwnProperty(r)?u[r]:null;if(s&&a instanceof s)return a.$$unwrapTrustedValue();if(r===xn.RESOURCE_URL){if(function(n){var r,i,a=Pn(n.toString()),s=!1;for(r=0,i=e.length;r<i;r++)if(o(e[r],a)){s=!0;break}if(s)for(r=0,i=t.length;r<i;r++)if(o(t[r],a)){s=!1;break}return s}(a))return a;throw bn("insecurl","Blocked loading resource from url not allowed by $sceDelegate policy.  URL: {0}",a.toString())}if(r===xn.HTML)return i(a);throw bn("unsafe","Attempting to use an unsafe value in a safe context.")},valueOf:function(e){return e instanceof s?e.$$unwrapTrustedValue():e}}}]}function En(){var e=!0;this.enabled=function(t){return arguments.length&&(e=!!t),e},this.$get=["$parse","$sniffer","$sceDelegate",function(t,n,r){if(e&&n.msie&&n.msieDocumentMode<8)throw bn("iequirks","Strict Contextual Escaping does not support Internet Explorer version < 9 in quirks mode.  You can fix this by adding the text <!doctype html> to the top of your HTML document.  See http://docs.angularjs.org/api/ng.$sce for more information.");var i=Q(xn);i.isEnabled=function(){return e},i.trustAs=r.trustAs,i.getTrusted=r.getTrusted,i.valueOf=r.valueOf,e||(i.trustAs=i.getTrusted=function(e,t){return t},i.valueOf=A),i.parseAs=function(e,n){var r=t(n);return r.literal&&r.constant?r:function(t,n){return i.getTrusted(e,r(t,n))}};var a=i.parseAs,s=i.getTrusted,u=i.trustAs;return w(xn,function(e,t){var n=o(t);i[qe("parse_as_"+n)]=function(t){return a(e,t)},i[qe("get_trusted_"+n)]=function(t){return s(e,t)},i[qe("trust_as_"+n)]=function(t){return u(e,t)}}),i}]}function qn(){this.$get=["$window","$document",function(e,t){var n,r,i={},a=q((/android (\d+)/.exec(o((e.navigator||{}).userAgent))||[])[1]),s=/Boxee/i.test((e.navigator||{}).userAgent),l=t[0]||{},c=l.documentMode,f=/^(Moz|webkit|O|ms)(?=[A-Z])/,d=l.body&&l.body.style,p=!1,h=!1;if(d){for(var m in d)if(r=f.exec(m)){n=(n=r[0]).substr(0,1).toUpperCase()+n.substr(1);break}n||(n="WebkitOpacity"in d&&"webkit"),p=!!("transition"in d||n+"Transition"in d),h=!!("animation"in d||n+"Animation"in d),!a||p&&h||(p=D(l.body.style.webkitTransition),h=D(l.body.style.webkitAnimation))}return{history:!(!e.history||!e.history.pushState||a<4||s),hashchange:"onhashchange"in e&&(!c||c>7),hasEvent:function(e){if("input"==e&&9==u)return!1;if(M(i[e])){var t=l.createElement("div");i[e]="on"+e in t}return i[e]},csp:Y(),vendorPrefix:n,transitions:p,animations:h,android:a,msie:u,msieDocumentMode:c}}]}function kn(){this.$get=["$rootScope","$browser","$q","$exceptionHandler",function(e,t,n,r){var i={};function o(o,a,s){var u,l=n.defer(),c=l.promise,f=T(s)&&!s;return u=t.defer(function(){try{l.resolve(o())}catch(e){l.reject(e),r(e)}finally{delete i[c.$$timeoutId]}f||e.$apply()},a),c.$$timeoutId=u,i[u]=l,c}return o.cancel=function(e){return!!(e&&e.$$timeoutId in i)&&(i[e.$$timeoutId].reject("canceled"),delete i[e.$$timeoutId],t.defer.cancel(e.$$timeoutId))},o}]}var _n=t.createElement("a"),An=Pn(e.location.href,!0);function Pn(e,t){var n=e;return u&&(_n.setAttribute("href",n),n=_n.href),_n.setAttribute("href",n),{href:_n.href,protocol:_n.protocol?_n.protocol.replace(/:$/,""):"",host:_n.host,search:_n.search?_n.search.replace(/^\?/,""):"",hash:_n.hash?_n.hash.replace(/^#/,""):"",hostname:_n.hostname,port:_n.port,pathname:"/"===_n.pathname.charAt(0)?_n.pathname:"/"+_n.pathname}}function Mn(e){var t=D(e)?Pn(e):e;return t.protocol===An.protocol&&t.host===An.host}function Tn(){this.$get=P(e)}function jn(e){var t="Filter";function n(r,i){if(j(r)){var o={};return w(r,function(e,t){o[t]=n(t,e)}),o}return e.factory(r+t,i)}this.register=n,this.$get=["$injector",function(e){return function(n){return e.get(n+t)}}],n("currency",On),n("date",Hn),n("filter",Dn),n("json",Wn),n("limitTo",Xn),n("lowercase",Gn),n("number",Rn),n("orderBy",Yn),n("uppercase",Qn)}function Dn(){return function(e,t,n){if(!N(e))return e;var r=typeof n,i=[];i.check=function(e){for(var t=0;t<i.length;t++)if(!i[t](e))return!1;return!0},"function"!==r&&(n="boolean"===r&&n?function(e,t){return g.equals(e,t)}:function(e,t){if(e&&t&&"object"==typeof e&&"object"==typeof t){for(var r in e)if("$"!==r.charAt(0)&&a.call(e,r)&&n(e[r],t[r]))return!0;return!1}return t=(""+t).toLowerCase(),(""+e).toLowerCase().indexOf(t)>-1});var o=function(e,t){if("string"==typeof t&&"!"===t.charAt(0))return!o(e,t.substr(1));switch(typeof e){case"boolean":case"number":case"string":return n(e,t);case"object":switch(typeof t){case"object":return n(e,t);default:for(var r in e)if("$"!==r.charAt(0)&&o(e[r],t))return!0}return!1;case"array":for(var i=0;i<e.length;i++)if(o(e[i],t))return!0;return!1;default:return!1}};switch(typeof t){case"boolean":case"number":case"string":t={$:t};case"object":for(var s in t)!function(e){void 0!==t[e]&&i.push(function(n){return o("$"==e?n:n&&n[e],t[e])})}(s);break;case"function":i.push(t);break;default:return e}for(var u=[],l=0;l<e.length;l++){var c=e[l];i.check(c)&&u.push(c)}return u}}function On(e){var t=e.NUMBER_FORMATS;return function(e,n){return M(n)&&(n=t.CURRENCY_SYM),Fn(e,t.PATTERNS[1],t.GROUP_SEP,t.DECIMAL_SEP,2).replace(/\u00A4/g,n)}}function Rn(e){var t=e.NUMBER_FORMATS;return function(e,n){return Fn(e,t.PATTERNS[0],t.GROUP_SEP,t.DECIMAL_SEP,n)}}jn.$inject=["$provide"],On.$inject=["$locale"],Rn.$inject=["$locale"];var Nn=".";function Fn(e,t,n,r,i){if(null==e||!isFinite(e)||j(e))return"";var o=e<0,a=(e=Math.abs(e))+"",s="",u=[],l=!1;if(-1!==a.indexOf("e")){var c=a.match(/([\d\.]+)e(-?)(\d+)/);c&&"-"==c[2]&&c[3]>i+1?(a="0",e=0):(s=a,l=!0)}if(l)i>0&&e>-1&&e<1&&(s=e.toFixed(i));else{var f=(a.split(Nn)[1]||"").length;M(i)&&(i=Math.min(Math.max(t.minFrac,f),t.maxFrac)),0===(e=+(Math.round(+(e.toString()+"e"+i)).toString()+"e"+-i))&&(o=!1);var d=(""+e).split(Nn),p=d[0];d=d[1]||"";var h,m=0,v=t.lgSize,g=t.gSize;if(p.length>=v+g)for(m=p.length-v,h=0;h<m;h++)(m-h)%g==0&&0!==h&&(s+=n),s+=p.charAt(h);for(h=m;h<p.length;h++)(p.length-h)%v==0&&0!==h&&(s+=n),s+=p.charAt(h);for(;d.length<i;)d+="0";i&&"0"!==i&&(s+=r+d.substr(0,i))}return u.push(o?t.negPre:t.posPre),u.push(s),u.push(o?t.negSuf:t.posSuf),u.join("")}function In(e,t,n){var r="";for(e<0&&(r="-",e=-e),e=""+e;e.length<t;)e="0"+e;return n&&(e=e.substr(e.length-t)),r+e}function Un(e,t,n,r){return n=n||0,function(i){var o=i["get"+e]();return(n>0||o>-n)&&(o+=n),0===o&&-12==n&&(o=12),In(o,t,r)}}function Ln(e,t){return function(n,r){var i=n["get"+e]();return r[s(t?"SHORT"+e:e)][i]}}var Vn={yyyy:Un("FullYear",4),yy:Un("FullYear",2,0,!0),y:Un("FullYear",1),MMMM:Ln("Month"),MMM:Ln("Month",!0),MM:Un("Month",2,1),M:Un("Month",1,1),dd:Un("Date",2),d:Un("Date",1),HH:Un("Hours",2),H:Un("Hours",1),hh:Un("Hours",2,-12),h:Un("Hours",1,-12),mm:Un("Minutes",2),m:Un("Minutes",1),ss:Un("Seconds",2),s:Un("Seconds",1),sss:Un("Milliseconds",3),EEEE:Ln("Day"),EEE:Ln("Day",!0),a:function(e,t){return e.getHours()<12?t.AMPMS[0]:t.AMPMS[1]},Z:function(e){var t=-1*e.getTimezoneOffset(),n=t>=0?"+":"";return n+=In(Math[t>0?"floor":"ceil"](t/60),2)+In(Math.abs(t%60),2)}},Bn=/((?:[^yMdHhmsaZE']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z))(.*)/,zn=/^\-?\d+$/;function Hn(e){var t=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/;return function(n,r){var i,o,a="",s=[];if(r=r||"mediumDate",r=e.DATETIME_FORMATS[r]||r,D(n)&&(n=zn.test(n)?q(n):function(e){var n;if(n=e.match(t)){var r=new Date(0),i=0,o=0,a=n[8]?r.setUTCFullYear:r.setFullYear,s=n[8]?r.setUTCHours:r.setHours;n[9]&&(i=q(n[9]+n[10]),o=q(n[9]+n[11])),a.call(r,q(n[1]),q(n[2])-1,q(n[3]));var u=q(n[4]||0)-i,l=q(n[5]||0)-o,c=q(n[6]||0),f=Math.round(1e3*parseFloat("0."+(n[7]||0)));return s.call(r,u,l,c,f),r}return e}(n)),O(n)&&(n=new Date(n)),!R(n))return n;for(;r;)(o=Bn.exec(r))?r=(s=J(s,o,1)).pop():(s.push(r),r=null);return w(s,function(t){i=Vn[t],a+=i?i(n,e.DATETIME_FORMATS):t.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),a}}function Wn(){return function(e){return te(e,!0)}}Hn.$inject=["$locale"];var Gn=P(o),Qn=P(s);function Xn(){return function(e,t){if(!N(e)&&!D(e))return e;if(t=Math.abs(Number(t))===1/0?Number(t):q(t),D(e))return t?t>=0?e.slice(0,t):e.slice(t,e.length):"";var n,r,i=[];for(t>e.length?t=e.length:t<-e.length&&(t=-e.length),t>0?(n=0,r=t):(n=e.length+t,r=e.length);n<r;n++)i.push(e[n]);return i}}function Yn(e){return function(t,n,r){return y(t)?(0===(n=N(n)?n:[n]).length&&(n=["+"]),i=function(t){var n=!1,r=t||A;if(D(t)){if("+"!=t.charAt(0)&&"-"!=t.charAt(0)||(n="-"==t.charAt(0),t=t.substring(1)),""===t)return s(function(e,t){return u(e,t)},n);if((r=e(t)).constant){var i=r();return s(function(e,t){return u(e[i],t[i])},n)}}return s(function(e,t){return u(r(e),r(t))},n)},a=[],w(n,function(e,t,n){a.push(i.call(o,e,t,n))}),n=a,p.call(t).sort(s(function(e,t){for(var r=0;r<n.length;r++){var i=n[r](e,t);if(0!==i)return i}return 0},r))):t;var i,o,a;function s(e,t){return re(t)?function(t,n){return e(n,t)}:e}function u(e,t){var n=typeof e,r=typeof t;return n==r?(R(e)&&R(t)&&(e=e.valueOf(),t=t.valueOf()),"string"==n&&(e=e.toLowerCase(),t=t.toLowerCase()),e===t?0:e<t?-1:1):n<r?-1:1}}}function Jn(e){return F(e)&&(e={link:e}),e.restrict=e.restrict||"AC",P(e)}Yn.$inject=["$parse"];var Kn=P({restrict:"E",compile:function(e,n){if(u<=8&&(n.href||n.name||n.$set("href",""),e.append(t.createComment("IE fix"))),!n.href&&!n.xlinkHref&&!n.name)return function(e,t){var n="[object SVGAnimatedString]"===m.call(t.prop("href"))?"xlink:href":"href";t.on("click",function(e){t.attr(n)||e.preventDefault()})}}}),Zn={};w(Ye,function(e,t){if("multiple"!=e){var n=yt("ng-"+t);Zn[n]=function(){return{priority:100,link:function(e,r,i){e.$watch(i[n],function(e){i.$set(t,!!e)})}}}}}),w(["src","srcset","href"],function(e){var t=yt("ng-"+e);Zn[t]=function(){return{priority:99,link:function(n,r,i){var o=e,a=e;"href"===e&&"[object SVGAnimatedString]"===m.call(r.prop("href"))&&(a="xlinkHref",i.$attr[a]="xlink:href",o=null),i.$observe(t,function(t){t?(i.$set(a,t),u&&o&&r.prop(o,i[a])):"href"===e&&i.$set(a,null)})}}}});var er={$addControl:_,$removeControl:_,$setValidity:_,$setDirty:_,$setPristine:_};function tr(e,t,n,r){var i=this,o=e.parent().controller("form")||er,a=0,s=i.$error={},u=[];function l(t,n){n=n?"-"+de(n,"-"):"",r.setClass(e,(t?hr:mr)+n,(t?mr:hr)+n)}i.$name=t.name||t.ngForm,i.$dirty=!1,i.$pristine=!0,i.$valid=!0,i.$invalid=!1,o.$addControl(i),e.addClass(vr),l(!0),i.$addControl=function(e){me(e.$name,"input"),u.push(e),e.$name&&(i[e.$name]=e)},i.$removeControl=function(e){e.$name&&i[e.$name]===e&&delete i[e.$name],w(s,function(t,n){i.$setValidity(n,!0,e)}),W(u,e)},i.$setValidity=function(e,t,n){var r=s[e];if(t)r&&(W(r,n),r.length||(--a||(l(t),i.$valid=!0,i.$invalid=!1),s[e]=!1,l(!0,e),o.$setValidity(e,!0,i)));else{if(a||l(t),r){if(-1!=H(r,n))return}else s[e]=r=[],a++,l(!1,e),o.$setValidity(e,!1,i);r.push(n),i.$valid=!1,i.$invalid=!0}},i.$setDirty=function(){r.removeClass(e,vr),r.addClass(e,gr),i.$dirty=!0,i.$pristine=!1,o.$setDirty()},i.$setPristine=function(){r.removeClass(e,gr),r.addClass(e,vr),i.$dirty=!1,i.$pristine=!0,w(u,function(e){e.$setPristine()})}}tr.$inject=["$element","$attrs","$scope","$animate"];var nr=function(e){return["$timeout",function(t){return{name:"form",restrict:e?"EAC":"E",controller:tr,compile:function(){return{pre:function(e,r,i,o){if(!i.action){var a=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1};be(r[0],"submit",a),r.on("$destroy",function(){t(function(){xe(r[0],"submit",a)},0,!1)})}var s=r.parent().controller("form"),u=i.name||i.ngForm;u&&cn(e,u,o,u),s&&r.on("$destroy",function(){s.$removeControl(o),u&&cn(e,u,n,u),E(o,er)})}}}}}]},rr=nr(),ir=nr(!0),or=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/,ar=/^[a-z0-9!#$%&'*+\/=?^_`{|}~.-]+@[a-z0-9]([a-z0-9-]*[a-z0-9])?(\.[a-z0-9]([a-z0-9-]*[a-z0-9])?)*$/i,sr=/^\s*(\-|\+)?(\d+|(\d*(\.\d*)))\s*$/,ur={text:fr,number:function(e,t,r,i,o,a){if(fr(e,t,r,i,o,a),i.$parsers.push(function(e){var t=i.$isEmpty(e);return t||sr.test(e)?(i.$setValidity("number",!0),""===e?null:t?e:parseFloat(e)):(i.$setValidity("number",!1),n)}),u=i,l="number",c=dr,f=null,d=i.$$validityState,j(d)&&(u.$$hasNativeValidators=!0,u.$parsers.push(function(e){if(u.$error[l]||cr(d,f)||!cr(d,c))return e;u.$setValidity(l,!1)})),i.$formatters.push(function(e){return i.$isEmpty(e)?"":""+e}),r.min){var s=function(e){var t=parseFloat(r.min);return lr(i,"min",i.$isEmpty(e)||e>=t,e)};i.$parsers.push(s),i.$formatters.push(s)}var u,l,c,f,d;if(r.max){var p=function(e){var t=parseFloat(r.max);return lr(i,"max",i.$isEmpty(e)||e<=t,e)};i.$parsers.push(p),i.$formatters.push(p)}i.$formatters.push(function(e){return lr(i,"number",i.$isEmpty(e)||O(e),e)})},url:function(e,t,n,r,i,o){fr(e,t,n,r,i,o);var a=function(e){return lr(r,"url",r.$isEmpty(e)||or.test(e),e)};r.$formatters.push(a),r.$parsers.push(a)},email:function(e,t,n,r,i,o){fr(e,t,n,r,i,o);var a=function(e){return lr(r,"email",r.$isEmpty(e)||ar.test(e),e)};r.$formatters.push(a),r.$parsers.push(a)},radio:function(e,t,n,r){M(n.name)&&t.attr("name",C());t.on("click",function(){t[0].checked&&e.$apply(function(){r.$setViewValue(n.value)})}),r.$render=function(){var e=n.value;t[0].checked=e==r.$viewValue},n.$observe("value",r.$render)},checkbox:function(e,t,n,r){var i=n.ngTrueValue,o=n.ngFalseValue;D(i)||(i=!0);D(o)||(o=!1);t.on("click",function(){e.$apply(function(){r.$setViewValue(t[0].checked)})}),r.$render=function(){t[0].checked=r.$viewValue},r.$isEmpty=function(e){return e!==i},r.$formatters.push(function(e){return e===i}),r.$parsers.push(function(e){return e?i:o})},hidden:_,button:_,submit:_,reset:_,file:_};function lr(e,t,r,i){return e.$setValidity(t,r),r?i:n}function cr(e,t){var n;if(t)for(n=0;n<t.length;++n)if(e[t[n]])return!0;return!1}function fr(e,t,n,a,s,l){var c=t.prop(i),f=t[0].placeholder,d={},p=o(t[0].type);if(a.$$validityState=c,!s.android){var h=!1;t.on("compositionstart",function(e){h=!0}),t.on("compositionend",function(){h=!1,m()})}var m=function(r){if(!h){var i=t.val();if(u&&"input"===(r||d).type&&t[0].placeholder!==f)f=t[0].placeholder;else{"password"!==p&&re(n.ngTrim||"T")&&(i=B(i));var o=c&&a.$$hasNativeValidators;(a.$viewValue!==i||""===i&&o)&&(e.$root.$$phase?a.$setViewValue(i):e.$apply(function(){a.$setViewValue(i)}))}}};if(s.hasEvent("input"))t.on("input",m);else{var v,g=function(){v||(v=l.defer(function(){m(),v=null}))};t.on("keydown",function(e){var t=e.keyCode;91===t||15<t&&t<19||37<=t&&t<=40||g()}),s.hasEvent("paste")&&t.on("paste cut",g)}t.on("change",m),a.$render=function(){t.val(a.$isEmpty(a.$viewValue)?"":a.$viewValue)};var $,y,w=n.ngPattern;if(w){var b=function(e,t){return lr(a,"pattern",a.$isEmpty(t)||e.test(t),t)};(y=w.match(/^\/(.*)\/([gim]*)$/))?(w=new RegExp(y[1],y[2]),$=function(e){return b(w,e)}):$=function(n){var i=e.$eval(w);if(!i||!i.test)throw r("ngPattern")("noregexp","Expected {0} to be a RegExp but was {1}. Element: {2}",w,i,ie(t));return b(i,n)},a.$formatters.push($),a.$parsers.push($)}if(n.ngMinlength){var x=q(n.ngMinlength),C=function(e){return lr(a,"minlength",a.$isEmpty(e)||e.length>=x,e)};a.$parsers.push(C),a.$formatters.push(C)}if(n.ngMaxlength){var S=q(n.ngMaxlength),E=function(e){return lr(a,"maxlength",a.$isEmpty(e)||e.length<=S,e)};a.$parsers.push(E),a.$formatters.push(E)}}var dr=["badInput"];var pr=["$browser","$sniffer",function(e,t){return{restrict:"E",require:"?ngModel",link:function(n,r,i,a){a&&(ur[o(i.type)]||ur.text)(n,r,i,a,t,e)}}}],hr="ng-valid",mr="ng-invalid",vr="ng-pristine",gr="ng-dirty",$r=["$scope","$exceptionHandler","$attrs","$element","$parse","$animate",function(e,t,n,i,o,a){this.$viewValue=Number.NaN,this.$modelValue=Number.NaN,this.$parsers=[],this.$formatters=[],this.$viewChangeListeners=[],this.$pristine=!0,this.$dirty=!1,this.$valid=!0,this.$invalid=!1,this.$name=n.name;var s=o(n.ngModel),u=s.assign;if(!u)throw r("ngModel")("nonassign","Expression '{0}' is non-assignable. Element: {1}",n.ngModel,ie(i));this.$render=_,this.$isEmpty=function(e){return M(e)||""===e||null===e||e!=e};var l=i.inheritedData("$formController")||er,c=0,f=this.$error={};function d(e,t){t=t?"-"+de(t,"-"):"",a.removeClass(i,(e?mr:hr)+t),a.addClass(i,(e?hr:mr)+t)}i.addClass(vr),d(!0),this.$setValidity=function(e,t){f[e]!==!t&&(t?(f[e]&&c--,c||(d(!0),this.$valid=!0,this.$invalid=!1)):(d(!1),this.$invalid=!0,this.$valid=!1,c++),f[e]=!t,d(t,e),l.$setValidity(e,t,this))},this.$setPristine=function(){this.$dirty=!1,this.$pristine=!0,a.removeClass(i,gr),a.addClass(i,vr)},this.$setViewValue=function(n){this.$viewValue=n,this.$pristine&&(this.$dirty=!0,this.$pristine=!1,a.removeClass(i,vr),a.addClass(i,gr),l.$setDirty()),w(this.$parsers,function(e){n=e(n)}),this.$modelValue!==n&&(this.$modelValue=n,u(e,n),w(this.$viewChangeListeners,function(e){try{e()}catch(e){t(e)}}))};var p=this;e.$watch(function(){var t=s(e);if(p.$modelValue!==t){var n=p.$formatters,r=n.length;for(p.$modelValue=t;r--;)t=n[r](t);p.$viewValue!==t&&(p.$viewValue=t,p.$render())}return t})}],yr=function(){return{require:["ngModel","^?form"],controller:$r,link:function(e,t,n,r){var i=r[0],o=r[1]||er;o.$addControl(i),e.$on("$destroy",function(){o.$removeControl(i)})}}},wr=P({require:"ngModel",link:function(e,t,n,r){r.$viewChangeListeners.push(function(){e.$eval(n.ngChange)})}}),br=function(){return{require:"?ngModel",link:function(e,t,n,r){if(r){n.required=!0;var i=function(e){return n.required&&r.$isEmpty(e)?void r.$setValidity("required",!1):(r.$setValidity("required",!0),e)};r.$formatters.push(i),r.$parsers.unshift(i),n.$observe("required",function(){i(r.$viewValue)})}}}},xr=function(){return{require:"ngModel",link:function(e,t,r,i){var o=/\/(.*)\//.exec(r.ngList),a=o&&new RegExp(o[1])||r.ngList||",";i.$parsers.push(function(e){if(!M(e)){var t=[];return e&&w(e.split(a),function(e){e&&t.push(B(e))}),t}}),i.$formatters.push(function(e){return N(e)?e.join(", "):n}),i.$isEmpty=function(e){return!e||!e.length}}}},Cr=/^(true|false|\d+)$/,Sr=function(){return{priority:100,compile:function(e,t){return Cr.test(t.ngValue)?function(e,t,n){n.$set("value",e.$eval(n.ngValue))}:function(e,t,n){e.$watch(n.ngValue,function(e){n.$set("value",e)})}}}},Er=Jn({compile:function(e){return e.addClass("ng-binding"),function(e,t,r){t.data("$binding",r.ngBind),e.$watch(r.ngBind,function(e){t.text(e==n?"":e)})}}}),qr=["$interpolate",function(e){return function(t,n,r){var i=e(n.attr(r.$attr.ngBindTemplate));n.addClass("ng-binding").data("$binding",i),r.$observe("ngBindTemplate",function(e){n.text(e)})}}],kr=["$sce","$parse",function(e,t){return{compile:function(n){return n.addClass("ng-binding"),function(n,r,i){r.data("$binding",i.ngBindHtml);var o=t(i.ngBindHtml);n.$watch(function(){return(o(n)||"").toString()},function(t){r.html(e.getTrustedHtml(o(n))||"")})}}}}];function _r(e,t){return e="ngClass"+e,["$animate",function(n){return{restrict:"AC",link:function(o,a,s){var u;function l(e){var t=c(e,1);s.$addClass(t)}function c(e,t){var n=a.data("$classCounts")||{},r=[];return w(e,function(e){(t>0||n[e])&&(n[e]=(n[e]||0)+t,n[e]===+(t>0)&&r.push(e))}),a.data("$classCounts",n),r.join(" ")}function f(e){if(!0===t||o.$index%2===t){var s=i(e||[]);if(u){if(!X(e,u)){var f=i(u);h=r(p=s,d=f),m=c(m=r(d,p),-1),0===(h=c(h,1)).length?n.removeClass(a,m):0===m.length?n.addClass(a,h):n.setClass(a,h,m)}}else l(s)}var d,p,h,m;u=Q(e)}o.$watch(s[e],f,!0),s.$observe("class",function(t){f(o.$eval(s[e]))}),"ngClass"!==e&&o.$watch("$index",function(n,r){var a,u=1&n;if(u!==(1&r)){var f=i(o.$eval(s[e]));u===t?l(f):(a=c(f,-1),s.$removeClass(a))}})}};function r(e,t){var n=[];e:for(var r=0;r<e.length;r++){for(var i=e[r],o=0;o<t.length;o++)if(i==t[o])continue e;n.push(i)}return n}function i(e){if(N(e))return e;if(D(e))return e.split(" ");if(j(e)){var t=[];return w(e,function(e,n){e&&(t=t.concat(n.split(" ")))}),t}return e}}]}var Ar=_r("",!0),Pr=_r("Odd",0),Mr=_r("Even",1),Tr=Jn({compile:function(e,t){t.$set("ngCloak",n),e.removeClass("ng-cloak")}}),jr=[function(){return{scope:!0,controller:"@",priority:500}}],Dr={},Or={blur:!0,focus:!0};w("click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste".split(" "),function(e){var t=yt("ng-"+e);Dr[t]=["$parse","$rootScope",function(n,r){return{compile:function(i,o){var a=n(o[t],!0);return function(t,n){n.on(e,function(n){var i=function(){a(t,{$event:n})};Or[e]&&r.$$phase?t.$evalAsync(i):t.$apply(i)})}}}}]});var Rr=["$animate",function(e){return{transclude:"element",priority:600,terminal:!0,restrict:"A",$$tlb:!0,link:function(n,r,i,o,a){var s,u,l;n.$watch(i.ngIf,function(o){re(o)?u||(u=n.$new(),a(u,function(n){n[n.length++]=t.createComment(" end ngIf: "+i.ngIf+" "),s={clone:n},e.enter(n,r.parent(),r)})):(l&&(l.remove(),l=null),u&&(u.$destroy(),u=null),s&&(l=ge(s.clone),e.leave(l,function(){l=null}),s=null))})}}}],Nr=["$http","$templateCache","$anchorScroll","$animate","$sce",function(e,t,n,r,i){return{restrict:"ECA",priority:400,terminal:!0,transclude:"element",controller:g.noop,compile:function(o,a){var s=a.ngInclude||a.src,u=a.onload||"",l=a.autoscroll;return function(o,a,c,f,d){var p,h,m,v=0,g=function(){h&&(h.remove(),h=null),p&&(p.$destroy(),p=null),m&&(r.leave(m,function(){h=null}),h=m,m=null)};o.$watch(i.parseAsResourceUrl(s),function(i){var s=function(){!T(l)||l&&!o.$eval(l)||n()},c=++v;i?(e.get(i,{cache:t}).success(function(e){if(c===v){var t=o.$new();f.template=e;var n=d(t,function(e){g(),r.enter(e,null,a,s)});m=n,(p=t).$emit("$includeContentLoaded"),o.$eval(u)}}).error(function(){c===v&&g()}),o.$emit("$includeContentRequested")):(g(),f.template=null)})}}}}],Fr=["$compile",function(e){return{restrict:"ECA",priority:-400,require:"ngInclude",link:function(t,n,r,i){n.html(i.template),e(n.contents())(t)}}}],Ir=Jn({priority:450,compile:function(){return{pre:function(e,t,n){e.$eval(n.ngInit)}}}}),Ur=Jn({terminal:!0,priority:1e3}),Lr=["$locale","$interpolate",function(e,t){var n=/{}/g;return{restrict:"EA",link:function(r,i,a){var s=a.count,u=a.$attr.when&&i.attr(a.$attr.when),l=a.offset||0,c=r.$eval(u)||{},f={},d=t.startSymbol(),p=t.endSymbol(),h=/^when(Minus)?(.+)$/;w(a,function(e,t){h.test(t)&&(c[o(t.replace("when","").replace("Minus","-"))]=i.attr(a.$attr[t]))}),w(c,function(e,r){f[r]=t(e.replace(n,d+s+"-"+l+p))}),r.$watch(function(){var t=parseFloat(r.$eval(s));return isNaN(t)?"":(t in c||(t=e.pluralCat(t-l)),f[t](r,i,!0))},function(e){i.text(e)})}}}],Vr=["$parse","$animate",function(e,n){var i="$$NG_REMOVED",o=r("ngRepeat");return{transclude:"element",priority:1e3,terminal:!0,$$tlb:!0,link:function(r,s,u,c,f){var d,p,h,m,v,g,$,b,x,C=u.ngRepeat,S=C.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?\s*$/),E={$id:Ze};if(!S)throw o("iexp","Expected expression in form of '_item_ in _collection_[ track by _id_]' but got '{0}'.",C);if(g=S[1],$=S[2],(d=S[3])?(p=e(d),h=function(e,t,n){return x&&(E[x]=e),E[b]=t,E.$index=n,p(r,E)}):(m=function(e,t){return Ze(t)},v=function(e){return e}),!(S=g.match(/^(?:([\$\w]+)|\(([\$\w]+)\s*,\s*([\$\w]+)\))$/)))throw o("iidexp","'_item_' in '_item_ in _collection_' should be an identifier or '(_key_, _value_)' expression, but got '{0}'.",g);b=S[3]||S[1],x=S[2];var q={};r.$watchCollection($,function(e){var u,c,d,p,g,$,S,E,k,_,A,P,M=s[0],T={},j=[];if(y(e))_=e,k=h||m;else{for($ in k=h||v,_=[],e)e.hasOwnProperty($)&&"$"!=$.charAt(0)&&_.push($);_.sort()}for(p=_.length,c=j.length=_.length,u=0;u<c;u++)if(me(E=k($=e===_?u:_[u],S=e[$],u),"`track by` id"),q.hasOwnProperty(E))A=q[E],delete q[E],T[E]=A,j[u]=A;else{if(T.hasOwnProperty(E))throw w(j,function(e){e&&e.scope&&(q[e.id]=e)}),o("dupes","Duplicates in a repeater are not allowed. Use 'track by' expression to specify unique keys. Repeater: {0}, Duplicate key: {1}, Duplicate value: {2}",C,E,te(S));j[u]={id:E},T[E]=!1}for($ in q)q.hasOwnProperty($)&&(P=ge((A=q[$]).clone),n.leave(P),w(P,function(e){e[i]=!0}),A.scope.$destroy());for(u=0,c=_.length;u<c;u++){if(S=e[$=e===_?u:_[u]],A=j[u],j[u-1]&&(M=a(j[u-1])),A.scope){for(g=A.scope,d=M;(d=d.nextSibling)&&d[i];);A.clone[0]!=d&&n.move(ge(A.clone),null,l(M)),M=a(A)}else g=r.$new();g[b]=S,x&&(g[x]=$),g.$index=u,g.$first=0===u,g.$last=u===p-1,g.$middle=!(g.$first||g.$last),g.$odd=!(g.$even=0==(1&u)),A.scope||f(g,function(e){e[e.length++]=t.createComment(" end ngRepeat: "+C+" "),n.enter(e,null,l(M)),M=e,A.scope=g,A.clone=e,T[A.id]=A})}q=T})}};function a(e){return e.clone[e.clone.length-1]}}],Br=["$animate",function(e){return function(t,n,r){t.$watch(r.ngShow,function(t){e[re(t)?"removeClass":"addClass"](n,"ng-hide")})}}],zr=["$animate",function(e){return function(t,n,r){t.$watch(r.ngHide,function(t){e[re(t)?"addClass":"removeClass"](n,"ng-hide")})}}],Hr=Jn(function(e,t,n){e.$watch(n.ngStyle,function(e,n){n&&e!==n&&w(n,function(e,n){t.css(n,"")}),e&&t.css(e)},!0)}),Wr=["$animate",function(e){return{restrict:"EA",require:"ngSwitch",controller:["$scope",function(){this.cases={}}],link:function(t,n,r,i){var o=r.ngSwitch||r.on,a=[],s=[],u=[],l=[];t.$watch(o,function(n){var o,c;for(o=0,c=u.length;o<c;++o)u[o].remove();for(u.length=0,o=0,c=l.length;o<c;++o){var f=s[o];l[o].$destroy(),u[o]=f,e.leave(f,function(){u.splice(o,1)})}s.length=0,l.length=0,(a=i.cases["!"+n]||i.cases["?"])&&(t.$eval(r.change),w(a,function(n){var r=t.$new();l.push(r),n.transclude(r,function(t){var r=n.element;s.push(t),e.enter(t,r.parent(),r)})}))})}}}],Gr=Jn({transclude:"element",priority:800,require:"^ngSwitch",link:function(e,t,n,r,i){r.cases["!"+n.ngSwitchWhen]=r.cases["!"+n.ngSwitchWhen]||[],r.cases["!"+n.ngSwitchWhen].push({transclude:i,element:t})}}),Qr=Jn({transclude:"element",priority:800,require:"^ngSwitch",link:function(e,t,n,r,i){r.cases["?"]=r.cases["?"]||[],r.cases["?"].push({transclude:i,element:t})}}),Xr=Jn({link:function(e,t,n,i,o){if(!o)throw r("ngTransclude")("orphan","Illegal use of ngTransclude directive in the template! No parent directive that requires a transclusion found. Element: {0}",ie(t));o(function(e){t.empty(),t.append(e)})}}),Yr=["$templateCache",function(e){return{restrict:"E",terminal:!0,compile:function(t,n){if("text/ng-template"==n.type){var r=n.id,i=t[0].text;e.put(r,i)}}}}],Jr=r("ngOptions"),Kr=P({terminal:!0}),Zr=["$compile","$parse",function(e,r){var i=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+group\s+by\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?$/,o={$setViewValue:_};return{restrict:"E",require:["select","?ngModel"],controller:["$element","$scope","$attrs",function(e,t,n){var r,i=this,a={},s=o;i.databound=n.ngModel,i.init=function(e,t,n){s=e,r=n},i.addOption=function(t){me(t,'"option value"'),a[t]=!0,s.$viewValue==t&&(e.val(t),r.parent()&&r.remove())},i.removeOption=function(e){this.hasOption(e)&&(delete a[e],s.$viewValue==e&&this.renderUnknownOption(e))},i.renderUnknownOption=function(t){var n="? "+Ze(t)+" ?";r.val(n),e.prepend(r),e.val(n),r.prop("selected",!0)},i.hasOption=function(e){return a.hasOwnProperty(e)},t.$on("$destroy",function(){i.renderUnknownOption=_})}],link:function(o,a,s,c){if(c[1]){for(var f,d,p,h,m,v,g,$,y,x=c[0],C=c[1],S=s.multiple,E=s.ngOptions,q=!1,k=l(t.createElement("option")),_=l(t.createElement("optgroup")),A=k.clone(),P=0,j=a.children(),D=j.length;P<D;P++)if(""===j[P].value){f=q=j.eq(P);break}x.init(C,q,A),S&&(C.$isEmpty=function(e){return!e||0===e.length}),E?function(t,o,a){var s;if(!(s=E.match(i)))throw Jr("iexp","Expected expression in form of '_select_ (as _label_)? for (_key_,)?_value_ in _collection_' but got '{0}'. Element: {1}",E,ie(o));var l=r(s[2]||s[1]),c=s[4]||s[6],f=s[5],d=r(s[3]||""),p=r(s[2]?s[1]:c),h=r(s[7]),m=s[8]?r(s[8]):null,v=[[{element:o,label:""}]];q&&(e(q)(t),q.removeClass("ng-scope"),q.remove());o.empty(),o.on("change",function(){t.$apply(function(){var e,r,i,s,u,l,d,$,y,w=h(t)||[],b={};if(S){for(i=[],l=0,$=v.length;l<$;l++)for(u=1,d=(e=v[l]).length;u<d;u++)if((s=e[u].element)[0].selected){if(r=s.val(),f&&(b[f]=r),m)for(y=0;y<w.length&&(b[c]=w[y],m(t,b)!=r);y++);else b[c]=w[r];i.push(p(t,b))}}else if("?"==(r=o.val()))i=n;else if(""===r)i=null;else if(m){for(y=0;y<w.length;y++)if(b[c]=w[y],m(t,b)==r){i=p(t,b);break}}else b[c]=w[r],f&&(b[f]=r),i=p(t,b);a.$setViewValue(i),g()})}),a.$render=g,t.$watchCollection(h,g),t.$watchCollection(function(){var e={},n=h(t);if(n){for(var r=new Array(n.length),i=0,o=n.length;i<o;i++)e[c]=n[i],r[i]=l(t,e);return r}},g),S&&t.$watchCollection(function(){return a.$modelValue},g);function g(){var e,n,r,i,s,g,$,y,w,C,E,A,P,M,j,D={"":[]},O=[""],R=a.$modelValue,F=h(t)||[],I=f?b(F):F,U={},L=function(){var e=!1;if(S){var n=a.$modelValue;if(m&&N(n)){e=new et([]);for(var r={},i=0;i<n.length;i++)r[c]=n[i],e.put(m(t,r),n[i])}else e=new et(n)}return e}();for(E=0;w=I.length,E<w;E++){if($=E,f){if("$"===($=I[E]).charAt(0))continue;U[f]=$}if(U[c]=F[$],e=d(t,U)||"",(n=D[e])||(n=D[e]=[],O.push(e)),S)A=T(L.remove(m?m(t,U):p(t,U)));else{if(m){var V={};V[c]=R,A=m(t,V)===m(t,U)}else A=R===p(t,U);L=L||A}j=T(j=l(t,U))?j:"",n.push({id:m?m(t,U):f?I[E]:E,label:j,selected:A})}for(S||(q||null===R?D[""].unshift({id:"",label:"",selected:!L}):L||D[""].unshift({id:"?",label:"",selected:!0})),C=0,y=O.length;C<y;C++){for(e=O[C],n=D[e],v.length<=C?(i={element:_.clone().attr("label",e),label:n.label},s=[i],v.push(s),o.append(i.element)):(s=v[C],(i=s[0]).label!=e&&i.element.attr("label",i.label=e)),P=null,E=0,w=n.length;E<w;E++)r=n[E],(g=s[E+1])?(P=g.element,g.label!==r.label&&(P.text(g.label=r.label),P.prop("label",g.label)),g.id!==r.id&&P.val(g.id=r.id),P[0].selected!==r.selected&&(P.prop("selected",g.selected=r.selected),u&&P.prop("selected",g.selected))):(""===r.id&&q?M=q:(M=k.clone()).val(r.id).prop("selected",r.selected).attr("selected",r.selected).prop("label",r.label).text(r.label),s.push(g={element:M,label:r.label,id:r.id,selected:r.selected}),x.addOption(r.label,M),P?P.after(M):i.element.append(M),P=M);for(E++;s.length>E;)r=s.pop(),x.removeOption(r.label),r.element.remove()}for(;v.length>C;)v.pop()[0].element.remove()}}(o,a,C):S?(v=o,g=a,($=C).$render=function(){var e=new et($.$viewValue);w(g.find("option"),function(t){t.selected=T(e.get(t.value))})},v.$watch(function(){X(y,$.$viewValue)||(y=Q($.$viewValue),$.$render())}),g.on("change",function(){v.$apply(function(){var e=[];w(g.find("option"),function(t){t.selected&&e.push(t.value)}),$.$setViewValue(e)})})):(d=o,p=a,m=x,(h=C).$render=function(){var e=h.$viewValue;m.hasOption(e)?(A.parent()&&A.remove(),p.val(e),""===e&&f.prop("selected",!0)):M(e)&&f?p.val(""):m.renderUnknownOption(e)},p.on("change",function(){d.$apply(function(){A.parent()&&A.remove(),h.$setViewValue(p.val())})}))}}}}],ei=["$interpolate",function(e){var t={addOption:_,removeOption:_};return{restrict:"E",priority:100,compile:function(n,r){if(M(r.value)){var i=e(n.text(),!0);i||r.$set("value",n.text())}return function(e,n,r){var o="$selectController",a=n.parent(),s=a.data(o)||a.parent().data(o);s&&s.databound?n.prop("selected",!1):s=t,i?e.$watch(i,function(e,t){r.$set("value",e),e!==t&&s.removeOption(t),s.addOption(e)}):s.addOption(r.value),n.on("$destroy",function(){s.removeOption(r.value)})}}}}],ti=P({restrict:"E",terminal:!0});e.angular.bootstrap?console.log("WARNING: Tried to load angular more than once."):((c=e.jQuery)&&c.fn.on?(l=c,E(c.fn,{scope:Xe.scope,isolateScope:Xe.isolateScope,controller:Xe.controller,injector:Xe.injector,inheritedData:Xe.inheritedData}),ke("remove",!0,!0,!1),ke("empty",!1,!1,!1),ke("html",!1,!1,!0)):l=Oe,g.element=l,function(t){E(t,{bootstrap:ce,copy:G,extend:E,equals:X,element:l,forEach:w,injector:st,noop:_,bind:Z,toJson:te,fromJson:ne,identity:A,isUndefined:M,isDefined:T,isString:D,isFunction:F,isObject:j,isNumber:O,isElement:z,isArray:N,version:$e,isDate:R,lowercase:o,uppercase:s,callbacks:{counter:0},$$minErr:r,$$csp:Y}),f=function(e){var t=r("$injector"),n=r("ng");function i(e,t,n){return e[t]||(e[t]=n())}var o=i(e,"angular",Object);return o.$$minErr=o.$$minErr||r,i(o,"module",function(){var e={};return function(r,o,a){return function(e,t){if("hasOwnProperty"===e)throw n("badname","hasOwnProperty is not a valid {0} name",t)}(r,"module"),o&&e.hasOwnProperty(r)&&(e[r]=null),i(e,r,function(){if(!o)throw t("nomod","Module '{0}' is not available! You either misspelled the module name or forgot to load it. If registering a module ensure that you specify the dependencies as the second argument.",r);var e=[],n=[],i=u("$injector","invoke"),s={_invokeQueue:e,_runBlocks:n,requires:o,name:r,provider:u("$provide","provider"),factory:u("$provide","factory"),service:u("$provide","service"),value:u("$provide","value"),constant:u("$provide","constant","unshift"),animation:u("$animateProvider","register"),filter:u("$filterProvider","register"),controller:u("$controllerProvider","register"),directive:u("$compileProvider","directive"),config:i,run:function(e){return n.push(e),this}};return a&&i(a),s;function u(t,n,r){return function(){return e[r||"push"]([t,n,arguments]),s}}})}})}(e);try{f("ngLocale")}catch(e){f("ngLocale",[]).provider("$locale",Dt)}f("ng",["ngLocale"],["$provide",function(e){e.provider({$$sanitizeUri:wn}),e.provider("$compile",gt).directive({a:Kn,input:pr,textarea:pr,form:rr,script:Yr,select:Zr,style:ti,option:ei,ngBind:Er,ngBindHtml:kr,ngBindTemplate:qr,ngClass:Ar,ngClassEven:Mr,ngClassOdd:Pr,ngCloak:Tr,ngController:jr,ngForm:ir,ngHide:zr,ngIf:Rr,ngInclude:Nr,ngInit:Ir,ngNonBindable:Ur,ngPluralize:Lr,ngRepeat:Vr,ngShow:Br,ngStyle:Hr,ngSwitch:Wr,ngSwitchWhen:Gr,ngSwitchDefault:Qr,ngOptions:Kr,ngTransclude:Xr,ngModel:yr,ngList:xr,ngChange:wr,required:br,ngRequired:br,ngValue:Sr}).directive({ngInclude:Fr}).directive(Zn).directive(Dr),e.provider({$anchorScroll:ut,$animate:ct,$browser:pt,$cacheFactory:ht,$controller:bt,$document:xt,$exceptionHandler:Ct,$filter:jn,$interpolate:Tt,$interval:jt,$http:_t,$httpBackend:Pt,$location:Xt,$log:Yt,$parse:vn,$rootScope:yn,$q:gn,$sce:En,$sceDelegate:Sn,$sniffer:qn,$templateCache:mt,$timeout:kn,$window:Tn,$$rAF:$n,$$asyncCallback:ft})}])}(g),l(t).ready(function(){!function(e,n){var r,i,o=[e],a=["ng:app","ng-app","x-ng-app","data-ng-app"],s=/\sng[:\-]app(:\s*([\w\d_]+);?)?\s/;function u(e){e&&o.push(e)}w(a,function(n){a[n]=!0,u(t.getElementById(n)),n=n.replace(":","\\:"),e.querySelectorAll&&(w(e.querySelectorAll("."+n),u),w(e.querySelectorAll("."+n+"\\:"),u),w(e.querySelectorAll("["+n+"]"),u))}),w(o,function(e){if(!r){var t=" "+e.className+" ",n=s.exec(t);n?(r=e,i=(n[2]||"").replace(/\s+/g,",")):w(e.attributes,function(t){!r&&a[t.name]&&(r=e,i=t.value)})}}),r&&n(r,i?[i]:[])}(t,ce)}))}(window,document),!window.angular.$$csp()&&window.angular.element(document).find("head").prepend('<style type="text/css">@charset "UTF-8";[ng\\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide{display:none !important;}ng\\:form{display:block;}.ng-animate-block-transitions{transition:0s all!important;-webkit-transition:0s all!important;}.ng-hide-add-active,.ng-hide-remove{display:block!important;}</style>');var commonjsGlobal="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function createCommonjsModule(e,t){return e(t={exports:{}},t.exports),t.exports}var lodash=createCommonjsModule(function(e,t){(function(){var n,r,i,o="3.10.1",a=1,s=2,u=4,l=8,c=16,f=32,d=64,p=128,h=256,m=30,v="...",g=150,$=16,y=200,w=1,b=2,x="Expected a function",C="__lodash_placeholder__",S="[object Arguments]",E="[object Array]",q="[object Boolean]",k="[object Date]",_="[object Error]",A="[object Function]",P="[object Map]",M="[object Number]",T="[object Object]",j="[object RegExp]",D="[object Set]",O="[object String]",R="[object WeakMap]",N="[object ArrayBuffer]",F="[object Float32Array]",I="[object Float64Array]",U="[object Int8Array]",L="[object Int16Array]",V="[object Int32Array]",B="[object Uint8Array]",z="[object Uint8ClampedArray]",H="[object Uint16Array]",W="[object Uint32Array]",G=/\b__p \+= '';/g,Q=/\b(__p \+=) '' \+/g,X=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Y=/&(?:amp|lt|gt|quot|#39|#96);/g,J=/[&<>"'`]/g,K=RegExp(Y.source),Z=RegExp(J.source),ee=/<%-([\s\S]+?)%>/g,te=/<%([\s\S]+?)%>/g,ne=/<%=([\s\S]+?)%>/g,re=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\n\\]|\\.)*?\1)\]/,ie=/^\w*$/,oe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\n\\]|\\.)*?)\2)\]/g,ae=/^[:!,]|[\\^$.*+?()[\]{}|\/]|(^[0-9a-fA-Fnrtuvx])|([\n\r\u2028\u2029])/g,se=RegExp(ae.source),ue=/[\u0300-\u036f\ufe20-\ufe23]/g,le=/\\(\\)?/g,ce=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,fe=/\w*$/,de=/^0[xX]/,pe=/^\[object .+?Constructor\]$/,he=/^\d+$/,me=/[\xc0-\xd6\xd8-\xde\xdf-\xf6\xf8-\xff]/g,ve=/($^)/,ge=/['\n\r\u2028\u2029\\]/g,$e=(r="[A-Z\\xc0-\\xd6\\xd8-\\xde]",i="[a-z\\xdf-\\xf6\\xf8-\\xff]+",RegExp(r+"+(?="+r+i+")|"+r+"?"+i+"|"+r+"+|[0-9]+","g")),ye=["Array","ArrayBuffer","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Math","Number","Object","RegExp","Set","String","_","clearTimeout","isFinite","parseFloat","parseInt","setTimeout","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap"],we=-1,be={};be[F]=be[I]=be[U]=be[L]=be[V]=be[B]=be[z]=be[H]=be[W]=!0,be[S]=be[E]=be[N]=be[q]=be[k]=be[_]=be[A]=be[P]=be[M]=be[T]=be[j]=be[D]=be[O]=be[R]=!1;var xe={};xe[S]=xe[E]=xe[N]=xe[q]=xe[k]=xe[F]=xe[I]=xe[U]=xe[L]=xe[V]=xe[M]=xe[T]=xe[j]=xe[O]=xe[B]=xe[z]=xe[H]=xe[W]=!0,xe[_]=xe[A]=xe[P]=xe[D]=xe[R]=!1;var Ce={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss"},Se={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},Ee={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#96;":"`"},qe={function:!0,object:!0},ke={0:"x30",1:"x31",2:"x32",3:"x33",4:"x34",5:"x35",6:"x36",7:"x37",8:"x38",9:"x39",A:"x41",B:"x42",C:"x43",D:"x44",E:"x45",F:"x46",a:"x61",b:"x62",c:"x63",d:"x64",e:"x65",f:"x66",n:"x6e",r:"x72",t:"x74",u:"x75",v:"x76",x:"x78"},_e={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ae=qe.object&&t&&!t.nodeType&&t,Pe=qe.object&&e&&!e.nodeType&&e,Me=Ae&&Pe&&"object"==typeof commonjsGlobal&&commonjsGlobal&&commonjsGlobal.Object&&commonjsGlobal,Te=qe[typeof self]&&self&&self.Object&&self,je=qe[typeof window]&&window&&window.Object&&window,De=Pe&&Pe.exports===Ae&&Ae,Oe=Me||je!==(this&&this.window)&&je||Te||this;function Re(e,t){if(e!==t){var r=null===e,i=e===n,o=e==e,a=null===t,s=t===n,u=t==t;if(e>t&&!a||!o||r&&!s&&u||i&&u)return 1;if(e<t&&!r||!u||a&&!i&&o||s&&o)return-1}return 0}function Ne(e,t,n){for(var r=e.length,i=n?r:-1;n?i--:++i<r;)if(t(e[i],i,e))return i;return-1}function Fe(e,t,n){if(t!=t)return Qe(e,n);for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1}function Ie(e){return"function"==typeof e||!1}function Ue(e){return null==e?"":e+""}function Le(e,t){for(var n=-1,r=e.length;++n<r&&t.indexOf(e.charAt(n))>-1;);return n}function Ve(e,t){for(var n=e.length;n--&&t.indexOf(e.charAt(n))>-1;);return n}function Be(e,t){return Re(e.criteria,t.criteria)||e.index-t.index}function ze(e){return Ce[e]}function He(e){return Se[e]}function We(e,t,n){return t?e=ke[e]:n&&(e=_e[e]),"\\"+e}function Ge(e){return"\\"+_e[e]}function Qe(e,t,n){for(var r=e.length,i=t+(n?0:-1);n?i--:++i<r;){var o=e[i];if(o!=o)return i}return-1}function Xe(e){return!!e&&"object"==typeof e}function Ye(e){return e<=160&&e>=9&&e<=13||32==e||160==e||5760==e||6158==e||e>=8192&&(e<=8202||8232==e||8233==e||8239==e||8287==e||12288==e||65279==e)}function Je(e,t){for(var n=-1,r=e.length,i=-1,o=[];++n<r;)e[n]===t&&(e[n]=C,o[++i]=n);return o}function Ke(e){for(var t=-1,n=e.length;++t<n&&Ye(e.charCodeAt(t)););return t}function Ze(e){for(var t=e.length;t--&&Ye(e.charCodeAt(t)););return t}function et(e){return Ee[e]}var tt=function e(t){var r=(t=t?tt.defaults(Oe.Object(),t,tt.pick(Oe,ye)):Oe).Array,i=t.Date,P=t.Error,D=t.Function,R=t.Math,Ce=t.Number,Se=t.Object,Ee=t.RegExp,qe=t.String,ke=t.TypeError,_e=r.prototype,Ae=Se.prototype,Pe=qe.prototype,Me=D.prototype.toString,Te=Ae.hasOwnProperty,je=0,De=Ae.toString,Ye=Oe._,nt=Ee("^"+Me.call(Te).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),rt=t.ArrayBuffer,it=t.clearTimeout,ot=t.parseFloat,at=R.pow,st=Ae.propertyIsEnumerable,ut=$r(t,"Set"),lt=t.setTimeout,ct=_e.splice,ft=t.Uint8Array,dt=$r(t,"WeakMap"),pt=R.ceil,ht=$r(Se,"create"),mt=R.floor,vt=$r(r,"isArray"),gt=t.isFinite,$t=$r(Se,"keys"),yt=R.max,wt=R.min,bt=$r(i,"now"),xt=t.parseInt,Ct=R.random,St=Ce.NEGATIVE_INFINITY,Et=Ce.POSITIVE_INFINITY,qt=4294967295,kt=qt-1,_t=qt>>>1,At=9007199254740991,Pt=dt&&new dt,Mt={};function Tt(e){if(Xe(e)&&!Wi(e)&&!(e instanceof Ot)){if(e instanceof Dt)return e;if(Te.call(e,"__chain__")&&Te.call(e,"__wrapped__"))return Rr(e)}return new Dt(e)}function jt(){}function Dt(e,t,n){this.__wrapped__=e,this.__actions__=n||[],this.__chain__=!!t}Tt.support={};function Ot(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Et,this.__views__=[]}function Rt(){this.__data__={}}function Nt(e){var t=e?e.length:0;for(this.data={hash:ht(null),set:new ut};t--;)this.push(e[t])}function Ft(e,t){var n=e.data;return("string"==typeof t||Yi(t)?n.set.has(t):n.hash[t])?0:-1}function It(e,t){var n=-1,i=e.length;for(t||(t=r(i));++n<i;)t[n]=e[n];return t}function Ut(e,t){for(var n=-1,r=e.length;++n<r&&!1!==t(e[n],n,e););return e}function Lt(e,t){for(var n=-1,r=e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}function Vt(e,t){for(var n=-1,r=e.length,i=-1,o=[];++n<r;){var a=e[n];t(a,n,e)&&(o[++i]=a)}return o}function Bt(e,t){for(var n=-1,i=e.length,o=r(i);++n<i;)o[n]=t(e[n],n,e);return o}function zt(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}function Ht(e,t,n,r){var i=-1,o=e.length;for(r&&o&&(n=e[++i]);++i<o;)n=t(n,e[i],i,e);return n}function Wt(e,t){for(var n=-1,r=e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}function Gt(e,t,r,i){return e!==n&&Te.call(i,r)?e:t}function Qt(e,t,r){for(var i=-1,o=$o(t),a=o.length;++i<a;){var s=o[i],u=e[s],l=r(u,t[s],s,e,t);(l==l?l===u:u!=u)&&(u!==n||s in e)||(e[s]=l)}return e}function Xt(e,t){return null==t?e:Jt(t,$o(t),e)}function Yt(e,t){for(var i=-1,o=null==e,a=!o&&wr(e),s=a?e.length:0,u=t.length,l=r(u);++i<u;){var c=t[i];l[i]=a?br(c,s)?e[c]:n:o?n:e[c]}return l}function Jt(e,t,n){n||(n={});for(var r=-1,i=t.length;++r<i;){var o=t[r];n[o]=e[o]}return n}function Kt(e,t,r){var i=typeof e;return"function"==i?t===n?e:Rn(e,t,r):null==e?Fo:"object"==i?wn(e):t===n?zo(e):bn(e,t)}function Zt(e,t,r,i,o,a,s){var u;if(r&&(u=o?r(e,i,o):r(e)),u!==n)return u;if(!Yi(e))return e;var l,c,f,d,p=Wi(e);if(p){if(f=(c=e).length,d=new c.constructor(f),f&&"string"==typeof c[0]&&Te.call(c,"index")&&(d.index=c.index,d.input=c.input),u=d,!t)return It(e,u)}else{var h=De.call(e),m=h==A;if(h!=T&&h!=S&&(!m||o))return xe[h]?function(e,t,n){var r=e.constructor;switch(t){case N:return Nn(e);case q:case k:return new r(+e);case F:case I:case U:case L:case V:case B:case z:case H:case W:var i=e.buffer;return new r(n?Nn(i):i,e.byteOffset,e.length);case M:case O:return new r(e);case j:var o=new r(e.source,fe.exec(e));o.lastIndex=e.lastIndex}return o}(e,h,t):o?e:{};if("function"==typeof(l=(m?{}:e).constructor)&&l instanceof l||(l=Se),u=new l,!t)return Xt(u,e)}a||(a=[]),s||(s=[]);for(var v=a.length;v--;)if(a[v]==e)return s[v];return a.push(e),s.push(u),(p?Ut:pn)(e,function(n,i){u[i]=Zt(n,t,r,i,e,a,s)}),u}Tt.templateSettings={escape:ee,evaluate:te,interpolate:ne,variable:"",imports:{_:Tt}};var en=function(){function e(){}return function(t){if(Yi(t)){e.prototype=t;var r=new e;e.prototype=n}return r||{}}}();function tn(e,t,r){if("function"!=typeof e)throw new ke(x);return lt(function(){e.apply(n,r)},t)}function nn(e,t){var n=e?e.length:0,r=[];if(!n)return r;var i=-1,o=mr(),a=o==Fe,s=a&&t.length>=y?zn(t):null,u=t.length;s&&(o=Ft,a=!1,t=s);e:for(;++i<n;){var l=e[i];if(a&&l==l){for(var c=u;c--;)if(t[c]===l)continue e;r.push(l)}else o(t,l,0)<0&&r.push(l)}return r}var rn=Vn(pn),on=Vn(hn,!0);function an(e,t){var n=!0;return rn(e,function(e,r,i){return n=!!t(e,r,i)}),n}function sn(e,t){var n=[];return rn(e,function(e,r,i){t(e,r,i)&&n.push(e)}),n}function un(e,t,n,r){var i;return n(e,function(e,n,o){if(t(e,n,o))return i=r?n:e,!1}),i}function ln(e,t,n,r){r||(r=[]);for(var i=-1,o=e.length;++i<o;){var a=e[i];Xe(a)&&wr(a)&&(n||Wi(a)||Hi(a))?t?ln(a,t,n,r):zt(r,a):n||(r[r.length]=a)}return r}var cn=Bn(),fn=Bn(!0);function dn(e,t){return cn(e,t,yo)}function pn(e,t){return cn(e,t,$o)}function hn(e,t){return fn(e,t,$o)}function mn(e,t){for(var n=-1,r=t.length,i=-1,o=[];++n<r;){var a=t[n];Xi(e[a])&&(o[++i]=a)}return o}function vn(e,t,r){if(null!=e){r!==n&&r in Dr(e)&&(t=[r]);for(var i=0,o=t.length;null!=e&&i<o;)e=e[t[i++]];return i&&i==o?e:n}}function gn(e,t,r,i,o,a){return e===t||(null==e||null==t||!Yi(e)&&!Xe(t)?e!=e&&t!=t:function(e,t,r,i,o,a,s){var u=Wi(e),l=Wi(t),c=E,f=E;u||((c=De.call(e))==S?c=T:c!=T&&(u=no(e))),l||((f=De.call(t))==S?f=T:f!=T&&(l=no(t)));var d=c==T,p=f==T,h=c==f;if(h&&!u&&!d)return function(e,t,n){switch(n){case q:case k:return+e==+t;case _:return e.name==t.name&&e.message==t.message;case M:return e!=+e?t!=+t:e==+t;case j:case O:return e==t+""}return!1}(e,t,c);if(!o){var m=d&&Te.call(e,"__wrapped__"),v=p&&Te.call(t,"__wrapped__");if(m||v)return r(m?e.value():e,v?t.value():t,i,o,a,s)}if(!h)return!1;a||(a=[]),s||(s=[]);for(var g=a.length;g--;)if(a[g]==e)return s[g]==t;a.push(e),s.push(t);var $=(u?function(e,t,r,i,o,a,s){var u=-1,l=e.length,c=t.length;if(l!=c&&!(o&&c>l))return!1;for(;++u<l;){var f=e[u],d=t[u],p=i?i(o?d:f,o?f:d,u):n;if(p!==n){if(p)continue;return!1}if(o){if(!Wt(t,function(e){return f===e||r(f,e,i,o,a,s)}))return!1}else if(f!==d&&!r(f,d,i,o,a,s))return!1}return!0}:function(e,t,r,i,o,a,s){var u=$o(e),l=u.length,c=$o(t).length;if(l!=c&&!o)return!1;for(var f=l;f--;){var d=u[f];if(!(o?d in t:Te.call(t,d)))return!1}for(var p=o;++f<l;){d=u[f];var h=e[d],m=t[d],v=i?i(o?m:h,o?h:m,d):n;if(!(v===n?r(h,m,i,o,a,s):v))return!1;p||(p="constructor"==d)}if(!p){var g=e.constructor,$=t.constructor;if(g!=$&&"constructor"in e&&"constructor"in t&&!("function"==typeof g&&g instanceof g&&"function"==typeof $&&$ instanceof $))return!1}return!0})(e,t,r,i,o,a,s);return a.pop(),s.pop(),$}(e,t,gn,r,i,o,a))}function $n(e,t,r){var i=t.length,o=i,a=!r;if(null==e)return!o;for(e=Dr(e);i--;){var s=t[i];if(a&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++i<o;){var u=(s=t[i])[0],l=e[u],c=s[1];if(a&&s[2]){if(l===n&&!(u in e))return!1}else{var f=r?r(l,c,u):n;if(!(f===n?gn(c,l,r,!0):f))return!1}}return!0}function yn(e,t){var n=-1,i=wr(e)?r(e.length):[];return rn(e,function(e,r,o){i[++n]=t(e,r,o)}),i}function wn(e){var t=gr(e);if(1==t.length&&t[0][2]){var r=t[0][0],i=t[0][1];return function(e){return null!=e&&e[r]===i&&(i!==n||r in Dr(e))}}return function(e){return $n(e,t)}}function bn(e,t){var r=Wi(e),i=Cr(e)&&qr(t),o=e+"";return e=Or(e),function(a){if(null==a)return!1;var s=o;if(a=Dr(a),(r||!i)&&!(s in a)){if(null==(a=1==e.length?a:vn(a,qn(e,0,-1))))return!1;s=Hr(e),a=Dr(a)}return a[s]===t?t!==n||s in a:gn(t,a[s],n,!0)}}function xn(e){return function(t){return null==t?n:t[e]}}function Cn(e,t){for(var n=e?t.length:0;n--;){var r=t[n];if(r!=i&&br(r)){var i=r;ct.call(e,r,1)}}return e}function Sn(e,t){return e+mt(Ct()*(t-e+1))}var En=Pt?function(e,t){return Pt.set(e,t),e}:Fo;function qn(e,t,i){var o=-1,a=e.length;(t=null==t?0:+t||0)<0&&(t=-t>a?0:a+t),(i=i===n||i>a?a:+i||0)<0&&(i+=a),a=t>i?0:i-t>>>0,t>>>=0;for(var s=r(a);++o<a;)s[o]=e[o+t];return s}function kn(e,t){var n;return rn(e,function(e,r,i){return!(n=t(e,r,i))}),!!n}function _n(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}function An(e,t,n){var r=dr(),i=-1;return t=Bt(t,function(e){return r(e)}),_n(yn(e,function(e){return{criteria:Bt(t,function(t){return t(e)}),index:++i,value:e}}),function(e,t){return function(e,t,n){for(var r=-1,i=e.criteria,o=t.criteria,a=i.length,s=n.length;++r<a;){var u=Re(i[r],o[r]);if(u){if(r>=s)return u;var l=n[r];return u*("asc"===l||!0===l?1:-1)}}return e.index-t.index}(e,t,n)})}function Pn(e,t){var n=-1,r=mr(),i=e.length,o=r==Fe,a=o&&i>=y,s=a?zn():null,u=[];s?(r=Ft,o=!1):(a=!1,s=t?[]:u);e:for(;++n<i;){var l=e[n],c=t?t(l,n,e):l;if(o&&l==l){for(var f=s.length;f--;)if(s[f]===c)continue e;t&&s.push(c),u.push(l)}else r(s,c,0)<0&&((t||a)&&s.push(c),u.push(l))}return u}function Mn(e,t){for(var n=-1,i=t.length,o=r(i);++n<i;)o[n]=e[t[n]];return o}function Tn(e,t,n,r){for(var i=e.length,o=r?i:-1;(r?o--:++o<i)&&t(e[o],o,e););return n?qn(e,r?0:o,r?o+1:i):qn(e,r?o+1:0,r?i:o)}function jn(e,t){var n=e;n instanceof Ot&&(n=n.value());for(var r=-1,i=t.length;++r<i;){var o=t[r];n=o.func.apply(o.thisArg,zt([n],o.args))}return n}function Dn(e,t,n){var r=0,i=e?e.length:r;if("number"==typeof t&&t==t&&i<=_t){for(;r<i;){var o=r+i>>>1,a=e[o];(n?a<=t:a<t)&&null!==a?r=o+1:i=o}return i}return On(e,t,Fo,n)}function On(e,t,r,i){t=r(t);for(var o=0,a=e?e.length:0,s=t!=t,u=null===t,l=t===n;o<a;){var c=mt((o+a)/2),f=r(e[c]),d=f!==n,p=f==f;if(s)var h=p||i;else h=u?p&&d&&(i||null!=f):l?p&&(i||d):null!=f&&(i?f<=t:f<t);h?o=c+1:a=c}return wt(a,kt)}function Rn(e,t,r){if("function"!=typeof e)return Fo;if(t===n)return e;switch(r){case 1:return function(n){return e.call(t,n)};case 3:return function(n,r,i){return e.call(t,n,r,i)};case 4:return function(n,r,i,o){return e.call(t,n,r,i,o)};case 5:return function(n,r,i,o,a){return e.call(t,n,r,i,o,a)}}return function(){return e.apply(t,arguments)}}function Nn(e){var t=new rt(e.byteLength);return new ft(t).set(new ft(e)),t}function Fn(e,t,n){for(var i=n.length,o=-1,a=yt(e.length-i,0),s=-1,u=t.length,l=r(u+a);++s<u;)l[s]=t[s];for(;++o<i;)l[n[o]]=e[o];for(;a--;)l[s++]=e[o++];return l}function In(e,t,n){for(var i=-1,o=n.length,a=-1,s=yt(e.length-o,0),u=-1,l=t.length,c=r(s+l);++a<s;)c[a]=e[a];for(var f=a;++u<l;)c[f+u]=t[u];for(;++i<o;)c[f+n[i]]=e[a++];return c}function Un(e,t){return function(n,r,i){var o=t?t():{};if(r=dr(r,i,3),Wi(n))for(var a=-1,s=n.length;++a<s;){var u=n[a];e(o,u,r(u,a,n),n)}else rn(n,function(t,n,i){e(o,t,r(t,n,i),i)});return o}}function Ln(e){return Bi(function(t,r){var i=-1,o=null==t?0:r.length,a=o>2?r[o-2]:n,s=o>2?r[2]:n,u=o>1?r[o-1]:n;for("function"==typeof a?(a=Rn(a,u,5),o-=2):o-=(a="function"==typeof u?u:n)?1:0,s&&xr(r[0],r[1],s)&&(a=o<3?n:a,o=1);++i<o;){var l=r[i];l&&e(t,l,a)}return t})}function Vn(e,t){return function(n,r){var i=n?vr(n):0;if(!Er(i))return e(n,r);for(var o=t?i:-1,a=Dr(n);(t?o--:++o<i)&&!1!==r(a[o],o,a););return n}}function Bn(e){return function(t,n,r){for(var i=Dr(t),o=r(t),a=o.length,s=e?a:-1;e?s--:++s<a;){var u=o[s];if(!1===n(i[u],u,i))break}return t}}function zn(e){return ht&&ut?new Nt(e):null}function Hn(e){return function(t){for(var n=-1,r=Oo(ko(t)),i=r.length,o="";++n<i;)o=e(o,r[n],n);return o}}function Wn(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=en(e.prototype),r=e.apply(n,t);return Yi(r)?r:n}}function Gn(e){return function t(r,i,o){o&&xr(r,i,o)&&(i=n);var a=fr(r,e,n,n,n,n,n,i);return a.placeholder=t.placeholder,a}}function Qn(e,t){return Bi(function(r){var i=r[0];return null==i?i:(r.push(t),e.apply(n,r))})}function Xn(e,t){return function(r,i,o){if(o&&xr(r,i,o)&&(i=n),1==(i=dr(i,o,3)).length){var a=function(e,t,n,r){for(var i=-1,o=e.length,a=r,s=a;++i<o;){var u=e[i],l=+t(u);n(l,a)&&(a=l,s=u)}return s}(r=Wi(r)?r:jr(r),i,e,t);if(!r.length||a!==t)return a}return s=i,u=e,f=c=l=t,rn(r,function(e,t,n){var r=+s(e,t,n);(u(r,c)||r===l&&r===f)&&(c=r,f=e)}),f;var s,u,l,c,f}}function Yn(e,t){return function(r,i,o){if(i=dr(i,o,3),Wi(r)){var a=Ne(r,i,t);return a>-1?r[a]:n}return un(r,i,e)}}function Jn(e){return function(t,n,r){return t&&t.length?Ne(t,n=dr(n,r,3),e):-1}}function Kn(e){return function(t,n,r){return un(t,n=dr(n,r,3),e,!0)}}function Zn(e){return function(){for(var t,i=arguments.length,o=e?i:-1,a=0,s=r(i);e?o--:++o<i;){var u=s[a++]=arguments[o];if("function"!=typeof u)throw new ke(x);!t&&Dt.prototype.thru&&"wrapper"==hr(u)&&(t=new Dt([],!0))}for(o=t?-1:i;++o<i;){var c=hr(u=s[o]),d="wrapper"==c?pr(u):n;t=d&&Sr(d[0])&&d[1]==(p|l|f|h)&&!d[4].length&&1==d[9]?t[hr(d[0])].apply(t,d[3]):1==u.length&&Sr(u)?t[c]():t.thru(u)}return function(){var e=arguments,n=e[0];if(t&&1==e.length&&Wi(n)&&n.length>=y)return t.plant(n).value();for(var r=0,o=i?s[r].apply(this,e):n;++r<i;)o=s[r].call(this,o);return o}}}function er(e,t){return function(r,i,o){return"function"==typeof i&&o===n&&Wi(r)?e(r,i):t(r,Rn(i,o,3))}}function tr(e){return function(t,r,i){return"function"==typeof r&&i===n||(r=Rn(r,i,3)),e(t,r,yo)}}function nr(e){return function(t,r,i){return"function"==typeof r&&i===n||(r=Rn(r,i,3)),e(t,r)}}function rr(e){return function(t,n,r){var i={};return n=dr(n,r,3),pn(t,function(t,r,o){var a=n(t,r,o);t=e?t:a,i[r=e?a:r]=t}),i}}function ir(e){return function(t,n,r){return t=Ue(t),(e?t:"")+ur(t,n,r)+(e?"":t)}}function or(e){var t=Bi(function(r,i){var o=Je(i,t.placeholder);return fr(r,e,n,i,o)});return t}function ar(e,t){return function(r,i,o,a){var s,u,l,c,f=arguments.length<3;return"function"==typeof i&&a===n&&Wi(r)?e(r,i,o,f):(s=r,u=dr(i,a,4),l=o,c=f,t(s,function(e,t,n){l=c?(c=!1,e):u(l,e,t,n)}),l)}}function sr(e,t,i,o,h,m,v,g,$,y){var w=t&p,b=t&a,x=t&s,C=t&l,S=t&u,E=t&c,q=x?n:Wn(e);return function u(){for(var l=arguments.length,c=l,p=r(l);c--;)p[c]=arguments[c];if(o&&(p=Fn(p,o,h)),m&&(p=In(p,m,v)),C||E){var k=u.placeholder,_=Je(p,k);if((l-=_.length)<y){var A=g?It(g):n,P=yt(y-l,0);t|=C?f:d,t&=~(C?d:f),S||(t&=~(a|s));var M=[e,t,i,C?p:n,C?_:n,C?n:p,C?n:_,A,$,P],T=sr.apply(n,M);return Sr(e)&&Mr(T,M),T.placeholder=k,T}}var j=b?i:this,D=x?j[e]:e;return g&&(p=function(e,t){for(var r=e.length,i=wt(t.length,r),o=It(e);i--;){var a=t[i];e[i]=br(a,r)?o[a]:n}return e}(p,g)),w&&$<p.length&&(p.length=$),this&&this!==Oe&&this instanceof u&&(D=q||Wn(e)),D.apply(j,p)}}function ur(e,t,n){var r=e.length;if(r>=(t=+t)||!gt(t))return"";var i=t-r;return Mo(n=null==n?" ":n+"",pt(i/n.length)).slice(0,i)}function lr(e){var t=R[e];return function(e,r){return(r=r===n?0:+r||0)?(r=at(10,r),t(e*r)/r):t(e)}}function cr(e){return function(t,n,r,i){var o=dr(r);return null==r&&o===Kt?Dn(t,n,e):On(t,n,o(r,i,1),e)}}function fr(e,t,i,o,c,m,v,g){var $=t&s;if(!$&&"function"!=typeof e)throw new ke(x);var y=o?o.length:0;if(y||(t&=~(f|d),o=c=n),y-=c?c.length:0,t&d){var w=o,b=c;o=c=n}var S,E,q,k=$?n:pr(e),_=[e,t,i,o,c,w,b,m,v,g];if(k&&(function(e,t){var n=e[1],r=t[1],i=n|r,o=i<p,s=r==p&&n==l||r==p&&n==h&&e[7].length<=t[8]||r==(p|h)&&n==l;if(!o&&!s)return e;r&a&&(e[2]=t[2],i|=n&a?0:u);var c=t[3];if(c){var f=e[3];e[3]=f?Fn(f,c,t[4]):It(c),e[4]=f?Je(e[3],C):It(t[4])}(c=t[5])&&(f=e[5],e[5]=f?In(f,c,t[6]):It(c),e[6]=f?Je(e[5],C):It(t[6])),(c=t[7])&&(e[7]=It(c)),r&p&&(e[8]=null==e[8]?t[8]:wt(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=i}(_,k),t=_[1],g=_[9]),_[9]=null==g?$?0:e.length:yt(g-y,0)||0,t==a)var A=(S=_[0],E=_[2],q=Wn(S),function e(){return(this&&this!==Oe&&this instanceof e?q:S).apply(E,arguments)});else A=t!=f&&t!=(a|f)||_[4].length?sr.apply(n,_):function(e,t,n,i){var o=t&a,s=Wn(e);return function t(){for(var a=-1,u=arguments.length,l=-1,c=i.length,f=r(c+u);++l<c;)f[l]=i[l];for(;u--;)f[l++]=arguments[++a];return(this&&this!==Oe&&this instanceof t?s:e).apply(o?n:this,f)}}.apply(n,_);return(k?En:Mr)(A,_)}function dr(e,t,n){var r=Tt.callback||No;return r=r===No?Kt:r,n?r(e,t,n):r}var pr=Pt?function(e){return Pt.get(e)}:Bo;function hr(e){for(var t=e.name,n=Mt[t],r=n?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==e)return i.name}return t}function mr(e,t,n){var r=Tt.indexOf||Br;return r=r===Br?Fe:r,e?r(e,t,n):r}var vr=xn("length");function gr(e){for(var t=Co(e),n=t.length;n--;)t[n][2]=qr(t[n][1]);return t}function $r(e,t){var r=null==e?n:e[t];return Ji(r)?r:n}function yr(e,t,r){null==e||Cr(t,e)||(e=1==(t=Or(t)).length?e:vn(e,qn(t,0,-1)),t=Hr(t));var i=null==e?e:e[t];return null==i?n:i.apply(e,r)}function wr(e){return null!=e&&Er(vr(e))}function br(e,t){return e="number"==typeof e||he.test(e)?+e:-1,t=null==t?At:t,e>-1&&e%1==0&&e<t}function xr(e,t,n){if(!Yi(n))return!1;var r=typeof t;if("number"==r?wr(n)&&br(t,n.length):"string"==r&&t in n){var i=n[t];return e==e?e===i:i!=i}return!1}function Cr(e,t){var n=typeof e;return!!("string"==n&&ie.test(e)||"number"==n)||!Wi(e)&&(!re.test(e)||null!=t&&e in Dr(t))}function Sr(e){var t=hr(e);if(!(t in Ot.prototype))return!1;var n=Tt[t];if(e===n)return!0;var r=pr(n);return!!r&&e===r[0]}function Er(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=At}function qr(e){return e==e&&!Yi(e)}function kr(e,t){e=Dr(e);for(var n=-1,r=t.length,i={};++n<r;){var o=t[n];o in e&&(i[o]=e[o])}return i}function _r(e,t){var n={};return dn(e,function(e,r,i){t(e,r,i)&&(n[r]=e)}),n}var Ar,Pr,Mr=(Ar=0,Pr=0,function(e,t){var n=qi(),r=$-(n-Pr);if(Pr=n,r>0){if(++Ar>=g)return e}else Ar=0;return En(e,t)});function Tr(e){for(var t=yo(e),n=t.length,r=n&&e.length,i=!!r&&Er(r)&&(Wi(e)||Hi(e)),o=-1,a=[];++o<n;){var s=t[o];(i&&br(s,r)||Te.call(e,s))&&a.push(s)}return a}function jr(e){return null==e?[]:wr(e)?Yi(e)?e:Se(e):Eo(e)}function Dr(e){return Yi(e)?e:Se(e)}function Or(e){if(Wi(e))return e;var t=[];return Ue(e).replace(oe,function(e,n,r,i){t.push(r?i.replace(le,"$1"):n||e)}),t}function Rr(e){return e instanceof Ot?e.clone():new Dt(e.__wrapped__,e.__chain__,It(e.__actions__))}var Nr=Bi(function(e,t){return Xe(e)&&wr(e)?nn(e,ln(t,!1,!0)):[]});function Fr(e,t,n){return e&&e.length?((n?xr(e,t,n):null==t)&&(t=1),qn(e,t<0?0:t)):[]}function Ir(e,t,n){var r=e?e.length:0;return r?((n?xr(e,t,n):null==t)&&(t=1),qn(e,0,(t=r-(+t||0))<0?0:t)):[]}var Ur=Jn(),Lr=Jn(!0);function Vr(e){return e?e[0]:n}function Br(e,t,n){var r=e?e.length:0;if(!r)return-1;if("number"==typeof n)n=n<0?yt(r+n,0):n;else if(n){var i=Dn(e,t);return i<r&&(t==t?t===e[i]:e[i]!=e[i])?i:-1}return Fe(e,t,n||0)}var zr=Bi(function(e){for(var t=e.length,n=t,i=r(f),o=mr(),a=o==Fe,s=[];n--;){var u=e[n]=wr(u=e[n])?u:[];i[n]=a&&u.length>=120?zn(n&&u):null}var l=e[0],c=-1,f=l?l.length:0,d=i[0];e:for(;++c<f;)if(u=l[c],(d?Ft(d,u):o(s,u,0))<0){for(n=t;--n;){var p=i[n];if((p?Ft(p,u):o(e[n],u,0))<0)continue e}d&&d.push(u),s.push(u)}return s});function Hr(e){var t=e?e.length:0;return t?e[t-1]:n}var Wr=Bi(function(e,t){var n=Yt(e,t=ln(t));return Cn(e,t.sort(Re)),n});function Gr(e){return Fr(e,1)}var Qr=cr(),Xr=cr(!0);var Yr=Bi(function(e){return Pn(ln(e,!1,!0))});function Jr(e,t,r,i){if(!e||!e.length)return[];null!=t&&"boolean"!=typeof t&&(r=xr(e,t,i=r)?n:t,t=!1);var o=dr();return null==r&&o===Kt||(r=o(r,i,3)),t&&mr()==Fe?function(e,t){for(var n,r=-1,i=e.length,o=-1,a=[];++r<i;){var s=e[r],u=t?t(s,r,e):s;r&&n===u||(n=u,a[++o]=s)}return a}(e,r):Pn(e,r)}function Kr(e){if(!e||!e.length)return[];var t=-1,n=0;e=Vt(e,function(e){if(wr(e))return n=yt(e.length,n),!0});for(var i=r(n);++t<n;)i[t]=Bt(e,xn(t));return i}function Zr(e,t,r){if(!e||!e.length)return[];var i=Kr(e);return null==t?i:(t=Rn(t,r,4),Bt(i,function(e){return Ht(e,t,n,!0)}))}var ei=Bi(function(e,t){return wr(e)?nn(e,t):[]});var ti=Bi(Kr);function ni(e,t){var n=-1,r=e?e.length:0,i={};for(!r||t||Wi(e[0])||(t=[]);++n<r;){var o=e[n];t?i[o]=t[n]:o&&(i[o[0]]=o[1])}return i}var ri=Bi(function(e){var t=e.length,r=t>2?e[t-2]:n,i=t>1?e[t-1]:n;return t>2&&"function"==typeof r?t-=2:(r=t>1&&"function"==typeof i?(--t,i):n,i=n),e.length=t,Zr(e,r,i)});function ii(e){var t=Tt(e);return t.__chain__=!0,t}function oi(e,t,n){return t.call(n,e)}var ai=Bi(function(e){return e=ln(e),this.thru(function(t){return function(e,t){for(var n=-1,i=e.length,o=-1,a=t.length,s=r(i+a);++n<i;)s[n]=e[n];for(;++o<a;)s[n++]=t[o];return s}(Wi(t)?t:[Dr(t)],e)})});var si=Bi(function(e,t){return Yt(e,ln(t))}),ui=Un(function(e,t,n){Te.call(e,n)?++e[n]:e[n]=1});function li(e,t,r){var i=Wi(e)?Lt:an;return r&&xr(e,t,r)&&(t=n),"function"==typeof t&&r===n||(t=dr(t,r,3)),i(e,t)}function ci(e,t,n){return(Wi(e)?Vt:sn)(e,t=dr(t,n,3))}var fi=Yn(rn),di=Yn(on,!0);var pi=er(Ut,rn),hi=er(function(e,t){for(var n=e.length;n--&&!1!==t(e[n],n,e););return e},on),mi=Un(function(e,t,n){Te.call(e,n)?e[n].push(t):e[n]=[t]});function vi(e,t,n,r){var i=e?vr(e):0;return Er(i)||(i=(e=Eo(e)).length),n="number"!=typeof n||r&&xr(t,n,r)?0:n<0?yt(i+n,0):n||0,"string"==typeof e||!Wi(e)&&to(e)?n<=i&&e.indexOf(t,n)>-1:!!i&&mr(e,t,n)>-1}var gi=Un(function(e,t,n){e[n]=t}),$i=Bi(function(e,t,i){var o=-1,a="function"==typeof t,s=Cr(t),u=wr(e)?r(e.length):[];return rn(e,function(e){var r=a?t:s&&null!=e?e[t]:n;u[++o]=r?r.apply(e,i):yr(e,t,i)}),u});function yi(e,t,n){return(Wi(e)?Bt:yn)(e,t=dr(t,n,3))}var wi=Un(function(e,t,n){e[n?0:1].push(t)},function(){return[[],[]]});var bi=ar(Ht,rn),xi=ar(function(e,t,n,r){var i=e.length;for(r&&i&&(n=e[--i]);i--;)n=t(n,e[i],i,e);return n},on);function Ci(e,t,r){if(r?xr(e,t,r):null==t)return(i=(e=jr(e)).length)>0?e[Sn(0,i-1)]:n;var i,o=-1,a=io(e),s=(i=a.length)-1;for(t=wt(t<0?0:+t||0,i);++o<t;){var u=Sn(o,s),l=a[u];a[u]=a[o],a[o]=l}return a.length=t,a}function Si(e,t,r){var i=Wi(e)?Wt:kn;return r&&xr(e,t,r)&&(t=n),"function"==typeof t&&r===n||(t=dr(t,r,3)),i(e,t)}var Ei=Bi(function(e,t){if(null==e)return[];var n=t[2];return n&&xr(t[0],t[1],n)&&(t.length=1),An(e,ln(t),[])});var qi=bt||function(){return(new i).getTime()};function ki(e,t){var r;if("function"!=typeof t){if("function"!=typeof e)throw new ke(x);var i=e;e=t,t=i}return function(){return--e>0&&(r=t.apply(this,arguments)),e<=1&&(t=n),r}}var _i=Bi(function(e,t,n){var r=a;if(n.length){var i=Je(n,_i.placeholder);r|=f}return fr(e,r,t,n,i)}),Ai=Bi(function(e,t){for(var n=-1,r=(t=t.length?ln(t):go(e)).length;++n<r;){var i=t[n];e[i]=fr(e[i],a,e)}return e}),Pi=Bi(function(e,t,n){var r=a|s;if(n.length){var i=Je(n,Pi.placeholder);r|=f}return fr(t,r,e,n,i)}),Mi=Gn(l),Ti=Gn(c);function ji(e,t,r){var i,o,a,s,u,l,c,f=0,d=!1,p=!0;if("function"!=typeof e)throw new ke(x);if(t=t<0?0:+t||0,!0===r){var h=!0;p=!1}else Yi(r)&&(h=!!r.leading,d="maxWait"in r&&yt(+r.maxWait||0,t),p="trailing"in r?!!r.trailing:p);function m(t,r){r&&it(r),o=l=c=n,t&&(f=qi(),a=e.apply(u,i),l||o||(i=u=n))}function v(){var e=t-(qi()-s);e<=0||e>t?m(c,o):l=lt(v,e)}function g(){m(p,l)}function $(){if(i=arguments,s=qi(),u=this,c=p&&(l||!h),!1===d)var r=h&&!l;else{o||h||(f=s);var m=d-(s-f),$=m<=0||m>d;$?(o&&(o=it(o)),f=s,a=e.apply(u,i)):o||(o=lt(g,m))}return $&&l?l=it(l):l||t===d||(l=lt(v,t)),r&&($=!0,a=e.apply(u,i)),!$||l||o||(i=u=n),a}return $.cancel=function(){l&&it(l),o&&it(o),f=0,o=l=c=n},$}var Di=Bi(function(e,t){return tn(e,1,t)}),Oi=Bi(function(e,t,n){return tn(e,t,n)}),Ri=Zn(),Ni=Zn(!0);function Fi(e,t){if("function"!=typeof e||t&&"function"!=typeof t)throw new ke(x);var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=e.apply(this,r);return n.cache=o.set(i,a),a};return n.cache=new Fi.Cache,n}var Ii=Bi(function(e,t){if(t=ln(t),"function"!=typeof e||!Lt(t,Ie))throw new ke(x);var n=t.length;return Bi(function(r){for(var i=wt(r.length,n);i--;)r[i]=t[i](r[i]);return e.apply(this,r)})});var Ui=or(f),Li=or(d),Vi=Bi(function(e,t){return fr(e,h,n,n,n,ln(t))});function Bi(e,t){if("function"!=typeof e)throw new ke(x);return t=yt(t===n?e.length-1:+t||0,0),function(){for(var n=arguments,i=-1,o=yt(n.length-t,0),a=r(o);++i<o;)a[i]=n[t+i];switch(t){case 0:return e.call(this,a);case 1:return e.call(this,n[0],a);case 2:return e.call(this,n[0],n[1],a)}var s=r(t+1);for(i=-1;++i<t;)s[i]=n[i];return s[t]=a,e.apply(this,s)}}function zi(e,t){return e>t}function Hi(e){return Xe(e)&&wr(e)&&Te.call(e,"callee")&&!st.call(e,"callee")}var Wi=vt||function(e){return Xe(e)&&Er(e.length)&&De.call(e)==E};function Gi(e,t,r,i){var o=(r="function"==typeof r?Rn(r,i,3):n)?r(e,t):n;return o===n?gn(e,t,r):!!o}function Qi(e){return Xe(e)&&"string"==typeof e.message&&De.call(e)==_}function Xi(e){return Yi(e)&&De.call(e)==A}function Yi(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function Ji(e){return null!=e&&(Xi(e)?nt.test(Me.call(e)):Xe(e)&&pe.test(e))}function Ki(e){return"number"==typeof e||Xe(e)&&De.call(e)==M}function Zi(e){var t,r;return!(!Xe(e)||De.call(e)!=T||Hi(e)||!(Te.call(e,"constructor")||"function"!=typeof(t=e.constructor)||t instanceof t))&&(dn(e,function(e,t){r=t}),r===n||Te.call(e,r))}function eo(e){return Yi(e)&&De.call(e)==j}function to(e){return"string"==typeof e||Xe(e)&&De.call(e)==O}function no(e){return Xe(e)&&Er(e.length)&&!!be[De.call(e)]}function ro(e,t){return e<t}function io(e){var t=e?vr(e):0;return Er(t)?t?It(e):[]:Eo(e)}function oo(e){return Jt(e,yo(e))}var ao=Ln(function e(t,r,i,o,a){if(!Yi(t))return t;var s=wr(r)&&(Wi(r)||no(r)),u=s?n:$o(r);return Ut(u||r,function(l,c){if(u&&(l=r[c=l]),Xe(l))o||(o=[]),a||(a=[]),function(e,t,r,i,o,a,s){for(var u=a.length,l=t[r];u--;)if(a[u]==l)return void(e[r]=s[u]);var c=e[r],f=o?o(c,l,r,e,t):n,d=f===n;d&&(f=l,wr(l)&&(Wi(l)||no(l))?f=Wi(c)?c:wr(c)?It(c):[]:Zi(l)||Hi(l)?f=Hi(c)?oo(c):Zi(c)?c:{}:d=!1),a.push(l),s.push(f),d?e[r]=i(f,l,o,a,s):(f==f?f!==c:c==c)&&(e[r]=f)}(t,r,c,e,i,o,a);else{var f=t[c],d=i?i(f,l,c,t,r):n,p=d===n;p&&(d=l),d===n&&(!s||c in t)||!p&&(d==d?d===f:f!=f)||(t[c]=d)}}),t}),so=Ln(function(e,t,n){return n?Qt(e,t,n):Xt(e,t)});var uo=Qn(so,function(e,t){return e===n?t:e}),lo=Qn(ao,function e(t,r){return t===n?r:ao(t,r,e)}),co=Kn(pn),fo=Kn(hn),po=tr(cn),ho=tr(fn),mo=nr(pn),vo=nr(hn);function go(e){return mn(e,yo(e))}var $o=$t?function(e){var t=null==e?n:e.constructor;return"function"==typeof t&&t.prototype===e||"function"!=typeof e&&wr(e)?Tr(e):Yi(e)?$t(e):[]}:Tr;function yo(e){if(null==e)return[];Yi(e)||(e=Se(e));var t=e.length;t=t&&Er(t)&&(Wi(e)||Hi(e))&&t||0;for(var n=e.constructor,i=-1,o="function"==typeof n&&n.prototype===e,a=r(t),s=t>0;++i<t;)a[i]=i+"";for(var u in e)s&&br(u,t)||"constructor"==u&&(o||!Te.call(e,u))||a.push(u);return a}var wo=rr(!0),bo=rr(),xo=Bi(function(e,t){if(null==e)return{};if("function"!=typeof t[0])return t=Bt(ln(t),qe),kr(e,nn(yo(e),t));var n=Rn(t[0],t[1],3);return _r(e,function(e,t,r){return!n(e,t,r)})});function Co(e){e=Dr(e);for(var t=-1,n=$o(e),i=n.length,o=r(i);++t<i;){var a=n[t];o[t]=[a,e[a]]}return o}var So=Bi(function(e,t){return null==e?{}:"function"==typeof t[0]?_r(e,Rn(t[0],t[1],3)):kr(e,ln(t))});function Eo(e){return Mn(e,$o(e))}var qo=Hn(function(e,t,n){return t=t.toLowerCase(),e+(n?t.charAt(0).toUpperCase()+t.slice(1):t)});function ko(e){return(e=Ue(e))&&e.replace(me,ze).replace(ue,"")}var _o=Hn(function(e,t,n){return e+(n?"-":"")+t.toLowerCase()});var Ao=ir(),Po=ir(!0);function Mo(e,t){var n="";if(e=Ue(e),(t=+t)<1||!e||!gt(t))return n;for(;t%2&&(n+=e),e+=e,t=mt(t/2););return n}var To=Hn(function(e,t,n){return e+(n?"_":"")+t.toLowerCase()}),jo=Hn(function(e,t,n){return e+(n?" ":"")+(t.charAt(0).toUpperCase()+t.slice(1))});function Do(e,t,n){var r=e;return(e=Ue(e))?(n?xr(r,t,n):null==t)?e.slice(Ke(e),Ze(e)+1):(t+="",e.slice(Le(e,t),Ve(e,t)+1)):e}function Oo(e,t,r){return r&&xr(e,t,r)&&(t=n),(e=Ue(e)).match(t||$e)||[]}var Ro=Bi(function(e,t){try{return e.apply(n,t)}catch(e){return Qi(e)?e:new P(e)}});function No(e,t,r){return r&&xr(e,t,r)&&(t=n),Xe(e)?Io(e):Kt(e,t)}function Fo(e){return e}function Io(e){return wn(Zt(e,!0))}var Uo=Bi(function(e,t){return function(n){return yr(n,e,t)}}),Lo=Bi(function(e,t){return function(n){return yr(e,n,t)}});function Vo(e,t,r){if(null==r){var i=Yi(t),o=i?$o(t):n,a=o&&o.length?mn(t,o):n;(a?a.length:i)||(a=!1,r=t,t=e,e=this)}a||(a=mn(t,$o(t)));var s=!0,u=-1,l=Xi(e),c=a.length;!1===r?s=!1:Yi(r)&&"chain"in r&&(s=r.chain);for(;++u<c;){var f=a[u],d=t[f];e[f]=d,l&&(e.prototype[f]=function(t){return function(){var n=this.__chain__;if(s||n){var r=e(this.__wrapped__);return(r.__actions__=It(this.__actions__)).push({func:t,args:arguments,thisArg:e}),r.__chain__=n,r}return t.apply(e,zt([this.value()],arguments))}}(d))}return e}function Bo(){}function zo(e){return Cr(e)?xn(e):(n=(t=e)+"",t=Or(t),function(e){return vn(e,t,n)});var t,n}var Ho,Wo=lr("ceil"),Go=lr("floor"),Qo=Xn(zi,St),Xo=Xn(ro,Et),Yo=lr("round");return Tt.prototype=jt.prototype,(Dt.prototype=en(jt.prototype)).constructor=Dt,(Ot.prototype=en(jt.prototype)).constructor=Ot,Rt.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},Rt.prototype.get=function(e){return"__proto__"==e?n:this.__data__[e]},Rt.prototype.has=function(e){return"__proto__"!=e&&Te.call(this.__data__,e)},Rt.prototype.set=function(e,t){return"__proto__"!=e&&(this.__data__[e]=t),this},Nt.prototype.push=function(e){var t=this.data;"string"==typeof e||Yi(e)?t.set.add(e):t.hash[e]=!0},Fi.Cache=Rt,Tt.after=function(e,t){if("function"!=typeof t){if("function"!=typeof e)throw new ke(x);var n=e;e=t,t=n}return e=gt(e=+e)?e:0,function(){if(--e<1)return t.apply(this,arguments)}},Tt.ary=function(e,t,r){return r&&xr(e,t,r)&&(t=n),t=e&&null==t?e.length:yt(+t||0,0),fr(e,p,n,n,n,n,t)},Tt.assign=so,Tt.at=si,Tt.before=ki,Tt.bind=_i,Tt.bindAll=Ai,Tt.bindKey=Pi,Tt.callback=No,Tt.chain=ii,Tt.chunk=function(e,t,n){t=(n?xr(e,t,n):null==t)?1:yt(mt(t)||1,1);for(var i=0,o=e?e.length:0,a=-1,s=r(pt(o/t));i<o;)s[++a]=qn(e,i,i+=t);return s},Tt.compact=function(e){for(var t=-1,n=e?e.length:0,r=-1,i=[];++t<n;){var o=e[t];o&&(i[++r]=o)}return i},Tt.constant=function(e){return function(){return e}},Tt.countBy=ui,Tt.create=function(e,t,r){var i=en(e);return r&&xr(e,t,r)&&(t=n),t?Xt(i,t):i},Tt.curry=Mi,Tt.curryRight=Ti,Tt.debounce=ji,Tt.defaults=uo,Tt.defaultsDeep=lo,Tt.defer=Di,Tt.delay=Oi,Tt.difference=Nr,Tt.drop=Fr,Tt.dropRight=Ir,Tt.dropRightWhile=function(e,t,n){return e&&e.length?Tn(e,dr(t,n,3),!0,!0):[]},Tt.dropWhile=function(e,t,n){return e&&e.length?Tn(e,dr(t,n,3),!0):[]},Tt.fill=function(e,t,r,i){var o=e?e.length:0;return o?(r&&"number"!=typeof r&&xr(e,t,r)&&(r=0,i=o),function(e,t,r,i){var o=e.length;for((r=null==r?0:+r||0)<0&&(r=-r>o?0:o+r),(i=i===n||i>o?o:+i||0)<0&&(i+=o),o=r>i?0:i>>>0,r>>>=0;r<o;)e[r++]=t;return e}(e,t,r,i)):[]},Tt.filter=ci,Tt.flatten=function(e,t,n){var r=e?e.length:0;return n&&xr(e,t,n)&&(t=!1),r?ln(e,t):[]},Tt.flattenDeep=function(e){return e&&e.length?ln(e,!0):[]},Tt.flow=Ri,Tt.flowRight=Ni,Tt.forEach=pi,Tt.forEachRight=hi,Tt.forIn=po,Tt.forInRight=ho,Tt.forOwn=mo,Tt.forOwnRight=vo,Tt.functions=go,Tt.groupBy=mi,Tt.indexBy=gi,Tt.initial=function(e){return Ir(e,1)},Tt.intersection=zr,Tt.invert=function(e,t,r){r&&xr(e,t,r)&&(t=n);for(var i=-1,o=$o(e),a=o.length,s={};++i<a;){var u=o[i],l=e[u];t?Te.call(s,l)?s[l].push(u):s[l]=[u]:s[l]=u}return s},Tt.invoke=$i,Tt.keys=$o,Tt.keysIn=yo,Tt.map=yi,Tt.mapKeys=wo,Tt.mapValues=bo,Tt.matches=Io,Tt.matchesProperty=function(e,t){return bn(e,Zt(t,!0))},Tt.memoize=Fi,Tt.merge=ao,Tt.method=Uo,Tt.methodOf=Lo,Tt.mixin=Vo,Tt.modArgs=Ii,Tt.negate=function(e){if("function"!=typeof e)throw new ke(x);return function(){return!e.apply(this,arguments)}},Tt.omit=xo,Tt.once=function(e){return ki(2,e)},Tt.pairs=Co,Tt.partial=Ui,Tt.partialRight=Li,Tt.partition=wi,Tt.pick=So,Tt.pluck=function(e,t){return yi(e,zo(t))},Tt.property=zo,Tt.propertyOf=function(e){return function(t){return vn(e,Or(t),t+"")}},Tt.pull=function(){var e=arguments,t=e[0];if(!t||!t.length)return t;for(var n=0,r=mr(),i=e.length;++n<i;)for(var o=0,a=e[n];(o=r(t,a,o))>-1;)ct.call(t,o,1);return t},Tt.pullAt=Wr,Tt.range=function(e,t,i){i&&xr(e,t,i)&&(t=i=n),e=+e||0,null==t?(t=e,e=0):t=+t||0;for(var o=-1,a=yt(pt((t-e)/((i=null==i?1:+i||0)||1)),0),s=r(a);++o<a;)s[o]=e,e+=i;return s},Tt.rearg=Vi,Tt.reject=function(e,t,n){var r=Wi(e)?Vt:sn;return t=dr(t,n,3),r(e,function(e,n,r){return!t(e,n,r)})},Tt.remove=function(e,t,n){var r=[];if(!e||!e.length)return r;var i=-1,o=[],a=e.length;for(t=dr(t,n,3);++i<a;){var s=e[i];t(s,i,e)&&(r.push(s),o.push(i))}return Cn(e,o),r},Tt.rest=Gr,Tt.restParam=Bi,Tt.set=function(e,t,n){if(null==e)return e;for(var r=t+"",i=-1,o=(t=null!=e[r]||Cr(t,e)?[r]:Or(t)).length,a=o-1,s=e;null!=s&&++i<o;){var u=t[i];Yi(s)&&(i==a?s[u]=n:null==s[u]&&(s[u]=br(t[i+1])?[]:{})),s=s[u]}return e},Tt.shuffle=function(e){return Ci(e,Et)},Tt.slice=function(e,t,n){var r=e?e.length:0;return r?(n&&"number"!=typeof n&&xr(e,t,n)&&(t=0,n=r),qn(e,t,n)):[]},Tt.sortBy=function(e,t,r){if(null==e)return[];r&&xr(e,t,r)&&(t=n);var i=-1;return t=dr(t,r,3),_n(yn(e,function(e,n,r){return{criteria:t(e,n,r),index:++i,value:e}}),Be)},Tt.sortByAll=Ei,Tt.sortByOrder=function(e,t,r,i){return null==e?[]:(i&&xr(t,r,i)&&(r=n),Wi(t)||(t=null==t?[]:[t]),Wi(r)||(r=null==r?[]:[r]),An(e,t,r))},Tt.spread=function(e){if("function"!=typeof e)throw new ke(x);return function(t){return e.apply(this,t)}},Tt.take=function(e,t,n){return e&&e.length?((n?xr(e,t,n):null==t)&&(t=1),qn(e,0,t<0?0:t)):[]},Tt.takeRight=function(e,t,n){var r=e?e.length:0;return r?((n?xr(e,t,n):null==t)&&(t=1),qn(e,(t=r-(+t||0))<0?0:t)):[]},Tt.takeRightWhile=function(e,t,n){return e&&e.length?Tn(e,dr(t,n,3),!1,!0):[]},Tt.takeWhile=function(e,t,n){return e&&e.length?Tn(e,dr(t,n,3)):[]},Tt.tap=function(e,t,n){return t.call(n,e),e},Tt.throttle=function(e,t,n){var r=!0,i=!0;if("function"!=typeof e)throw new ke(x);return!1===n?r=!1:Yi(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),ji(e,t,{leading:r,maxWait:+t,trailing:i})},Tt.thru=oi,Tt.times=function(e,t,n){if((e=mt(e))<1||!gt(e))return[];var i=-1,o=r(wt(e,qt));for(t=Rn(t,n,1);++i<e;)i<qt?o[i]=t(i):t(i);return o},Tt.toArray=io,Tt.toPlainObject=oo,Tt.transform=function(e,t,r,i){var o=Wi(e)||no(e);if(t=dr(t,i,4),null==r)if(o||Yi(e)){var a=e.constructor;r=o?Wi(e)?new a:[]:en(Xi(a)?a.prototype:n)}else r={};return(o?Ut:pn)(e,function(e,n,i){return t(r,e,n,i)}),r},Tt.union=Yr,Tt.uniq=Jr,Tt.unzip=Kr,Tt.unzipWith=Zr,Tt.values=Eo,Tt.valuesIn=function(e){return Mn(e,yo(e))},Tt.where=function(e,t){return ci(e,wn(t))},Tt.without=ei,Tt.wrap=function(e,t){return fr(t=null==t?Fo:t,f,n,[e],[])},Tt.xor=function(){for(var e=-1,t=arguments.length;++e<t;){var n=arguments[e];if(wr(n))var r=r?zt(nn(r,n),nn(n,r)):n}return r?Pn(r):[]},Tt.zip=ti,Tt.zipObject=ni,Tt.zipWith=ri,Tt.backflow=Ni,Tt.collect=yi,Tt.compose=Ni,Tt.each=pi,Tt.eachRight=hi,Tt.extend=so,Tt.iteratee=No,Tt.methods=go,Tt.object=ni,Tt.select=ci,Tt.tail=Gr,Tt.unique=Jr,Vo(Tt,Tt),Tt.add=function(e,t){return(+e||0)+(+t||0)},Tt.attempt=Ro,Tt.camelCase=qo,Tt.capitalize=function(e){return(e=Ue(e))&&e.charAt(0).toUpperCase()+e.slice(1)},Tt.ceil=Wo,Tt.clone=function(e,t,n,r){return t&&"boolean"!=typeof t&&xr(e,t,n)?t=!1:"function"==typeof t&&(r=n,n=t,t=!1),"function"==typeof n?Zt(e,t,Rn(n,r,1)):Zt(e,t)},Tt.cloneDeep=function(e,t,n){return"function"==typeof t?Zt(e,!0,Rn(t,n,1)):Zt(e,!0)},Tt.deburr=ko,Tt.endsWith=function(e,t,r){t+="";var i=(e=Ue(e)).length;return r=r===n?i:wt(r<0?0:+r||0,i),(r-=t.length)>=0&&e.indexOf(t,r)==r},Tt.escape=function(e){return(e=Ue(e))&&Z.test(e)?e.replace(J,He):e},Tt.escapeRegExp=function(e){return(e=Ue(e))&&se.test(e)?e.replace(ae,We):e||"(?:)"},Tt.every=li,Tt.find=fi,Tt.findIndex=Ur,Tt.findKey=co,Tt.findLast=di,Tt.findLastIndex=Lr,Tt.findLastKey=fo,Tt.findWhere=function(e,t){return fi(e,wn(t))},Tt.first=Vr,Tt.floor=Go,Tt.get=function(e,t,r){var i=null==e?n:vn(e,Or(t),t+"");return i===n?r:i},Tt.gt=zi,Tt.gte=function(e,t){return e>=t},Tt.has=function(e,t){if(null==e)return!1;var n=Te.call(e,t);if(!n&&!Cr(t)){if(null==(e=1==(t=Or(t)).length?e:vn(e,qn(t,0,-1))))return!1;t=Hr(t),n=Te.call(e,t)}return n||Er(e.length)&&br(t,e.length)&&(Wi(e)||Hi(e))},Tt.identity=Fo,Tt.includes=vi,Tt.indexOf=Br,Tt.inRange=function(e,t,r){return t=+t||0,r===n?(r=t,t=0):r=+r||0,e>=wt(t,r)&&e<yt(t,r)},Tt.isArguments=Hi,Tt.isArray=Wi,Tt.isBoolean=function(e){return!0===e||!1===e||Xe(e)&&De.call(e)==q},Tt.isDate=function(e){return Xe(e)&&De.call(e)==k},Tt.isElement=function(e){return!!e&&1===e.nodeType&&Xe(e)&&!Zi(e)},Tt.isEmpty=function(e){return null==e||(wr(e)&&(Wi(e)||to(e)||Hi(e)||Xe(e)&&Xi(e.splice))?!e.length:!$o(e).length)},Tt.isEqual=Gi,Tt.isError=Qi,Tt.isFinite=function(e){return"number"==typeof e&&gt(e)},Tt.isFunction=Xi,Tt.isMatch=function(e,t,r,i){return r="function"==typeof r?Rn(r,i,3):n,$n(e,gr(t),r)},Tt.isNaN=function(e){return Ki(e)&&e!=+e},Tt.isNative=Ji,Tt.isNull=function(e){return null===e},Tt.isNumber=Ki,Tt.isObject=Yi,Tt.isPlainObject=Zi,Tt.isRegExp=eo,Tt.isString=to,Tt.isTypedArray=no,Tt.isUndefined=function(e){return e===n},Tt.kebabCase=_o,Tt.last=Hr,Tt.lastIndexOf=function(e,t,n){var r=e?e.length:0;if(!r)return-1;var i=r;if("number"==typeof n)i=(n<0?yt(r+n,0):wt(n||0,r-1))+1;else if(n){var o=e[i=Dn(e,t,!0)-1];return(t==t?t===o:o!=o)?i:-1}if(t!=t)return Qe(e,i,!0);for(;i--;)if(e[i]===t)return i;return-1},Tt.lt=ro,Tt.lte=function(e,t){return e<=t},Tt.max=Qo,Tt.min=Xo,Tt.noConflict=function(){return Oe._=Ye,this},Tt.noop=Bo,Tt.now=qi,Tt.pad=function(e,t,n){t=+t;var r=(e=Ue(e)).length;if(r>=t||!gt(t))return e;var i=(t-r)/2,o=mt(i);return(n=ur("",pt(i),n)).slice(0,o)+e+n},Tt.padLeft=Ao,Tt.padRight=Po,Tt.parseInt=function(e,t,n){return(n?xr(e,t,n):null==t)?t=0:t&&(t=+t),e=Do(e),xt(e,t||(de.test(e)?16:10))},Tt.random=function(e,t,r){r&&xr(e,t,r)&&(t=r=n);var i=null==e,o=null==t;if(null==r&&(o&&"boolean"==typeof e?(r=e,e=1):"boolean"==typeof t&&(r=t,o=!0)),i&&o&&(t=1,o=!1),e=+e||0,o?(t=e,e=0):t=+t||0,r||e%1||t%1){var a=Ct();return wt(e+a*(t-e+ot("1e-"+((a+"").length-1))),t)}return Sn(e,t)},Tt.reduce=bi,Tt.reduceRight=xi,Tt.repeat=Mo,Tt.result=function(e,t,r){var i=null==e?n:e[t];return i===n&&(null==e||Cr(t,e)||(i=null==(e=1==(t=Or(t)).length?e:vn(e,qn(t,0,-1)))?n:e[Hr(t)]),i=i===n?r:i),Xi(i)?i.call(e):i},Tt.round=Yo,Tt.runInContext=e,Tt.size=function(e){var t=e?vr(e):0;return Er(t)?t:$o(e).length},Tt.snakeCase=To,Tt.some=Si,Tt.sortedIndex=Qr,Tt.sortedLastIndex=Xr,Tt.startCase=jo,Tt.startsWith=function(e,t,n){return e=Ue(e),n=null==n?0:wt(n<0?0:+n||0,e.length),e.lastIndexOf(t,n)==n},Tt.sum=function(e,t,r){return r&&xr(e,t,r)&&(t=n),1==(t=dr(t,r,3)).length?function(e,t){for(var n=e.length,r=0;n--;)r+=+t(e[n])||0;return r}(Wi(e)?e:jr(e),t):(i=t,o=0,rn(e,function(e,t,n){o+=+i(e,t,n)||0}),o);var i,o},Tt.template=function(e,t,r){var i=Tt.templateSettings;r&&xr(e,t,r)&&(t=r=n),e=Ue(e);var o,a,s=Qt(Xt({},(t=Qt(Xt({},r||t),i,Gt)).imports),i.imports,Gt),u=$o(s),l=Mn(s,u),c=0,f=t.interpolate||ve,d="__p += '",p=Ee((t.escape||ve).source+"|"+f.source+"|"+(f===ne?ce:ve).source+"|"+(t.evaluate||ve).source+"|$","g"),h="//# sourceURL="+("sourceURL"in t?t.sourceURL:"lodash.templateSources["+ ++we+"]")+"\n";e.replace(p,function(t,n,r,i,s,u){return r||(r=i),d+=e.slice(c,u).replace(ge,Ge),n&&(o=!0,d+="' +\n__e("+n+") +\n'"),s&&(a=!0,d+="';\n"+s+";\n__p += '"),r&&(d+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),c=u+t.length,t}),d+="';\n";var m=t.variable;m||(d="with (obj) {\n"+d+"\n}\n"),d=(a?d.replace(G,""):d).replace(Q,"$1").replace(X,"$1;"),d="function("+(m||"obj")+") {\n"+(m?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(a?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+d+"return __p\n}";var v=Ro(function(){return D(u,h+"return "+d).apply(n,l)});if(v.source=d,Qi(v))throw v;return v},Tt.trim=Do,Tt.trimLeft=function(e,t,n){var r=e;return(e=Ue(e))?(n?xr(r,t,n):null==t)?e.slice(Ke(e)):e.slice(Le(e,t+"")):e},Tt.trimRight=function(e,t,n){var r=e;return(e=Ue(e))?(n?xr(r,t,n):null==t)?e.slice(0,Ze(e)+1):e.slice(0,Ve(e,t+"")+1):e},Tt.trunc=function(e,t,r){r&&xr(e,t,r)&&(t=n);var i=m,o=v;if(null!=t)if(Yi(t)){var a="separator"in t?t.separator:a;i="length"in t?+t.length||0:i,o="omission"in t?Ue(t.omission):o}else i=+t||0;if(i>=(e=Ue(e)).length)return e;var s=i-o.length;if(s<1)return o;var u=e.slice(0,s);if(null==a)return u+o;if(eo(a)){if(e.slice(s).search(a)){var l,c,f=e.slice(0,s);for(a.global||(a=Ee(a.source,(fe.exec(a)||"")+"g")),a.lastIndex=0;l=a.exec(f);)c=l.index;u=u.slice(0,null==c?s:c)}}else if(e.indexOf(a,s)!=s){var d=u.lastIndexOf(a);d>-1&&(u=u.slice(0,d))}return u+o},Tt.unescape=function(e){return(e=Ue(e))&&K.test(e)?e.replace(Y,et):e},Tt.uniqueId=function(e){var t=++je;return Ue(e)+t},Tt.words=Oo,Tt.all=li,Tt.any=Si,Tt.contains=vi,Tt.eq=Gi,Tt.detect=fi,Tt.foldl=bi,Tt.foldr=xi,Tt.head=Vr,Tt.include=vi,Tt.inject=bi,Vo(Tt,(Ho={},pn(Tt,function(e,t){Tt.prototype[t]||(Ho[t]=e)}),Ho),!1),Tt.sample=Ci,Tt.prototype.sample=function(e){return this.__chain__||null!=e?this.thru(function(t){return Ci(t,e)}):Ci(this.value())},Tt.VERSION=o,Ut(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){Tt[e].placeholder=Tt}),Ut(["drop","take"],function(e,t){Ot.prototype[e]=function(n){var r=this.__filtered__;if(r&&!t)return new Ot(this);n=null==n?1:yt(mt(n)||0,0);var i=this.clone();return r?i.__takeCount__=wt(i.__takeCount__,n):i.__views__.push({size:n,type:e+(i.__dir__<0?"Right":"")}),i},Ot.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}}),Ut(["filter","map","takeWhile"],function(e,t){var n=t+1,r=n!=b;Ot.prototype[e]=function(e,t){var i=this.clone();return i.__iteratees__.push({iteratee:dr(e,t,1),type:n}),i.__filtered__=i.__filtered__||r,i}}),Ut(["first","last"],function(e,t){var n="take"+(t?"Right":"");Ot.prototype[e]=function(){return this[n](1).value()[0]}}),Ut(["initial","rest"],function(e,t){var n="drop"+(t?"":"Right");Ot.prototype[e]=function(){return this.__filtered__?new Ot(this):this[n](1)}}),Ut(["pluck","where"],function(e,t){var n=t?"filter":"map",r=t?wn:zo;Ot.prototype[e]=function(e){return this[n](r(e))}}),Ot.prototype.compact=function(){return this.filter(Fo)},Ot.prototype.reject=function(e,t){return e=dr(e,t,1),this.filter(function(t){return!e(t)})},Ot.prototype.slice=function(e,t){e=null==e?0:+e||0;var r=this;return r.__filtered__&&(e>0||t<0)?new Ot(r):(e<0?r=r.takeRight(-e):e&&(r=r.drop(e)),t!==n&&(r=(t=+t||0)<0?r.dropRight(-t):r.take(t-e)),r)},Ot.prototype.takeRightWhile=function(e,t){return this.reverse().takeWhile(e,t).reverse()},Ot.prototype.toArray=function(){return this.take(Et)},pn(Ot.prototype,function(e,t){var r=/^(?:filter|map|reject)|While$/.test(t),i=/^(?:first|last)$/.test(t),o=Tt[i?"take"+("last"==t?"Right":""):t];o&&(Tt.prototype[t]=function(){var t=i?[1]:arguments,a=this.__chain__,s=this.__wrapped__,u=!!this.__actions__.length,l=s instanceof Ot,c=t[0],f=l||Wi(s);f&&r&&"function"==typeof c&&1!=c.length&&(l=f=!1);var d=function(e){return i&&a?o(e,1)[0]:o.apply(n,zt([e],t))},p={func:oi,args:[d],thisArg:n},h=l&&!u;if(i&&!a)return h?((s=s.clone()).__actions__.push(p),e.call(s)):o.call(n,this.value())[0];if(!i&&f){s=h?s:new Ot(this);var m=e.apply(s,t);return m.__actions__.push(p),new Dt(m,a)}return this.thru(d)})}),Ut(["join","pop","push","replace","shift","sort","splice","split","unshift"],function(e){var t=(/^(?:replace|split)$/.test(e)?Pe:_e)[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:join|pop|replace|shift)$/.test(e);Tt.prototype[e]=function(){var e=arguments;return r&&!this.__chain__?t.apply(this.value(),e):this[n](function(n){return t.apply(n,e)})}}),pn(Ot.prototype,function(e,t){var n=Tt[t];if(n){var r=n.name;(Mt[r]||(Mt[r]=[])).push({name:t,func:n})}}),Mt[sr(n,s).name]=[{name:"wrapper",func:n}],Ot.prototype.clone=function(){var e=new Ot(this.__wrapped__);return e.__actions__=It(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=It(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=It(this.__views__),e},Ot.prototype.reverse=function(){if(this.__filtered__){var e=new Ot(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},Ot.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=Wi(e),r=t<0,i=n?e.length:0,o=function(e,t,n){for(var r=-1,i=n.length;++r<i;){var o=n[r],a=o.size;switch(o.type){case"drop":e+=a;break;case"dropRight":t-=a;break;case"take":t=wt(t,e+a);break;case"takeRight":e=yt(e,t-a)}}return{start:e,end:t}}(0,i,this.__views__),a=o.start,s=o.end,u=s-a,l=r?s:a-1,c=this.__iteratees__,f=c.length,d=0,p=wt(u,this.__takeCount__);if(!n||i<y||i==u&&p==u)return jn(r&&n?e.reverse():e,this.__actions__);var h=[];e:for(;u--&&d<p;){for(var m=-1,v=e[l+=t];++m<f;){var g=c[m],$=g.iteratee,x=g.type,C=$(v);if(x==b)v=C;else if(!C){if(x==w)continue e;break e}}h[d++]=v}return h},Tt.prototype.chain=function(){return ii(this)},Tt.prototype.commit=function(){return new Dt(this.value(),this.__chain__)},Tt.prototype.concat=ai,Tt.prototype.plant=function(e){for(var t,n=this;n instanceof jt;){var r=Rr(n);t?i.__wrapped__=r:t=r;var i=r;n=n.__wrapped__}return i.__wrapped__=e,t},Tt.prototype.reverse=function(){var e=this.__wrapped__,t=function(e){return r&&r.__dir__<0?e:e.reverse()};if(e instanceof Ot){var r=e;return this.__actions__.length&&(r=new Ot(this)),(r=r.reverse()).__actions__.push({func:oi,args:[t],thisArg:n}),new Dt(r,this.__chain__)}return this.thru(t)},Tt.prototype.toString=function(){return this.value()+""},Tt.prototype.run=Tt.prototype.toJSON=Tt.prototype.valueOf=Tt.prototype.value=function(){return jn(this.__wrapped__,this.__actions__)},Tt.prototype.collect=Tt.prototype.map,Tt.prototype.head=Tt.prototype.first,Tt.prototype.select=Tt.prototype.filter,Tt.prototype.tail=Tt.prototype.rest,Tt}();"function"==typeof n&&"object"==typeof n.amd&&n.amd?(Oe._=tt,n(function(){return tt})):Ae&&Pe?De?(Pe.exports=tt)._=tt:Ae._=tt:Oe._=tt}).call(commonjsGlobal)});function mixProvider(e,t){function n(e){var t=e.mixer;if(!(lodash.isPlainObject(e)&&"mixer"in e))return[e];if(lodash.isUndefined(n.mixers[t]))throw new Error("Mixer: unknow mixer type = "+t);if(!e.remix&&e.$parsed)return e.$parsed;if(e.$parsed=n.mixers[t].apply(null,arguments),!lodash.isArray(e.$parsed))throw new Error("Mixer: mixers must return an array (mixer: "+t+")");return e.$parsed}function r(e,t){return lodash.reduce(e,function(e,i){if(lodash.isPlainObject(i)&&"mixer"in i&&"wrapper"!=i.mixer&&!i.wrapper){var o=r(n(i,t),t);return e.concat(o)}return e.concat([i])},[])}return n.mixers={wrapper:function(e){return e.data},repeat:function(e){var t,n=e.data||[],r=[];for(t=0;t<e.times;t++)r=r.concat(lodash.clone(n,!0));return r},random:function(t,n){var i=t.data?r(t.data,n):[];return e(i)},choose:function(t,n){var i=t.data?r(t.data,n):[];return lodash.take(e(i),t.n?t.n:1)},custom:function(e,t){return lodash.isFunction(e.fn)?e.fn(e,t):[]},weightedRandom:i,weightedChoose:i},n;function i(e,n){var i,o=e.data?r(e.data,n):[],a=e.n||1,s=[],u=lodash.reduce(e.weights,function(e,t){return e+t});for(i=0;i<a;i++)s.push(l());return s;function l(){var n,r=t()*u,i=0;for(n=0;n<o.length;n++)if(r<=(i=+(i+=e.weights[n]).toFixed(3)))return e.data[n];throw new Error("Mixer: something went wrong with weightedRandom")}}}function mixerDotNotationProvider$1(e){return function(t,n){return lodash.isString(t)?/[^/]\./.test(t)?e(t,n):t.replace("/.","."):t}}function mixerConditionProvider$1(e,t){var n={gt:i(lodash.gt),greaterThan:i(lodash.gt),gte:i(lodash.gte),greaterThanOrEqual:i(lodash.gte),equals:lodash.eq,in:lodash.rearg(lodash.contains,1,0),contains:lodash.rearg(lodash.contains,1,0),exactly:function(e,t){return e===t},isTruthy:r};return function(i,o){var a,s,u=(s=(a=i).operator,lodash.isFunction(a)?a:lodash.has(a,"operator")?lodash.isFunction(s)?s:n[s]:lodash.has(a,"to")?lodash.eq:r),l=e(i.compare,o),c=e(i.to,o);return i.DEBUG&&t({type:"info",message:"Condition info",rows:[["Left: ",l],["Operator: ",i.operator||"equals"],["Right: ",c]],context:i}),i.negate?!u.apply(o,[l,c,o]):u.apply(o,[l,c,o])};function r(e){return!!e}function i(e){return function(t,n){return!![t,n].every(lodash.isNumber)&&e(t,n)}}}function evaluateProvider(e){return function t(n,r){function i(e){return t(e,r)}return lodash.isArray(n)&&(n={and:n}),n.and?lodash.every(n.and,i):n.nand?!lodash.every(n.nand,i):n.or?lodash.some(n.or,i):n.nor?!lodash.some(n.nor,i):e(n,r)}}function mixerBranchingDecorator$1(e,t,n){return e.mixers.branch=function(e,r){return r=lodash.extend(r||{},n),t(e.conditions,r)?e.data||[]:e.elseData||[]},e.mixers.multiBranch=function(e,r){var i;if(r=lodash.extend(r||{},n),i=lodash.find(e.branches,function(e){return t(e.conditions,r)}))return i.data||[];return e.elseData||[]},e}function mixerSequenceProvider$1(e){function t(e){this.sequence=e,this.stack=[],this.add(e),this.pointer=0}return lodash.extend(t.prototype,{add:function(e,t){this.stack.push({pointer:t?e.length:-1,sequence:e})},proceed:function(t,n){var r=this.stack[this.stack.length-1],i="next"===t;if(!r)throw new Error("mixerSequence: subSequence not found");r.pointer+=i?1:-1;var o=r.sequence[r.pointer];return lodash.isUndefined(o)&&this.stack.length>1?(this.stack.pop(),this.proceed.call(this,t,n)):o&&o.mixer?(this.add(e(o,n),!i),this.proceed.call(this,t,n)):this},next:function(e){return this.pointer++,this.proceed.call(this,"next",e)},prev:function(e){return this.pointer--,this.proceed.call(this,"prev",e)},current:function(){var e=this.stack[this.stack.length-1];if(!e)throw new Error("mixerSequence: subSequence not found");var t=e.sequence[e.pointer];if(t)return t.$meta=this.meta(),t},meta:function(){return{number:this.pointer,outOf:lodash.reduce(this.stack,function(e,t){return e+t.sequence.length-1},0)+1}}}),t}function dotNotation$1(e,t){if(!lodash.isUndefined(e))return lodash.isString(e)&&(e=e.split(".")),e.reduce(function(e,t){if(lodash.isPlainObject(e)||lodash.isArray(e))return e[t]},t)}function piConsoleFactory(e){return window.DEBUG?function t(n){if(lodash.get(t,"settings.hideConsole",!1))return window.postMessage({type:"kill-console"},"*");e[n.type]&&e[n.type](n.message);window.postMessage((r=n,lodash.cloneDeep(r,function(e){return lodash.isFunction(e)?e.toString():lodash.isError(e)?{name:e.name,message:e.message,stack:e.stack}:void 0})),"*");var r}:lodash.noop}mixProvider.$inject=["randomizeShuffle","randomizeRandom"],mixerDotNotationProvider$1.$inject=["dotNotation"],mixerConditionProvider$1.$inject=["mixerDotNotation","piConsole"],evaluateProvider.$inject=["mixerCondition"],mixerBranchingDecorator$1.$inject=["$delegate","mixerEvaluate","mixerDefaultContext"],mixerSequenceProvider$1.$inject=["mixer"],piConsoleFactory.$inject=["$log"];var piConsole$1=piConsoleFactory(console),mixer=mixProvider(lodash.shuffle,Math.random),mixerDotNotation=mixerDotNotationProvider$1(dotNotation$1),mixerCondition=mixerConditionProvider$1(mixerDotNotation,piConsole$1),mixerEvaluate=evaluateProvider(mixerCondition),mixerDefaultContext={};mixerBranchingDecorator$1(mixer,mixerEvaluate,mixerDefaultContext);var MixerSequence=mixerSequenceProvider$1(mixer);function templateObjProvider$1(e){return function(t,n,r){var i,o=lodash.get(r,"skip",[]),a={},s=lodash.assign({},n,e);for(i in t)a[i]=-1==o.indexOf(i)?u(t[i]):t[i];return a;function u(e){return lodash.isString(e)?~(t=e).indexOf("<%")?lodash.template(t)(s):t:lodash.isArray(e)?e.map(u):lodash.isPlainObject(e)?lodash.mapValues(e,u):e;var t}}}templateObjProvider$1.$inject=["templateDefaultContext"];var templateObj=templateObjProvider$1({});function collectionService(){function e(t){if(t instanceof e)return t;if(!(lodash.isUndefined(t)||lodash.isArray(t)||t instanceof e))throw new Error("Collections can only be constructed from arrays");this.collection=t||[],this.length=this.collection.length,this.pointer=-1}lodash.extend(e.prototype,{first:function(){return this.pointer=0,this.collection[this.pointer]},last:function(){return this.pointer=this.collection.length-1,this.collection[this.pointer]},end:function(){this.pointer=this.collection.length},current:function(){return this.collection[this.pointer]},next:function(){return this.collection[++this.pointer]},previous:function(){return this.collection[--this.pointer]},add:function(e){return arguments.length?(e=lodash.isArray(e)?e:[e],this.collection=this.collection.concat(e),this.length=this.collection.length,this):this},at:function(e){return this.collection[e]}});var t=Array.prototype.slice;return lodash.each(["where","filter"],function(n){e.prototype[n]=function(){var r=t.call(arguments);return r.unshift(this.collection),new e(lodash[n].apply(lodash,r))}}),e}function RandomizerProvider(e,t,n){function r(){this._cache={random:{},exRandom:{},sequential:{}}}return lodash.extend(r.prototype,{random:function(t,n,r){var i=this._cache.random;if(r&&!lodash.isUndefined(i[n]))return i[n];return i[n]=e(t),i[n]},exRandom:function(e,r,i){var o,a=this._cache.exRandom,s=a[r];if(lodash.isUndefined(s))return(s=a[r]=new n(t(e))).first();if(s.length!==e)throw new Error("This seed  ("+r+") points to a collection with the wrong length, you can only use a seed for sets of the same length");if(i)return s.current();return o=s.next(),lodash.isUndefined(o)?(s=a[r]=new n(t(e))).first():o},sequential:function(e,t,r){var i,o=this._cache.sequential,a=o[t];if(lodash.isUndefined(a))return(a=o[t]=new n(lodash.range(e))).first();if(a.length!==e)throw new Error("This seed  ("+t+") points to a collection with the wrong length, you can only use a seed for sets of the same length");if(r)return a.current();return i=a.next(),lodash.isUndefined(i)?a.first():i}}),r}function storeProvider$1(e){function t(){this.store={}}return lodash.extend(t.prototype,{create:function(t){if(this.store[t])throw new Error("The name space "+t+" already exists");this.store[t]=new e,this.store[t].namespace=t},read:function(e){if(!this.store[e])throw new Error("The name space "+e+" does not exist");return this.store[e]},update:function(e,t){this.read(e).add(t)},del:function(e){this.store[e]=void 0}}),t}function SequenceProvider(e){function t(t,n,r){this.namespace=t,this.mixerSequence=new e(n),this.db=r}return lodash.extend(t.prototype,{next:function(e){return this.mixerSequence.next(e),this},prev:function(e){return this.mixerSequence.prev(e),this},current:function(e,t){e||(e={});var n=this.mixerSequence.current(e);return n?this.db.inflate(this.namespace,n,e,t):n},all:function(e,t){for(var n=[],r=this.next().current(e,t);r;)n.push(r),r=this.next().current(e,t);return n}}),t}function DatabaseProvider(e,t,n,r,i,o){function a(){this.store=new e,this.randomizer=new t}return lodash.extend(a.prototype,{createColl:function(e){this.store.create(e)},getColl:function(e){return this.store.read(e)},add:function(e,t){this.store.read(e).add(t)},inflate:function(e,t,i,a){var s,u=this.getColl(e);try{t.$inflated&&!t.reinflate||(t.$inflated=n(t,u,this.randomizer),t.$templated=null)}catch(e){throw o({type:"error",message:"Failed to inherit",error:e,context:t}),this.onError&&this.onError(e),e}try{t.$templated&&!t.$inflated.regenerateTemplate||(i[e+"Meta"]=t.$meta,i[e+"Data"]=r(t.$inflated.data||{},i,a),t.$templated=r(t.$inflated,i,a))}catch(e){throw o({type:"error",message:"Failed to apply template",error:e,context:t.$inflated}),this.onError&&this.onError(e),e}return s=t.$templated,i.global&&s.addGlobal&&lodash.extend(i.global,s.addGlobal),i.current&&s.addCurrent&&lodash.extend(i.current,s.addCurrent),s},sequence:function(e,t){if(!lodash.isArray(t))throw new Error("Sequence must be an array.");return new i(e,t,this)}}),a}function queryProvider$1(e){return function(t,n,r){var i=new e(n);if(lodash.isFunction(t))return t(n);(lodash.isString(t)||lodash.isNumber(t))&&(t={set:t,type:"random"}),t.set&&(i=i.where({set:t.set})),lodash.isString(t.data)&&(i=i.filter(function(e){return e.handle===t.data||e.data&&e.data.handle===t.data})),lodash.isPlainObject(t.data)&&(i=i.where({data:t.data})),lodash.isFunction(t.data)&&(i=i.filter(t.data));var o,a=t.seed||"$"+n.namespace+t.set,s=i.length,u=t.repeat;switch(t.type){case void 0:case"byData":case"random":o=r.random(s,a,u);break;case"exRandom":o=r.exRandom(s,a,u);break;case"sequential":o=r.sequential(s,a,u);break;case"first":o=0;break;case"last":o=s-1;break;default:throw new Error("Unknow query type: "+t.type)}if(lodash.isUndefined(i.at(o)))throw new Error("Query failed, object ("+JSON.stringify(t)+") not found. If you are trying to apply a template, you should know that they are not supported for inheritance.");return i.at(o)}}function inflateProvider$1(e,t){function n(e){return lodash.isFunction(e.customize)&&e.customize.apply(e,[e,t.global]),e}return function t(r,i,o,a,s){if(!(s=a?--s:10))throw new Error("Inheritance loop too deep, you can only inherit up to 10 levels down");if(!lodash.isPlainObject(r))throw new Error("You are trying to inflate a non object ("+JSON.stringify(r)+")");var u,l=lodash.cloneDeep(r),c=l.inherit;if(!l.inherit)return a||n(l),l;if(!(u=e(c,i,o)))throw new Error("Query failed, object ("+JSON.stringify(c)+") not found.");if(u=t(u,i,o,!0,s),c.merge&&!lodash.isArray(c.merge))throw new Error("Inheritance error: inherit.merge must be an array.");return lodash.each(u,function(e,t){var n,r;if(t in l){if(-1!=lodash.indexOf(c.merge,t)){if(n=l[t],r=e,lodash.isArray(n)){if(!lodash.isArray(r))throw new Error('Inheritance error: You tried merging an array with an non array (for "'+t+'")');l[t]=n.concat(r)}if(lodash.isPlainObject(n)){if(!lodash.isPlainObject(r))throw new Error('Inheritance error: You tried merging an object with an non object (for "'+t+'")');l[t]=lodash.extend({},r,n)}}}else l[t]=lodash.isFunction(e)?e:lodash.cloneDeep(e)}),u.data&&(l.data=lodash.extend(u.data,l.data||{})),!a&&n(l),l}}RandomizerProvider.$inject=["randomizeInt","randomizeRange","Collection"],storeProvider$1.$inject=["Collection"],SequenceProvider.$inject=["MixerSequence"],DatabaseProvider.$inject=["DatabaseStore","DatabaseRandomizer","databaseInflate","templateObj","databaseSequence","piConsole"],queryProvider$1.$inject=["Collection"],inflateProvider$1.$inject=["databaseQuery","$rootScope"];var global$1=window.piGlobal,piConsole=piConsoleFactory(console),collection=collectionService(),DatabaseRandomizer=RandomizerProvider(randomInt,randomArr,collection),databaseQuery=queryProvider$1(collection,piConsole),databaseInflate=inflateProvider$1(databaseQuery,{global:global$1},piConsole),DatabaseStore=storeProvider$1(collection),databaseSequence=SequenceProvider(MixerSequence),Database$2=DatabaseProvider(DatabaseStore,DatabaseRandomizer,databaseInflate,templateObj,databaseSequence,piConsole);function randomArr(e){return lodash.shuffle(lodash.range(e))}function randomInt(e){return Math.floor(Math.random()*e)}window.piGlobal||(window.piGlobal={});var global$2=window.piGlobal;function APIconstructor(e){function t(){var t=this.script={type:e.type,name:"anonymous "+e.type,settings:{},current:{},sequence:[]};this.settings=t.settings,lodash.forEach(e.sets,function(e){t[e+"Sets"]=[]})}return lodash.forEach(e.sets,function(e){t.prototype[lodash.camelCase("add-"+e+"-set")]=add_set(e)}),lodash.extend(t.prototype,e.static,{setName:function(e){this.script.name=e},addSettings:function(e,t){if(!lodash.isString(e))throw new Error("The first argument to API.addSettings must be a string");return lodash.isPlainObject(t)?this.settings[e]=lodash.extend(this.settings[e]||{},t):this.settings[e]=t,this},addSequence:function(e){var t=this.script;return lodash.isArray(e)||(e=[e]),t.sequence=t.sequence.concat(e),this},addGlobal:function(e){if(!lodash.isPlainObject(e))throw new Error("global must be an object");return lodash.merge(global$2,e)},getGlobal:function(){return global$2},addCurrent:function(e){if(!lodash.isPlainObject(e))throw new Error("current must be an object");return lodash.merge(this.script.current,e)},getCurrent:function(){return this.script.current},addScript:function(e){return lodash.merge(this.script,e)},getScript:function(){return this.script},save:function(){console.info("API.save was called with",arguments,"but is not supported by this version of MinnoJS")},post:function(e,t){return angular.injector(["ng"]).invoke(["$http",function(n){return n.post(e,t)}])},shuffle:lodash.shuffle.bind(lodash)}),t}function add_set(e){function t(e,t){return t.map(function(t){return lodash.set(t,"set",e)})}function n(e){return lodash.isArray(e)?e:[e]}return function(r,i){var o,a=this.script[e+"Sets"]||(this.script[e+"Sets"]=[]);if(lodash.isUndefined(r))throw new Error('There is an undefined "'+e+'Set".');lodash.isArray(r)&&(o=r),lodash.isString(r)&&(o=t(r,n(i))),lodash.isPlainObject(r)&&(o=lodash.map(r,function(e,r){return t(r,n(e))}),o=lodash.flatten(o)),function(t){if(lodash.isUndefined(t))throw new Error('Error parsing "'+e+'Set": Unknown set type.');if(!t.every(function(e){return lodash.has(e,"set")}))throw new Error('All elements must be defined and belong to a set (error parsing "'+e+'Set")')}(o),a.push.apply(a,o)}}var PROGRESS_BAR=['<div class="row" style="opacity:0.4;">','<div class="hidden-xs col-sm-3 text-right" style="font-weight:bold;">Progress:&nbsp;</div>','<div class="col-xs-12 col-sm-7">','<div class="progress">','<div class="progress-bar" style="width: <%= 100 * tasksMeta.number / tasksMeta.outOf %>%;"></div>',"</div>","</div>","</div>"].join("\n"),manager=APIconstructor({type:"manager",sets:["tasks"],static:{PROGRESS_BAR:PROGRESS_BAR}}),api$1=APIconstructor({type:"PIP",sets:["trial","stimulus","media"]});api$1.prototype.addTrialSets=api$1.prototype.addTrialSet,api$1.prototype.addStimulusSets=api$1.prototype.addStimulusSet,api$1.prototype.addMediaSets=api$1.prototype.addMediaSet,api$1.prototype.getLogs=function(){return this.script.current.logs};var quest=APIconstructor({type:"quest",sets:["pages","questions"]});function ComputeD(){lodash.extend(this,{dataArray:{},AnalyzedVar:"latency",ErrorVar:"error",condVar:"",cond1VarValues:[],cond2VarValues:[],parcelVar:"",parcelValue:[],fastRT:300,maxFastTrialsRate:.1,minRT:400,maxRT:1e4,maxErrorParcelRate:.4,errorLatency:{use:"latency",penalty:600,useForSTD:!0},postSettings:{}})}lodash.extend(ComputeD.prototype,{setComputeObject:function(e){lodash.extend(this,e)},setDataArray:function(){var e=window.piGlobal;this.dataArray=e.current.logs}});var messages={MessageDef:[],manyErrors:"There were too many errors made to determine a result.",tooFast:"There were too many fast trials to determine a result.",notEnough:"There were not enough trials to determine a result."},requirejs$1,require,define;function Message(){this.messages=lodash.extend({},messages)}function ParcelMng$1(e){this.parcelArray=[],this.scoreData={},this.msgMan=e}function Scorer(){this.computeData=new ComputeD,this.msgMan=new Message,this.parcelMng=new ParcelMng$1(this.msgMan)}function post(e,t){return new Promise(function(n,r){var i=new XMLHttpRequest;i.open("POST",e,!0),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),i.onreadystatechange=function(){4===this.readyState&&(this.status>=200&&this.status<400?n(this.responseText):r(new Error("Failed posting to: "+e)))},i.send(JSON.stringify(t))})}lodash.extend(Message.prototype,{setMsgObject:function(e){lodash.extend(this.messages,e)},getScoreMsg:function(e){var t=this.messages.MessageDef;if(!t||!t.length)throw new Error('You must define a "MessageDef" array.');var n=parseFloat(e),r=null,i=null,o="error: msg was not set",a=!1;if(lodash.each(t,function(e){r=parseFloat(e.cut),i=e.message,n<=r&&!a&&(o=i,a=!0)}),!a){var s=t[t.length-1];o=s.message}return o},getMessage:function(e){return this.messages[e]}}),lodash.extend(ParcelMng$1.prototype,{Init:function(e){var t=this,n=this.msgMan,r=window.piGlobal.current.logs;t.parcelArray=[],t.scoreData={},t.msgMan=n;var i=e.AnalyzedVar,o=e.ErrorVar,a=e.parcelVar,s=e.parcelValue,u=e.minRT,l=e.maxRT,c=e.fastRT,f=0,d=0,p=0,h=0,m=parseFloat(e.maxFastTrialsRate);if(void 0===s||0===s.length){p=0,f=0,d=0,h=0;var v={name:"general",trialIData:[]};lodash.each(r,function(n){n[i]>=u&&n[i]<=l?(p++,1==n.data[o]&&h++,t.validate(v,n,e)&&f++):n[i]<=c&&d++}),t.checkErrors(p,h,e),t.parcelArray[0]=v}else lodash.each(s,function(n,s){p=0,f=0,d=0,h=0;var m={};m.name=n,m.trialIData=[],lodash.each(r,function(r){r.data[a]==n&&(r[i]>=u&&r[i]<=l?(p++,1==r.data[o]&&h++,t.validate(m,r,e)&&f++):r[i]<=c&&d++)}),t.checkErrors(p,h,e),t.parcelArray[s]=m});d/f>m&&(t.scoreData.errorMessage=this.msgMan.getMessage("tooFast"))},checkErrors:function(e,t,n){t/e>n.maxErrorParcelRate&&(this.scoreData.errorMessage=this.msgMan.getMessage("manyErrors"))},validate:function(e,t,n){var r=n.errorLatency,i=n.ErrorVar,o=t.data;return"latency"==r.use?(e.trialIData.push(t),!0):"false"==r.use?"1"!=o[i]&&(e.trialIData.push(t),!0):"penalty"==r.use?(e.trialIData.push(t),!0):void 0},addPenalty:function(e,t){var n=t.errorLatency,r=this;if("penalty"==n.use){var i=parseFloat(n.penalty),o=t.ErrorVar,a=t.AnalyzedVar,s=t.condVar,u=t.cond1VarValues,l=t.cond2VarValues,c=e.trialIData,f=e.avgCon1,d=e.avgCon2;lodash.each(c,function(e){var t=e.data,n=t[o],c=t[s],p=r.checkArray(c,u),h=r.checkArray(c,l);"1"==n&&(p?e[a]+=f+i:h&&(e[a]+=d+i))})}},avgAll:function(e){var t=this;lodash.each(t.parcelArray,function(n){t.avgParcel(n,e)})},avgParcel:function(e,t){var n=this,r=e.trialIData,i=t.condVar,o=t.cond1VarValues,a=t.cond2VarValues,s=t.AnalyzedVar,u=0,l=0,c=0,f=0,d=0,p=0;lodash.each(r,function(e){var t=e[s],r=e.data;c+=t,p++;var h=r[i],m=n.checkArray(h,o),v=n.checkArray(h,a);m?(f++,u+=t):v&&(d++,l+=t)}),(f<=2||d<=2)&&(n.scoreData.errorMessage=this.msgMan.getMessage("notEnough")),0!==f&&(u/=f),0!==d&&(l/=d),e.avgCon1=u,e.avgCon2=l,e.diff=e.avgCon1-e.avgCon2,0!==p&&(e.avgBoth=c/p),n.addPenalty(e,t)},checkArray:function(e,t){for(var n=0;n<t.length;n++){if(t[n]==e)return!0}return!1},varianceAll:function(e){var t=this;lodash.each(t.parcelArray,function(n){t.varianceParcel(n,e)})},varianceParcel:function(e,t){var n,r=this,i=t.AnalyzedVar,o=e.trialIData,a=t.cond1VarValues,s=t.cond2VarValues,u=t.condVar,l=e.avgBoth,c=0,f=0,d=[],p=[],h=t.errorLatency.useForSTD;lodash.each(o,function(e){var n=e.data,o=e[i],l=n[t.ErrorVar],c=n[u],f=r.checkArray(c,a),m=r.checkArray(c,s);f?h?d.push(o):"0"==l&&d.push(o):m&&(h?p.push(o):"0"==l&&d.push(o))}),n=d.concat(p),lodash.each(n,function(e){f+=(c=e-l)*c}),e.variance=f/(n.length-1)},scoreAll:function(e){var t=this,n=0;lodash.each(t.parcelArray,function(r){t.scoreParcel(r,e),n+=r.score});var r=n/t.parcelArray.length;t.scoreData.score=r.toFixed(2)},scoreParcel:function(e){var t=Math.sqrt(e.variance);0===t?(this.scoreData.errorMessage=this.msgMan.getMessage("notEnough"),e.score=e.diff):e.score=e.diff/t}}),lodash.extend(Scorer.prototype,{addSettings:function(e,t){switch(e){case"compute":this.computeData.setComputeObject(t);break;case"message":this.msgMan.setMsgObject(t);break;default:throw new Error('SCORER:addSettings: unknow "type" '+e)}},computeD:function(){var e=this.computeData,t=this.parcelMng;e.setDataArray(),t.Init(e),t.avgAll(e),t.varianceAll(e),t.scoreAll(e);var n=t.scoreData;return void 0===n.errorMessage||null===n.errorMessage?{FBMsg:this.getFBMsg(n.score),DScore:n.score,error:!1}:{FBMsg:n.errorMessage,DScore:"",error:!0}},postToServer:function(e,t,n,r){var i=this.computeData.postSettings||{},o=i.url,a={};return n||(n=i.score),r||(r=i.msg),a[n]=e,a[r]=t,post(o,a)},dynamicPost:function(e){return post((this.computeData.postSettings||{}).url,e)},getFBMsg:function(e){return this.msgMan.getScoreMsg(e)}}),function(global,setTimeout){var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.3.5",commentRegExp=/\/\*[\s\S]*?\*\/|([^:"'=]|^)\/\/.*$/gm,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,isBrowser=!("undefined"==typeof window||"undefined"==typeof navigator||!window.document),isWebWorker=!isBrowser&&"undefined"!=typeof importScripts,readyRegExp=isBrowser&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),contexts={},cfg={},globalDefQueue=[],useInteractive=!1;function commentReplace(e,t){return t||""}function isFunction(e){return"[object Function]"===ostring.call(e)}function isArray(e){return"[object Array]"===ostring.call(e)}function each(e,t){var n;if(e)for(n=0;n<e.length&&(!e[n]||!t(e[n],n,e));n+=1);}function eachReverse(e,t){var n;if(e)for(n=e.length-1;n>-1&&(!e[n]||!t(e[n],n,e));n-=1);}function hasProp(e,t){return hasOwn.call(e,t)}function getOwn(e,t){return hasProp(e,t)&&e[t]}function eachProp(e,t){var n;for(n in e)if(hasProp(e,n)&&t(e[n],n))break}function mixin(e,t,n,r){return t&&eachProp(t,function(t,i){!n&&hasProp(e,i)||(!r||"object"!=typeof t||!t||isArray(t)||isFunction(t)||t instanceof RegExp?e[i]=t:(e[i]||(e[i]={}),mixin(e[i],t,n,r)))}),e}function bind(e,t){return function(){return t.apply(e,arguments)}}function scripts(){return document.getElementsByTagName("script")}function defaultOnError(e){throw e}function getGlobal(e){if(!e)return e;var t=global;return each(e.split("."),function(e){t=t[e]}),t}function makeError(e,t,n,r){var i=new Error(t+"\nhttp://requirejs.org/docs/errors.html#"+e);return i.requireType=e,i.requireModules=r,n&&(i.originalError=n),i}if(void 0===define){if(void 0!==requirejs$1){if(isFunction(requirejs$1))return;cfg=requirejs$1,requirejs$1=void 0}void 0===require||isFunction(require)||(cfg=require,require=void 0),req=requirejs$1=function(e,t,n,r){var i,o,a=defContextName;return isArray(e)||"string"==typeof e||(o=e,isArray(t)?(e=t,t=n,n=r):e=[]),o&&o.context&&(a=o.context),(i=getOwn(contexts,a))||(i=contexts[a]=req.s.newContext(a)),o&&i.configure(o),i.require(e,t,n)},req.config=function(e){return req(e)},req.nextTick=void 0!==setTimeout?function(e){setTimeout(e,4)}:function(e){e()},require||(require=req),req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),each(["toUrl","undef","defined","specified"],function(e){req[e]=function(){var t=contexts[defContextName];return t.require[e].apply(t,arguments)}}),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],baseElement=document.getElementsByTagName("base")[0],baseElement&&(head=s.head=baseElement.parentNode)),req.onError=defaultOnError,req.createNode=function(e,t,n){var r=e.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");return r.type=e.scriptType||"text/javascript",r.charset="utf-8",r.async=!0,r},req.load=function(e,t,n){var r,i=e&&e.config||{};if(isBrowser)return(r=req.createNode(i,t,n)).setAttribute("data-requirecontext",e.contextName),r.setAttribute("data-requiremodule",t),!r.attachEvent||r.attachEvent.toString&&r.attachEvent.toString().indexOf("[native code")<0||isOpera?(r.addEventListener("load",e.onScriptLoad,!1),r.addEventListener("error",e.onScriptError,!1)):(useInteractive=!0,r.attachEvent("onreadystatechange",e.onScriptLoad)),r.src=n,i.onNodeCreated&&i.onNodeCreated(r,i,t,n),currentlyAddingScript=r,baseElement?head.insertBefore(r,baseElement):head.appendChild(r),currentlyAddingScript=null,r;if(isWebWorker)try{setTimeout(function(){},0),importScripts(n),e.completeLoad(t)}catch(r){e.onError(makeError("importscripts","importScripts failed for "+t+" at "+n,r,[t]))}},isBrowser&&!cfg.skipDataMain&&eachReverse(scripts(),function(e){if(head||(head=e.parentNode),dataMain=e.getAttribute("data-main"))return mainScript=dataMain,cfg.baseUrl||-1!==mainScript.indexOf("!")||(src=mainScript.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath),mainScript=mainScript.replace(jsSuffixRegExp,""),req.jsExtRegExp.test(mainScript)&&(mainScript=dataMain),cfg.deps=cfg.deps?cfg.deps.concat(mainScript):[mainScript],!0}),define=function(e,t,n){var r,i;"string"!=typeof e&&(n=t,t=e,e=null),isArray(t)||(n=t,t=null),!t&&isFunction(n)&&(t=[],n.length&&(n.toString().replace(commentRegExp,commentReplace).replace(cjsRequireRegExp,function(e,n){t.push(n)}),t=(1===n.length?["require"]:["require","exports","module"]).concat(t))),useInteractive&&(r=currentlyAddingScript||getInteractiveScript())&&(e||(e=r.getAttribute("data-requiremodule")),i=contexts[r.getAttribute("data-requirecontext")]),i?(i.defQueue.push([e,t,n]),i.defQueueMap[e]=!0):globalDefQueue.push([e,t,n])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)}function newContext(e){var t,n,r,i,o,a={waitSeconds:7,baseUrl:"./",paths:{},bundles:{},pkgs:{},shim:{},config:{}},s={},u={},l={},c=[],f={},d={},p={},h=1,m=1;function v(e,t,n){var r,i,o,s,u,l,c,f,d,p,h=t&&t.split("/"),m=a.map,v=m&&m["*"];if(e&&(l=(e=e.split("/")).length-1,a.nodeIdCompat&&jsSuffixRegExp.test(e[l])&&(e[l]=e[l].replace(jsSuffixRegExp,"")),"."===e[0].charAt(0)&&h&&(e=h.slice(0,h.length-1).concat(e)),function(e){var t,n;for(t=0;t<e.length;t++)if("."===(n=e[t]))e.splice(t,1),t-=1;else if(".."===n){if(0===t||1===t&&".."===e[2]||".."===e[t-1])continue;t>0&&(e.splice(t-1,2),t-=2)}}(e),e=e.join("/")),n&&m&&(h||v)){e:for(o=(i=e.split("/")).length;o>0;o-=1){if(u=i.slice(0,o).join("/"),h)for(s=h.length;s>0;s-=1)if((r=getOwn(m,h.slice(0,s).join("/")))&&(r=getOwn(r,u))){c=r,f=o;break e}!d&&v&&getOwn(v,u)&&(d=getOwn(v,u),p=o)}!c&&d&&(c=d,f=p),c&&(i.splice(0,f,c),e=i.join("/"))}return getOwn(a.pkgs,e)||e}function g(e){isBrowser&&each(scripts(),function(t){if(t.getAttribute("data-requiremodule")===e&&t.getAttribute("data-requirecontext")===r.contextName)return t.parentNode.removeChild(t),!0})}function $(e){var t=getOwn(a.paths,e);if(t&&isArray(t)&&t.length>1)return t.shift(),r.require.undef(e),r.makeRequire(null,{skipMap:!0})([e]),!0}function y(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function w(e,t,n,i){var o,a,s,u,l=null,c=t?t.name:null,d=e,p=!0,g="";return e||(p=!1,e="_@r"+(h+=1)),l=(u=y(e))[0],e=u[1],l&&(l=v(l,c,i),a=getOwn(f,l)),e&&(l?g=n?e:a&&a.normalize?a.normalize(e,function(e){return v(e,c,i)}):-1===e.indexOf("!")?v(e,c,i):e:(l=(u=y(g=v(e,c,i)))[0],g=u[1],n=!0,o=r.nameToUrl(g))),{prefix:l,name:g,parentMap:t,unnormalized:!!(s=!l||a||n?"":"_unnormalized"+(m+=1)),url:o,originalName:d,isDefine:p,id:(l?l+"!"+g:g)+s}}function b(e){var t=e.id,n=getOwn(s,t);return n||(n=s[t]=new r.Module(e)),n}function x(e,t,n){var r=e.id,i=getOwn(s,r);!hasProp(f,r)||i&&!i.defineEmitComplete?(i=b(e)).error&&"error"===t?n(i.error):i.on(t,n):"defined"===t&&n(f[r])}function C(e,t){var n=e.requireModules,r=!1;t?t(e):(each(n,function(t){var n=getOwn(s,t);n&&(n.error=e,n.events.error&&(r=!0,n.emit("error",e)))}),r||req.onError(e))}function S(){globalDefQueue.length&&(each(globalDefQueue,function(e){var t=e[0];"string"==typeof t&&(r.defQueueMap[t]=!0),c.push(e)}),globalDefQueue=[])}function E(e){delete s[e],delete u[e]}function q(){var e,n,i=1e3*a.waitSeconds,l=i&&r.startTime+i<(new Date).getTime(),c=[],d=[],p=!1,h=!0;if(!t){if(t=!0,eachProp(u,function(e){var t=e.map,r=t.id;if(e.enabled&&(t.isDefine||d.push(e),!e.error))if(!e.inited&&l)$(r)?(n=!0,p=!0):(c.push(r),g(r));else if(!e.inited&&e.fetched&&t.isDefine&&(p=!0,!t.prefix))return h=!1}),l&&c.length)return(e=makeError("timeout","Load timeout for modules: "+c,null,c)).contextName=r.contextName,C(e);h&&each(d,function(e){!function e(t,n,r){var i=t.map.id;t.error?t.emit("error",t.error):(n[i]=!0,each(t.depMaps,function(i,o){var a=i.id,u=getOwn(s,a);!u||t.depMatched[o]||r[a]||(getOwn(n,a)?(t.defineDep(o,f[a]),t.check()):e(u,n,r))}),r[i]=!0)}(e,{},{})}),l&&!n||!p||!isBrowser&&!isWebWorker||o||(o=setTimeout(function(){o=0,q()},50)),t=!1}}function k(e){hasProp(f,e[0])||b(w(e[0],null,!0)).init(e[1],e[2])}function _(e,t,n,r){e.detachEvent&&!isOpera?r&&e.detachEvent(r,t):e.removeEventListener(n,t,!1)}function A(e){var t=e.currentTarget||e.srcElement;return _(t,r.onScriptLoad,"load","onreadystatechange"),_(t,r.onScriptError,"error"),{node:t,id:t&&t.getAttribute("data-requiremodule")}}function P(){var e;for(S();c.length;){if(null===(e=c.shift())[0])return C(makeError("mismatch","Mismatched anonymous define() module: "+e[e.length-1]));k(e)}r.defQueueMap={}}return i={require:function(e){return e.require?e.require:e.require=r.makeRequire(e.map)},exports:function(e){if(e.usingExports=!0,e.map.isDefine)return e.exports?f[e.map.id]=e.exports:e.exports=f[e.map.id]={}},module:function(e){return e.module?e.module:e.module={id:e.map.id,uri:e.map.url,config:function(){return getOwn(a.config,e.map.id)||{}},exports:e.exports||(e.exports={})}}},(n=function(e){this.events=getOwn(l,e.id)||{},this.map=e,this.shim=getOwn(a.shim,e.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0}).prototype={init:function(e,t,n,r){r=r||{},this.inited||(this.factory=t,n?this.on("error",n):this.events.error&&(n=bind(this,function(e){this.emit("error",e)})),this.depMaps=e&&e.slice(0),this.errback=n,this.inited=!0,this.ignore=r.ignore,r.enabled||this.enabled?this.enable():this.check())},defineDep:function(e,t){this.depMatched[e]||(this.depMatched[e]=!0,this.depCount-=1,this.depExports[e]=t)},fetch:function(){if(!this.fetched){this.fetched=!0,r.startTime=(new Date).getTime();var e=this.map;if(!this.shim)return e.prefix?this.callPlugin():this.load();r.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],bind(this,function(){return e.prefix?this.callPlugin():this.load()}))}},load:function(){var e=this.map.url;d[e]||(d[e]=!0,r.load(this.map.id,e))},check:function(){if(this.enabled&&!this.enabling){var e,t,n=this.map.id,i=this.depExports,o=this.exports,a=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,this.depCount<1&&!this.defined){if(isFunction(a)){if(this.events.error&&this.map.isDefine||req.onError!==defaultOnError)try{o=r.execCb(n,a,i,o)}catch(t){e=t}else o=r.execCb(n,a,i,o);if(this.map.isDefine&&void 0===o&&((t=this.module)?o=t.exports:this.usingExports&&(o=this.exports)),e)return e.requireMap=this.map,e.requireModules=this.map.isDefine?[this.map.id]:null,e.requireType=this.map.isDefine?"define":"require",C(this.error=e)}else o=a;if(this.exports=o,this.map.isDefine&&!this.ignore&&(f[n]=o,req.onResourceLoad)){var s=[];each(this.depMaps,function(e){s.push(e.normalizedMap||e)}),req.onResourceLoad(r,this.map,s)}E(n),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else hasProp(r.defQueueMap,n)||this.fetch()}},callPlugin:function(){var e=this.map,t=e.id,n=w(e.prefix);this.depMaps.push(n),x(n,"defined",bind(this,function(n){var i,o,u,l=getOwn(p,this.map.id),c=this.map.name,f=this.map.parentMap?this.map.parentMap.name:null,d=r.makeRequire(e.parentMap,{enableBuildCallback:!0});return this.map.unnormalized?(n.normalize&&(c=n.normalize(c,function(e){return v(e,f,!0)})||""),x(o=w(e.prefix+"!"+c,this.map.parentMap,!0),"defined",bind(this,function(e){this.map.normalizedMap=o,this.init([],function(){return e},null,{enabled:!0,ignore:!0})})),void((u=getOwn(s,o.id))&&(this.depMaps.push(o),this.events.error&&u.on("error",bind(this,function(e){this.emit("error",e)})),u.enable()))):l?(this.map.url=r.nameToUrl(l),void this.load()):((i=bind(this,function(e){this.init([],function(){return e},null,{enabled:!0})})).error=bind(this,function(e){this.inited=!0,this.error=e,e.requireModules=[t],eachProp(s,function(e){0===e.map.id.indexOf(t+"_unnormalized")&&E(e.map.id)}),C(e)}),i.fromText=bind(this,function(n,o){var s=e.name,u=w(s),l=useInteractive;o&&(n=o),l&&(useInteractive=!1),b(u),hasProp(a.config,t)&&(a.config[s]=a.config[t]);try{req.exec(n)}catch(e){return C(makeError("fromtexteval","fromText eval for "+t+" failed: "+e,e,[t]))}l&&(useInteractive=!0),this.depMaps.push(u),r.completeLoad(s),d([s],i)}),void n.load(e.name,d,i,a))})),r.enable(n,this),this.pluginMaps[n.id]=n},enable:function(){u[this.map.id]=this,this.enabled=!0,this.enabling=!0,each(this.depMaps,bind(this,function(e,t){var n,o,a;if("string"==typeof e){if(e=w(e,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[t]=e,a=getOwn(i,e.id))return void(this.depExports[t]=a(this));this.depCount+=1,x(e,"defined",bind(this,function(e){this.undefed||(this.defineDep(t,e),this.check())})),this.errback?x(e,"error",bind(this,this.errback)):this.events.error&&x(e,"error",bind(this,function(e){this.emit("error",e)}))}n=e.id,o=s[n],hasProp(i,n)||!o||o.enabled||r.enable(e,this)})),eachProp(this.pluginMaps,bind(this,function(e){var t=getOwn(s,e.id);t&&!t.enabled&&r.enable(e,this)})),this.enabling=!1,this.check()},on:function(e,t){var n=this.events[e];n||(n=this.events[e]=[]),n.push(t)},emit:function(e,t){each(this.events[e],function(e){e(t)}),"error"===e&&delete this.events[e]}},(r={config:a,contextName:e,registry:s,defined:f,urlFetched:d,defQueue:c,defQueueMap:{},Module:n,makeModuleMap:w,nextTick:req.nextTick,onError:C,configure:function(e){if(e.baseUrl&&"/"!==e.baseUrl.charAt(e.baseUrl.length-1)&&(e.baseUrl+="/"),"string"==typeof e.urlArgs){var t=e.urlArgs;e.urlArgs=function(e,n){return(-1===n.indexOf("?")?"?":"&")+t}}var n=a.shim,i={paths:!0,bundles:!0,config:!0,map:!0};eachProp(e,function(e,t){i[t]?(a[t]||(a[t]={}),mixin(a[t],e,!0,!0)):a[t]=e}),e.bundles&&eachProp(e.bundles,function(e,t){each(e,function(e){e!==t&&(p[e]=t)})}),e.shim&&(eachProp(e.shim,function(e,t){isArray(e)&&(e={deps:e}),!e.exports&&!e.init||e.exportsFn||(e.exportsFn=r.makeShimExports(e)),n[t]=e}),a.shim=n),e.packages&&each(e.packages,function(e){var t;t=(e="string"==typeof e?{name:e}:e).name,e.location&&(a.paths[t]=e.location),a.pkgs[t]=e.name+"/"+(e.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}),eachProp(s,function(e,t){e.inited||e.map.unnormalized||(e.map=w(t,null,!0))}),(e.deps||e.callback)&&r.require(e.deps||[],e.callback)},makeShimExports:function(e){return function(){var t;return e.init&&(t=e.init.apply(global,arguments)),t||e.exports&&getGlobal(e.exports)}},makeRequire:function(t,n){function o(a,u,l){var c,d;return n.enableBuildCallback&&u&&isFunction(u)&&(u.__requireJsBuild=!0),"string"==typeof a?isFunction(u)?C(makeError("requireargs","Invalid require call"),l):t&&hasProp(i,a)?i[a](s[t.id]):req.get?req.get(r,a,t,o):(c=w(a,t,!1,!0).id,hasProp(f,c)?f[c]:C(makeError("notloaded",'Module name "'+c+'" has not been loaded yet for context: '+e+(t?"":". Use require([])")))):(P(),r.nextTick(function(){P(),(d=b(w(null,t))).skipMap=n.skipMap,d.init(a,u,l,{enabled:!0}),q()}),o)}return n=n||{},mixin(o,{isBrowser:isBrowser,toUrl:function(e){var n,i=e.lastIndexOf("."),o=e.split("/")[0];return-1!==i&&(!("."===o||".."===o)||i>1)&&(n=e.substring(i,e.length),e=e.substring(0,i)),r.nameToUrl(v(e,t&&t.id,!0),n,!0)},defined:function(e){return hasProp(f,w(e,t,!1,!0).id)},specified:function(e){return e=w(e,t,!1,!0).id,hasProp(f,e)||hasProp(s,e)}}),t||(o.undef=function(e){S();var n=w(e,t,!0),i=getOwn(s,e);i.undefed=!0,g(e),delete f[e],delete d[n.url],delete l[e],eachReverse(c,function(t,n){t[0]===e&&c.splice(n,1)}),delete r.defQueueMap[e],i&&(i.events.defined&&(l[e]=i.events),E(e))}),o},enable:function(e){getOwn(s,e.id)&&b(e).enable()},completeLoad:function(e){var t,n,i,o=getOwn(a.shim,e)||{},u=o.exports;for(S();c.length;){if(null===(n=c.shift())[0]){if(n[0]=e,t)break;t=!0}else n[0]===e&&(t=!0);k(n)}if(r.defQueueMap={},i=getOwn(s,e),!t&&!hasProp(f,e)&&i&&!i.inited){if(!(!a.enforceDefine||u&&getGlobal(u)))return $(e)?void 0:C(makeError("nodefine","No define call for "+e,null,[e]));k([e,o.deps||[],o.exportsFn])}q()},nameToUrl:function(e,t,n){var i,o,s,u,l,c,f=getOwn(a.pkgs,e);if(f&&(e=f),c=getOwn(p,e))return r.nameToUrl(c,t,n);if(req.jsExtRegExp.test(e))u=e+(t||"");else{for(i=a.paths,s=(o=e.split("/")).length;s>0;s-=1)if(l=getOwn(i,o.slice(0,s).join("/"))){isArray(l)&&(l=l[0]),o.splice(0,s,l);break}u=o.join("/"),u=("/"===(u+=t||(/^data\:|^blob\:|\?/.test(u)||n?"":".js")).charAt(0)||u.match(/^[\w\+\.\-]+:/)?"":a.baseUrl)+u}return a.urlArgs&&!/^blob\:/.test(u)?u+a.urlArgs(e,u):u},load:function(e,t){req.load(r,e,t)},execCb:function(e,t,n,r){return t.apply(r,n)},onScriptLoad:function(e){if("load"===e.type||readyRegExp.test((e.currentTarget||e.srcElement).readyState)){interactiveScript=null;var t=A(e);r.completeLoad(t.id)}},onScriptError:function(e){var t=A(e);if(!$(t.id)){var n=[];return eachProp(s,function(e,r){0!==r.indexOf("_@r")&&each(e.depMaps,function(e){if(e.id===t.id)return n.push(r),!0})}),C(makeError("scripterror",'Script error for "'+t.id+(n.length?'", needed by: '+n.join(", "):'"'),e,[t.id]))}}}).require=r.makeRequire(),r}function getInteractiveScript(){return interactiveScript&&"interactive"===interactiveScript.readyState?interactiveScript:(eachReverse(scripts(),function(e){if("interactive"===e.readyState)return interactiveScript=e}),interactiveScript)}}(void 0,"undefined"==typeof setTimeout?void 0:setTimeout);var module$5=angular.module("randomize",[]);module$5.value("randomizeRandom",Math.random),module$5.value("randomizeShuffle",lodash.shuffle),module$5.value("randomizeInt",function(e){return Math.floor(Math.random()*e)}),module$5.value("randomizeRange",function(e){return lodash.shuffle(lodash.range(e))});var consoleModule$1=angular.module("piConsole",[]);function mixerSequentialProvider(e){return function t(n,r,i){var o,a=n[0];if(i=i||0,i++>=10)throw new Error("Mixer: the mixer allows a maximum depth of 10");return lodash.isUndefined(a.mixer)?n:(o=e(a,r),n.shift(),o=o.concat(n),lodash.isUndefined(o[0])||lodash.isUndefined(o[0].mixer)?o:t(o,r,i))}}function mixerRecursiveProvider(e){return function t(n,r,i){if(i=i||0,i++>=10)throw new Error("Mixer: the mixer allows a maximum depth of 10");return lodash(n).map(function(n){return lodash.isUndefined(n.mixer)?n:t(e(n,r),r,i)}).flatten().value()}}consoleModule$1.factory("piConsole",piConsoleFactory),mixerSequentialProvider.$inject=["mixer"],mixerRecursiveProvider.$inject=["mixer"];var module$4=angular.module("mixer",[module$5.name,consoleModule$1.name]);function templateFilter$1(e,t){return function(n,r){if(!~n.indexOf("<%"))return n;r=lodash.extend(r||{},t);try{return lodash.template(n)(r)}catch(t){return e.error('ERROR: "'+t.message+'" in the following template: ',n),""}}}module$4.service("mixer",mixProvider),module$4.service("mixerSequential",mixerSequentialProvider),module$4.service("mixerRecursive",mixerRecursiveProvider),module$4.service("MixerSequence",mixerSequenceProvider$1),module$4.value("dotNotation",dotNotation$1),module$4.service("mixerDotNotation",mixerDotNotationProvider$1),module$4.service("mixerCondition",mixerConditionProvider$1),module$4.service("mixerEvaluate",evaluateProvider),module$4.config(["$provide",function(e){e.decorator("mixer",mixerBranchingDecorator$1)}]),module$4.constant("mixerDefaultContext",{}),templateFilter$1.$inject=["$log","templateDefaultContext"];var module$6=angular.module("template",[]);module$6.filter("template",templateFilter$1),module$6.service("templateObj",templateObjProvider$1),module$6.constant("templateDefaultContext",{});var module$3=angular.module("database",[module$4.name,module$6.name,consoleModule$1.name]).service("Collection",collectionService).service("DatabaseRandomizer",RandomizerProvider).service("databaseQuery",queryProvider$1).service("databaseInflate",inflateProvider$1).service("DatabaseStore",storeProvider$1).service("Database",DatabaseProvider).service("databaseSequence",SequenceProvider),module$7=angular.module("piConsole",[]);function piConsoleFactory$1(e){return window.DEBUG?function t(n){if(lodash.get(t,"settings.hideConsole",!1))return window.postMessage({type:"kill-console"},"*");e[n.type]&&e[n.type](n.message);window.postMessage((r=n,lodash.cloneDeep(r,function(e){return lodash.isFunction(e)?e.toString():lodash.isError(e)?{name:e.name,message:e.message,stack:e.stack}:void 0})),"*");var r}:lodash.noop}function SequenceProvider$1(){function e(e,t){if(!t)throw new Error("Sequences need to take a db as the second argument");this.sequence=t.sequence("pages",e),this.db=t}return lodash.extend(e.prototype,{next:function(e){return this.sequence.next(e),this},prev:function(e){return this.sequence.prev(e),this},current:function(e){var t,n=this.sequence.current(e,{skip:["questions"]});if(!n)return n;t=n.questions?lodash.isArray(n.questions)?n.questions:[n.questions]:[];var r=this.db.sequence("questions",t).all({pagesData:n.data,pagesMeta:n.$meta});return(n=lodash.clone(n,!0)).questions=r,n}}),e}module$7.factory("piConsole",piConsoleFactory$1),piConsoleFactory$1.$inject=["$log"];var stream=createCommonjsModule(function(e){!function(){var t=0,n={};function r(){function e(){return arguments.length>0&&arguments[0]!==n&&i(e,arguments[0]),e._state.value}var o;return(o=e).constructor=r,o._state={id:t++,value:void 0,state:0,derive:void 0,recover:void 0,deps:{},parents:[],endStream:void 0,unregister:void 0},o.map=o["fantasy-land/map"]=l,o["fantasy-land/ap"]=c,o["fantasy-land/of"]=r,o.valueOf=f,o.toJSON=d,o.toString=f,Object.defineProperties(o,{end:{get:function(){if(!o._state.endStream){var e=r();e.map(function(t){return!0===t&&(u(o),e._state.unregister=function(){u(e)}),t}),o._state.endStream=e}return o._state.endStream}}}),arguments.length>0&&arguments[0]!==n&&i(e,arguments[0]),e}function i(e,t){for(var n in o(e,t),e._state.deps)a(e._state.deps[n],!1);null!=e._state.unregister&&e._state.unregister(),function(e){for(var t in e._state.changed=!1,e._state.deps)e._state.deps[t]._state.changed=!1}(e)}function o(e,t){e._state.value=t,e._state.changed=!0,2!==e._state.state&&(e._state.state=1)}function a(e,t){var r=e._state.parents;if(r.length>0&&r.every(h)&&(t||r.some(m))){var i=e._state.derive();if(i===n)return!1;o(e,i)}}function s(e,t){if(!t.every(p))throw new Error("Ensure that each item passed to stream.combine/stream.merge is a stream");return n=r(),i=t,o=function(){return e.apply(this,t.concat([t.filter(m)]))},(s=n._state).derive=o,s.parents=i.filter(v),function e(t,n){for(var r=0;r<n.length;r++)n[r]._state.deps[t._state.id]=t,e(t,n[r]._state.parents)}(n,s.parents),a(n,!0),n;var n,i,o,s}function u(e){for(var t=0;t<e._state.parents.length;t++){delete e._state.parents[t]._state.deps[e._state.id]}for(var n in e._state.deps){var r=e._state.deps[n],i=r._state.parents.indexOf(e);i>-1&&r._state.parents.splice(i,1)}e._state.state=2,e._state.deps={}}function l(e){return s(function(t){return e(t())},[this])}function c(e){return s(function(e,t){return e()(t())},[e,this])}function f(){return this._state.value}function d(){return null!=this._state.value&&"function"==typeof this._state.value.toJSON?this._state.value.toJSON():this._state.value}function p(e){return e._state}function h(e){return 1===e._state.state}function m(e){return e._state.changed}function v(e){return 2!==e._state.state}r["fantasy-land/of"]=r,r.merge=function(e){return s(function(){return e.map(function(e){return e()})},e)},r.combine=s,r.scan=function(e,t,n){var r=s(function(n){return t=e(t,n._state.value)},[n]);return 0===r._state.state&&r(t),r},r.scanMerge=function(e,t){var n=e.map(function(e){var t=e[0];return 0===t._state.state&&t(void 0),t});return s(function(){var r=arguments[arguments.length-1];return n.forEach(function(n,i){r.indexOf(n)>-1&&(t=e[i][1](t,n._state.value))}),t},n)},r.HALT=n,e.exports=r}()});function TaskProvider(e,t,n,r,i,o,a){function s(s){var u,l,c,f,d=this,p=s.settings||{},h=a.global;if(this.script=s,this.db=new t,this.$logSource=stream(),this.logger=new n(this.$logSource,(u=s,l=h,c=lodash.assign({},lodash.get(u,"settings.logger")),f=lodash.assign({taskName:u.name},l.$meta,c.metaData),c.metaData=f,c),o),this.q=e.defer(),!lodash.isArray(s.sequence))throw new Error("Task: no sequence was defined");this.sequence=new r(s.sequence,this.db),this.promise=this.q.promise.then(function(){lodash.each(a.current.questions,function(e){if(e.$logged)return!0;d.log(e,{},h),e.$logged=!0}),d.logger.end(!0)}).finally(p.onEnd||lodash.noop),i(s,this.db)}return lodash.extend(s.prototype,{log:function(){this.$logSource.call(null,[].slice.call(arguments))},current:function(){var e=this.sequence.current();return e||this.end(),e},next:function(){return this.sequence.next()},prev:function(){return this.sequence.prev()},end:function(){this.q.resolve()}}),s}function parseProvider(){return function(e,t){t.createColl("pages"),t.createColl("questions"),t.add("pages",e.pagesSets||[]),t.add("questions",e.questionsSets||[]),e.settings||(e.settings={})}}function dfltQuestLogger(e,t,n){var r=lodash.extend({},t,e);return r.declined&&(r.response=e.responseObj=void 0),r}function post$2(e,t){return new Promise(function(n,r){var i=new XMLHttpRequest;i.open("POST",e,!0),i.setRequestHeader("Content-Type","application/json; charset=UTF-8"),i.onreadystatechange=function(){4===this.readyState&&(this.status>=200&&this.status<400?n(this.responseText):r(new Error("Failed posting to: "+e)))},i.send(serialize$1(t))})}function serialize$1(e){return"string"==typeof e?e:JSON.stringify(e)}function poster$1(e,t){var n=[],r=t.url;function i(e){var n=(t.serialize||(t.newServelet?buildPost:buildPostOld))(e,t.metaData);return post$2(r,n).catch(function(){return post$2(r,n)}).catch(t.error||lodash.noop)}r&&(e.map(function(e){if(n.push(e),!t.pulse)return;n.length>=t.pulse&&(i(n),n.length=0)}),e.end.map(function(){n.length&&i(n)}))}function buildPost(e,t){var n=lodash.assign({data:e},t);return JSON.stringify(n)}function buildPostOld(e,t){var n="json="+JSON.stringify(e),r=serialize(t);return n+(r?"&"+r:"")}function serialize(e){var t,n=[];for(t in e)n.push(encodeURIComponent(t)+"="+encodeURIComponent(e[t]));return n.join("&").replace(/%20/g,"+")}function createLogs(e,t,n){var r,i=e.map((r=t.logger||t.logMap||n,function(e){return r.apply(null,e)}));return t.poster?t.poster(i,t,poster$1):poster$1(i,t),i}TaskProvider.$inject=["$q","Database","Logger","QuestSequence","taskParse","dfltQuestLogger","$rootScope"];var module$2=angular.module("task",[module$3.name,module$7.name]),nowFn;function stopperProvider(e){function t(){this.startTime=e()}return t.prototype.now=function(){return e()-this.startTime},t}function timerController(e,t){var n=this,r={};function i(){var t=r.options,o=n.stopper.now(),a=n.targetTime-o;if(o>=n.targetTime)return r.$emit("timer-end"),void(t.removeOnEnd&&n.remove());var s,u,l,c,f,d,p,h="up"===t.direction?o:a;lodash.extend(r,(s=h,u=Math.floor(s/1e3),l=Math.floor(u/3600),c=u%3600,f=Math.floor(c/60),d=c%60,p=Math.ceil(d),{current:s,hours:l,minutes:f,seconds:p,milis:s%1e3})),n.timeoutId=e(i,Math.min(100,a)),r.$emit("timer-tick")}n.start=function(e){if(!lodash.isPlainObject(e))throw new Error("Timer options must be an object");(r=n.getScope()).options=lodash.defaults(e,{direction:"down",template:"normal",show:!0,removeOnEnd:!0,duration:0}),n.stopper=new t,n.targetTime=1e3*r.options.duration,r.options.show&&n.show(),i()},n.stop=function(){var t=r.options||{};r=n.getScope(),e.cancel(n.timeoutId),t.removeOnEnd&&n.remove()}}function timerDirective(e){return{controller:timerController,priority:400,link:function(t,n,r,i){var o,a='<div class="pi-timer well well-sm text-center" style="font-family: monospace;">{{minutes}}:{{zeroPad(seconds)}}</div>',s=t.$new();function u(){o&&o.remove(),o=null}i.show=function(){o=angular.element(a),n.prepend(o),e(o.contents())(s)},i.remove=u,i.getScope=function(){return s},s.zeroPad=function(e){return e<10?"0"+e:e},t.$on("$destroy",u)}}}module$2.service("QuestSequence",SequenceProvider$1),module$2.service("QuestTask",TaskProvider),module$2.service("taskParse",parseProvider),module$2.value("Logger",createLogs),module$2.value("dfltQuestLogger",dfltQuestLogger),stopperProvider.$inject=["timerNow"],timerController.$inject=["$timeout","timerStopper"],timerDirective.$inject=["$compile"],window.performance&&(nowFn=performance.now||performance.mozNow||performance.webkitNow||performance.msNow||performance.oNow);var timerNow=nowFn?function(){return nowFn.apply(performance)}:function(){return+new Date},module$9=angular.module("timer",[]);module$9.service("timerStopper",stopperProvider),module$9.directive("piTimer",timerDirective),module$9.value("timerNow",timerNow);var preloadImages=preload.bind(null,preloadImg);function preload(e,t){var n=0;function r(){n<t.length&&e(t[n++],r)}r(),r(),r(),r()}function preloadImg(e,t){var n=new Image;n.onload=t,n.onerror=t,n.src=e}var module$10=angular.module("pi.utils",[]);module$10.value("piPreloadImages",preloadImages),module$10.service("piInvoke",["$injector",function(e){var t=e.get("$rootScope");return function(n,r){var i=t.global||{};n&&e.invoke(n,null,lodash.extend(r,{global:i,current:i.current}))}}]);var buttons=angular.module("ui.bootstrap.buttons",[]).constant("buttonConfig",{activeClass:"active",toggleEvent:"click"}).controller("ButtonsController",["buttonConfig",function(e){this.activeClass=e.activeClass||"active",this.toggleEvent=e.toggleEvent||"click"}]).directive("btnRadio",function(){return{require:["btnRadio","ngModel"],controller:"ButtonsController",link:function(e,t,n,r){var i=r[0],o=r[1];o.$render=function(){t.toggleClass(i.activeClass,angular.equals(o.$modelValue,e.$eval(n.btnRadio)))},t.bind(i.toggleEvent,function(){var r=t.hasClass(i.activeClass);r&&!angular.isDefined(n.uncheckable)||e.$apply(function(){o.$setViewValue(r?null:e.$eval(n.btnRadio)),o.$render()})})}}}).directive("btnCheckbox",function(){return{require:["btnCheckbox","ngModel"],controller:"ButtonsController",link:function(e,t,n,r){var i=r[0],o=r[1];function a(){return s(n.btnCheckboxTrue,!0)}function s(t,n){var r=e.$eval(t);return angular.isDefined(r)?r:n}o.$render=function(){t.toggleClass(i.activeClass,angular.equals(o.$modelValue,a()))},t.bind(i.toggleEvent,function(){e.$apply(function(){o.$setViewValue(t.hasClass(i.activeClass)?s(n.btnCheckboxFalse,!1):a()),o.$render()})})}}}),template='<div class="modal in minno-modal" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">\n\t<div class="modal-dialog">\n\t\t<div class="modal-content">\n\t\t\t<div class="modal-header" ng-ifs="header">\n\t\t\t\t<button type="button" class="close" data-dismiss="modal" aria-label="Close" ng-click="close()"><span aria-hidden="true">&times;</span></button>\n\t\t\t\t<h4 class="modal-title" id="myModalLabel">{{ header || "Heads Up!" }}</h4>\n\t\t\t</div>\n\t\t\t<div class="modal-body">{{body}}</div>\n\t\t\t<div class="modal-footer">\n\t\t\t\t<button type="button" class="btn btn-default" ng-click="close()">{{button || "Close"}}</button>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n';function modalConstructor(e,t,n,r,i){var o,a,s,u=angular.element('<div class="modal-backdrop in"/>');function l(){o&&o.remove(),a&&a.$destroy(),s&&s.resolve(),u.remove(),i.off("keydown",l),t.removeClass("modal-open")}this.open=function(c){var f=c.context||{};return l(),s=r.defer(),(a=(c.$scope||e).$new()).close=l,i.on("keydown",l),a.header=lodash.template(c.header)(f),a.body=lodash.template(c.body)(f),a.button=lodash.template(c.button)(f),o=angular.element(template),t.addClass("modal-open"),t.prepend(u),t.prepend(o),n(o.contents())(a),a.$digest(),s.promise},this.close=l}modalConstructor.$inject=["$rootScope","$rootElement","$compile","$q","$document"];var module$11=angular.module("pi.modal",[]);function questController$1(e,t,n,r,i,o,a,s){var u,l,c=this,f={dflt:NaN,data:e.data};this.scope=e,this.stopper=new t,this.registerModel=function(t,a){a=lodash.defaults(a||{},f),l=a.data;var d=n(r.ngModel),p=l.hasOwnProperty("dflt")?l.dflt:a.dflt;e.model=t,u=d(e.$parent),lodash.isUndefined(u)?(u={},d.assign(e.$parent,u)):i({type:"warn",message:'This question has already been in use: "'+u.name+'"',context:u,tags:["question"]});l.name||i({type:"warn",message:"There is a question without a name! I'd tell you what it is, but it has no name!",tags:["question"],context:l});c.log=t.$modelValue=u,lodash.defaults(u,{name:l.name,response:p,serial:s()}),e.response=t.$viewValue=u.response,t.$formatters.push(function(e){return e.response}),t.$parsers.push(function(e){var t=c.stopper.now();return u.response=e,u.latency=t,u.pristineLatency||(u.pristineLatency=t),u}),e.$watch("response",function(e,n){lodash.isEqual(e,n)||(t.$setViewValue(e),o(l.onChange,{log:u}))}),e.$on("$destroy",function(){o(l.onDestroy,{log:u})}),l.correct&&(t.$parsers.push(h),l.response=h(this.log));function h(e){var n=e.response,r=l.correctValue;return lodash.isNumber(r)&&(r+=""),lodash.isNumber(n)&&(n+=""),lodash.isEqual(r,n)?t.$setValidity("correct",!0):t.$setValidity("correct",!1),e}o(l.onCreate,{log:u})},e.$on("quest:submit",function(e){e.preventDefault(),u.declined=void 0,u.submitLatency=c.stopper.now(),o(l.onSubmit,{log:u})}),e.$on("quest:decline",function(e){e.preventDefault(),u.declined=!0,u.submitLatency=c.stopper.now(),o(l.onDecline,{log:u})}),e.$on("quest:timeout",function(e){e.preventDefault(),u.timeout=!0,o(l.onTimeout,{log:u})})}function guidFactory(){var e=0;return function(){return e++}}module$11.service("piModal",modalConstructor),questController$1.$inject=["$scope","timerStopper","$parse","$attrs","piConsole","piInvoke","$rootScope","questGuid"];var template$1="<div piq-page></div>",jqLite=angular.element;function piQuestCtrl(e,t,n,r,i,o){var a,s=new n(e.script),u=t.global,l=t.current||{};this.task=s,this.timerSetup=function(t){var n=lodash.get(e,"script.settings.timer");if(!n)return;t.start(n),t.getScope().$on("timer-end",function(){var e=n.message;function t(){s.end()}e?(lodash.isString(e)&&(e={body:e}),lodash.defaults(e,{header:"Timer Done",$context:a}),o.open(e).then(t)):t()}),e.$on("$destroy",lodash.bind(t.stop,t))},l.questions||(l.questions={}),a={global:u,current:l,questions:l.questions},lodash.extend(r,a),lodash.extend(i,a),s.next(),e.$on("quest:next",function(t,n){s.next(n),e.$emit("quest:newPage")}),e.$on("quest:prev",function(t,n){s.prev(n),e.$emit("quest:newPage")}),e.$on("quest:log",function(t,n,r){s.log(n,r,e.global)})}function directive(e,t,n,r){return{controller:piQuestCtrl,terminal:!0,replace:!0,template:"<div pi-timer></div>",require:["piQuest","piTimer"],link:function(i,o,a,s){var u,l,c,f=s[0],d=f.task,p=s[1];function h(){c&&(c.remove(),c=null),u&&(u.$destroy(),u=null),l&&(t.leave(l,function(){c=null}),c=l,l=null)}function m(){var a=d.current();if(a){var s=i.$new(),c=jqLite(template$1);s.page=a,function(e,t){if(!t)return;var i=t.split(" ");lodash.each(i,function(e){n.has("."+e+"-animation")||r({type:"error",message:'Unknown animation type: "'+e+'"',tags:["page","animation"]})}),e.addClass(t)}(c,a.animate),h(),l=e(c)(s),t.enter(l,o),(u=s).$emit("quest:updated")}else h()}f.timerSetup(p),i.$on("quest:refresh",function(){u.page=d.current()}),i.$on("quest:newPage",m),m()}}}piQuestCtrl.$inject=["$scope","$rootScope","QuestTask","templateDefaultContext","mixerDefaultContext","piModal"],directive.$inject=["$compile","$animate","$injector","piConsole"];var template$2='<div ng-form name="pageForm" pi-timer>\n\t<h3 ng-if="page.header" ng-bind-html="page.header" ng-style="page.headerStyle"></h3>\n\t<div pi-timer="page.timer"></div>\n\t<div ng-if="page.progressBar" class="text-center" ng-bind-html="page.progressBar"></div>\n\n\t<div ng-bind-html="page.text"></div>\n\t<ol ng-class="{\'list-unstyled\':!page.numbered}" start="{{page.numberStart}}">\n\t\t<li ng-repeat="quest in page.questions">\n\t\t\t<div quest-wrapper quest-data="quest" quest-current="current"></div>\n\t\t</li>\n\t</ol>\n\n\t<div pi-quest-validation="pageForm.$error.pageValidation" pi-post-submit="submitAttempt">{{page.pageValidationText || \'Invalid page\'}}</div>\n\n\t<div class="page-buttons">\n\t\t<button\n\t\t\tng-click="prev()"\n\t\t\tclass="btn page-prev"\n\t\t\tng-if="page.prev && page.$meta.number > 1"\n\t\t>{{page.prevText || "Go Back"}}</button>\n\n\t\t<button\n\t\t\tng-click="decline($event)"\n\t\t\tclass="btn page-decline"\n\t\t\tng-if="page.decline"\n\t\t>{{page.declineText || "Decline"}}</button>\n\n\t\t<button\n\t\t\tng-click="submit()"\n\t\t\tclass="btn page-submit"\n\t\t\tng-if="!page.noSubmit"\n\t\t>{{page.submitText || "Submit"}}</button>\n\t</div>\n</div>\n';function piqPageCtrl(e,t,n,r){var i=this;e.global=n.global,e.current=n.current,this.harvest=function(t){var n=e.current.questions;lodash.each(e.page.questions,function(r){if(r.name&&(t||r.lognow)){var o=n[r.name];o.$logged||(e.$emit("quest:log",o,i.log),o.$logged=!0)}})},e.submit=function(t){var n=e.pageForm.$valid;if(e.submitAttempt=!0,!n&&!0!==t)return!0;e.$broadcast("quest:submit"),i.proceed(),e.$emit("quest:next")},e.decline=function(t){var n=angular.element(t.target);"double"!==this.page.decline||n.hasClass("active")?(e.$broadcast("quest:decline"),i.proceed(),e.$emit("quest:next")):n.addClass("active")},e.prev=function(){i.proceed(),e.$emit("quest:prev")},this.proceed=function(){i.timer.stop(),i.harvest(e.page.lognow)},this.setup=function(t){var o=e.page;i.timer=t,i.log={name:o.name,startTime:+new Date},o.timer&&(t.start(o.timer),t.getScope().$on("timer-end",function(){var t,s=o.timer.message;i.log.timeout=!0,e.$broadcast("quest:timeout"),s?(t={pagesMeta:o.$meta,pagesData:o.data,global:n.global,current:n.current},lodash.isString(s)&&(s={body:s}),lodash.defaults(s,{header:"Timer Done",$context:t,$scope:e}),r.open(s).then(a)):a()}));function a(){var t=o.timer.submitOnEnd||lodash.isUndefined(o.timer.submitOnEnd);t&&e.submit(!0)}},e.$watch("current.questions",function(){e.$emit("quest:refresh")},!0),e.$on("quest:submit:now",function(){e.submit()})}function directive$1(e){return{replace:!0,controller:piqPageCtrl,template:template$2,require:["piqPage","piTimer"],link:function(t,n,r,i){var o=t.page;e.scrollTo(0,0),i[0].setup(i[1]),lodash.isFunction(o.pageValidation)&&t.$watch(function(){t.pageForm.$setValidity("pageValidation",o.pageValidation(o,t.current))})}}}piqPageCtrl.$inject=["$scope","$timeout","$rootScope","piModal"],directive$1.$inject=["$window"];var template$3='<div class="form-group" ng-form="questForm">\n\t<label ng-hide="data.inline" for="{{data.name}}" ng-bind-html="data.stem" ng-style="data.stemCss"></label>\n\t<div ng-bind-html="data.description"></div>\n\t<div quest-data="data" ng-model="current.questions[data.name]" ng-style="{\'max-width\':data.maxWidth}"></div>\n\t<p class="help-block" ng-if="data.help" ng-bind-html="data.helpText"></p>\n</div>\n',PREFIX="quest";function capitaliseFirstLetter(e){return e.charAt(0).toUpperCase()+e.slice(1)}function directive$2(e,t){return{replace:!0,template:template$3,priority:5,scope:{data:"=questData",current:"=questCurrent"},link:function(n,r){var i=n.data.type||"text",o=r.children().eq(2),a=PREFIX+capitaliseFirstLetter(i);if(!t.has(a+"Directive"))throw new Error('Unknown question type: "'+i+'"');a=lodash.kebabCase(a),o.attr(a,!0),e(o)(n)}}}directive$2.$inject=["$compile","$injector"];var textTemplate='<div ng-form ng-class="{\'form-inline\':data.inline}">\n\t<label ng-show="data.inline" for="{{data.name}}" ng-bind-html="data.stem" ng-style="data.stemCss"></label>\n\t<input\n\t \ttype="text"\n\t\tng-model="response"\n\t\tng-minlength="{{data.minLength || data.minlength}}"\n\t\tng-maxlength="{{data.maxlength}}"\n\t\tng-pattern="data.pattern | toRegex"\n\t\tng-required="{{data.required}}"\n\t\tclass="form-control"\n\t\tng-attr-style="width:{{data.width | dfltUnits}}"\n\n\t\tng-keydown="data.maxlengthLimit && maxlengthLimit($event)"\n\t\tng-keyup="data.maxlengthLimit && maxlengthLimit($event)"\n\t/>\n\t<div pi-quest-validation="form.$error.minlength">{{data.errorMsg.minLength || data.errorMsg.minlength || "Too short!"}}</div>\n\t<div pi-quest-validation="form.$error.maxlength">{{data.errorMsg.maxlength || "Too long!"}}</div>\n\t<div pi-quest-validation="form.$error.pattern">{{data.errorMsg.pattern || "wrong pattern!"}}</div>\n\t<div pi-quest-validation="form.$error.required">{{data.errorMsg.required || "Please respond to this question"}}</div>\n\t<div pi-quest-validation="model.$error.correct">{{data.errorMsg.correct || "You must answer the correct answer!"}}</div>\n</div>',textareaTemplate='<div ng-form ng-class="{\'form-inline\':data.inline}">\n\t<label ng-show="data.inline" for="{{data.name}}" ng-bind-html="data.stem" ng-style="data.stemCss"></label>\n\t<textarea\n\t \ttype="text"\n\t\tng-model="response"\n\t\tng-minlength="{{data.minLength || data.minlength}}"\n\t\tng-maxlength="{{data.maxlength}}"\n\t\tng-pattern="data.pattern | toRegex"\n\t\tng-required="{{data.required}}"\n\t\tclass="form-control"\n\n\t\tng-attr-style="resize:none;width:{{data.columns? \'auto\' : data.width | dfltUnits}};"\n\t\tcols="{{data.columns}}"\n\t\trows="{{data.rows}}"\n\n\t\tng-keydown="data.maxlengthLimit && maxlengthLimit($event)"\n\t\tng-keyup="data.maxlengthLimit && maxlengthLimit($event)"\n\t/>\n\t<div pi-quest-validation="form.$error.minlength">{{data.errorMsg.minLength || data.errorMsg.minlength || "Too short!"}}</div>\n\t<div pi-quest-validation="form.$error.maxlength">{{data.errorMsg.maxlength || "Too long!"}}</div>\n\t<div pi-quest-validation="form.$error.pattern">{{data.errorMsg.pattern || "wrong pattern!"}}</div>\n\t<div pi-quest-validation="form.$error.required">{{data.errorMsg.required || "Please respond to this question"}}</div>\n\t<div pi-quest-validation="model.$error.correct">{{data.errorMsg.correct || "You must answer the correct answer!"}}</div>\n</div>';function textDirective(){return{replace:!0,template:function(e,t){return"questText"in t?textTemplate:textareaTemplate},require:["form","ngModel"],controller:"questController",controllerAs:"ctrl",scope:{data:"=questData"},link:function(e,t,n,r){var i=r[0],o=r[1],a=e.ctrl,s=e.data;e.form=i,e.maxlengthLimit=function(t){var n=angular.element(t.target).val(),r=s.maxlength||n.length;e.response=n.slice(0,r)},a.registerModel(o,{dflt:""}),s.autoSubmit&&t.bind("keydown keypress",function(t){13===t.which&&(e.$apply(function(){e.$emit("quest:submit:now")}),t.preventDefault())})}}}var template$4='<div ng-form ng-class="{\'form-inline\':data.inline}">\n\t<label ng-show="data.inline" for="{{data.name}}" ng-bind-html="data.stem" ng-style="data.stemCss"></label>\n\t<input\n\t \ttype="number"\n\t\tng-model="response"\n\t\tng-required="{{data.required}}"\n\t\tclass="form-control"\n\t\tng-attr-style="width:{{data.width | dfltUnits}}"\n\t>\n\t<div pi-quest-validation="form.$error.number">{{data.errorMsg.number || "Must be a number!"}}</div>\n\t<div pi-quest-validation="form.$error.qstMin">{{data.errorMsg.min || "Too small!"}}</div>\n\t<div pi-quest-validation="form.$error.qstMax">{{data.errorMsg.max || "Too big!"}}</div>\n\t<div pi-quest-validation="form.$error.required">{{data.errorMsg.required || "Please respond to this question"}}</div>\n\t<div pi-quest-validation="model.$error.correct">{{data.errorMsg.correct || "You must answer the correct answer!"}}</div>\n</div>',directive$3=function(){return{replace:!0,template:template$4,require:["form","ngModel","^?piqPage"],controller:"questController",controllerAs:"ctrl",scope:{data:"=questData"},link:function(e,t,n,r){var i=r[0],o=t.find("input").eq(0).controller("ngModel");e.form=i,e.ctrl.registerModel(r[1],{dflt:""}),e.data.autoSubmit&&t.bind("keydown keypress",function(t){13===t.which&&(e.$apply(function(){e.$emit("quest:submit:now")}),t.preventDefault())});var a=function(t){var n=parseFloat(e.data.min);return!isNaN(n)&&t<n?void o.$setValidity("qstMin",!1):(o.$setValidity("qstMin",!0),t)};o.$parsers.push(a),o.$formatters.push(a);var s=function(t){var n=parseFloat(e.data.max);return!isNaN(n)&&t>n?void o.$setValidity("qstMax",!1):(o.$setValidity("qstMax",!0),t)};o.$parsers.push(s),o.$formatters.push(s)}}};function selectMixerProvider(e,t){return function(n,r){var i=t(n);return i=lodash.map(i,function(e,t){return lodash.isPlainObject(e)||(e={text:e}),lodash.isUndefined(e.value)&&(e.value=r.numericValues?t+1:e.text),e}),r.reverse&&(i=lodash(i).reverse().value()),r.randomize&&(i=e(i)),lodash.each(i,function(e,t){e.order=t}),i}}selectMixerProvider.$inject=["randomizeShuffle","mixerRecursive"];var template$5='<div ng-form>\n\t<select\n\t\tng-model="response"\n\t\tng-options="answer.value as answer.text group by answer.group for answer in quest.answers"\n\t\tng-required="data.required"\n\t\tng-change="data.autoSubmit && autoSubmit($event)"\n\t\tclass="form-control"\n\t\t>\n\t\t<option value="">{{chooseText || "-- Choose an option --"}}</option>\n\t</select>\n\t<div pi-quest-validation="form.$error.required">{{data.errorMsg.required || "Please respond to this question"}}</div>\n\t<div pi-quest-validation="model.$error.correct">{{data.errorMsg.correct || "You must answer the correct answer!"}}</div>\n</div>';function directive$4(e,t){return{replace:!0,template:template$5,require:["ngModel","form"],controller:"questController",controllerAs:"ctrl",scope:{data:"=questData"},link:function(n,r,i,o){var a=o[0],s=n.ctrl;n.form=o[1],s.registerModel(a,{dflt:NaN}),n.quest={answers:e(n.data.answers||[],n.data)},n.chooseText="chooseText"in n.data&&n.data.chooseText,n.autoSubmit=function(){t(function(){n.$emit("quest:submit:now")})}}}}directive$4.$inject=["questSelectMixer","$timeout"];var template$6='<div>\n\t<div ng-class="listClass" ng-style="listCss">\n\t\t\x3c!-- track by in the ng-repeat allows us to keep the repeated object clean so that angular doesn\'t add a $$hashkey property --\x3e\n\t\t\x3c!-- using interpolation within class, so that we can keep the style info separate within the directive --\x3e\n\t\t<a\n\t\t\ttabindex="-1"\n\t\t\tng-repeat="answer in quest.answers track by answer.order"\n\t\t\tng-model="$parent.responseObj"\n\t\t\tbtn-radio="answer"\n\t\t\tng-class="$parent.listItemClass"\n\t\t\tng-style="listItemCss"\n\t\t\tclass="{{ $parent.response == answer.value ? \'active\' : \'\' }}"\n\t\t\tuncheckable\n\t\t\tng-click="data.autoSubmit && autoSubmit($event)"\n\t\t\tng-bind-html="answer.text"\n\t\t\tunselectable="on"\n\t\t></a>\n\t</div>\n\t<div pi-quest-validation="model.$error.required">{{data.errorMsg.required || "Please respond to this question"}}</div>\n\t<div pi-quest-validation="model.$error.correct">{{data.errorMsg.correct || "You must answer the correct answer!"}}</div>\n</div>';function directive$5(e,t,n){return{replace:!0,require:["ngModel"],controller:"questController",controllerAs:"ctrl",scope:{data:"=questData"},link:function(r,i,o,a){var s=a[0],u=r.ctrl,l=r.data;switch(i.html(template$6),n(i.contents())(r),u.registerModel(s,{dflt:NaN}),r.quest={answers:e(r.data.answers||[],r.data)},r.$watch("responseObj",function(e,t){e!==t&&(r.response=e&&e.value)}),r.data.required&&(s.$formatters.push(c),s.$parsers.unshift(c),c(r.response)),r.data.buttons?r.data.style="horizontal":"horizontal"==r.data.style&&(r.data.buttons=!0),r.listCss={},r.listItemCss={},l.style){case"horizontal":r.listClass="btn-group btn-group-justified btn-group-lg",r.listItemClass="btn btn-select";break;case"multiButtons":r.listClass="btn-toolbar",r.listItemClass="btn  btn-select",r.listCss.lineHeight=2.8;break;case"list":default:r.listClass="list-group",r.listItemClass="list-group-item"}function c(e){var t=s;return t.$isEmpty(e)?void t.$setValidity("required",!1):(t.$setValidity("required",!0),e)}l.minWidth&&(r.listItemCss.minWidth=l.minWidth),r.autoSubmit=function(e){r.data.autoSubmit&&(angular.element(e.currentTarget).hasClass(t.activeClass)&&r.$emit("quest:submit:now"))}}}}directive$5.$inject=["questSelectMixer","buttonConfig","$compile"];var template$7='<div>\n\t<div ng-class="listClass" ng-style="listCss">\n\t\t\x3c!-- track by in the ng-repeat allows us to keep the repeated object clean so that angular doesn\'t add a $$hashkey property --\x3e\n\t\t<a\n\t\t\thref="javascript:void(0);"\n\t\t\tng-repeat="answer in quest.answers track by answer.order"\n\t\t\tng-model="answer.chosen"\n\t\t\tbtn-checkbox\n\t\t\tng-class="$parent.listItemClass"\n\t\t\tng-style="listItemCss"\n\t\t\tclass="{{ answer.chosen ? \'active\' : \'\' }}"\n\t\t\tuncheckable\n\t\t\tng-bind-html="answer.text"\n\t\t\tunselectable="on"\n\t\t>\n\t\t</a>\n\t</div>\n\t<div pi-quest-validation="model.$error.required">{{data.errorMsg.required || "Please respond to this question"}}</div>\n\t<div pi-quest-validation="model.$error.correct">{{data.errorMsg.correct || "You must answer the correct answer!"}}</div>\n</div>';function directive$6(e){return{replace:!0,template:template$7,require:["^?piqPage","ngModel"],controller:"questController",controllerAs:"ctrl",scope:{data:"=questData"},link:function(t,n,r,i){var o=t.ctrl,a=i[1],s=t.data;switch(o.registerModel(a,{dflt:[]}),a.$isEmpty=function(){return lodash.isEmpty(a.$viewValue)},t.quest={answers:e(t.data.answers||[],t.data)},lodash.each(t.quest.answers,function(e){~lodash.indexOf(t.response,e.value)&&(e.chosen=!0)}),t.data.buttons?t.data.style="horizontal":"horizontal"==t.data.style&&(t.data.buttons=!0),t.listCss={},t.listItemCss={},s.style){case"horizontal":t.listClass="btn-group btn-group-justified btn-group-lg",t.listItemClass="btn btn-select";break;case"multiButtons":t.listClass="btn-toolbar",t.listItemClass="btn  btn-select",t.listCss.lineHeight=2.8;break;case"list":default:t.listClass="list-group",t.listItemClass="list-group-item"}function u(e){return a.$setValidity("required",!a.$isEmpty(e)),e}s.minWidth&&(t.listItemCss.minWidth=s.minWidth),s.required&&(a.$parsers.unshift(u),u(a.$viewValue)),t.$watch("quest.answers",function(e,n){e!==n&&(t.response=lodash(e).filter(function(e){return e.chosen}).pluck("value").value())},!0)}}}directive$6.$inject=["questSelectMixer"];var atoa=function(e,t){return Array.prototype.slice.call(e,t)},si="function"==typeof setImmediate,tick;tick=si?function(e){setImmediate(e)}:"undefined"!=typeof process&&process.nextTick?process.nextTick:function(e){setTimeout(e,0)};var ticky=tick,debounce=function(e,t,n){e&&ticky(function(){e.apply(n||null,t||[])})},emitter=function(e,t){var n=t||{},r={};return void 0===e&&(e={}),e.on=function(t,n){return r[t]?r[t].push(n):r[t]=[n],e},e.once=function(t,n){return n._once=!0,e.on(t,n),e},e.off=function(t,n){var i=arguments.length;if(1===i)delete r[t];else if(0===i)r={};else{var o=r[t];if(!o)return e;o.splice(o.indexOf(n),1)}return e},e.emit=function(){var t=atoa(arguments);return e.emitterSnapshot(t.shift()).apply(this,t)},e.emitterSnapshot=function(t){var i=(r[t]||[]).slice(0);return function(){var r=atoa(arguments),o=this||e;if("error"===t&&!1!==n.throws&&!i.length)throw 1===r.length?r[0]:r;return i.forEach(function(i){n.async?debounce(i,r,o):i.apply(o,r),i._once&&e.off(t,i)}),e}},e},NativeCustomEvent=commonjsGlobal.CustomEvent;function useNative(){try{var e=new NativeCustomEvent("cat",{detail:{foo:"bar"}});return"cat"===e.type&&"bar"===e.detail.foo}catch(e){}return!1}var customEvent=useNative()?NativeCustomEvent:"function"==typeof document.createEvent?function(e,t){var n=document.createEvent("CustomEvent");return t?n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail):n.initCustomEvent(e,!1,!1,void 0),n}:function(e,t){var n=document.createEventObject();return n.type=e,t?(n.bubbles=Boolean(t.bubbles),n.cancelable=Boolean(t.cancelable),n.detail=t.detail):(n.bubbles=!1,n.cancelable=!1,n.detail=void 0),n},eventmap=[],eventname="",ron=/^on/;for(eventname in commonjsGlobal)ron.test(eventname)&&eventmap.push(eventname.slice(2));var eventmap_1=eventmap,doc$1=commonjsGlobal.document,addEvent=addEventEasy,removeEvent=removeEventEasy,hardCache=[];commonjsGlobal.addEventListener||(addEvent=addEventHard,removeEvent=removeEventHard);var crossvent={add:addEvent,remove:removeEvent,fabricate:fabricateEvent};function addEventEasy(e,t,n,r){return e.addEventListener(t,n,r)}function addEventHard(e,t,n){return e.attachEvent("on"+t,wrap(e,t,n))}function removeEventEasy(e,t,n,r){return e.removeEventListener(t,n,r)}function removeEventHard(e,t,n){var r=unwrap(e,t,n);if(r)return e.detachEvent("on"+t,r)}function fabricateEvent(e,t,n){var r=-1===eventmap_1.indexOf(t)?new customEvent(t,{detail:n}):function(){var e;doc$1.createEvent?(e=doc$1.createEvent("Event")).initEvent(t,!0,!0):doc$1.createEventObject&&(e=doc$1.createEventObject());return e}();e.dispatchEvent?e.dispatchEvent(r):e.fireEvent("on"+t,r)}function wrapperFactory(e,t,n){return function(t){var r=t||commonjsGlobal.event;r.target=r.target||r.srcElement,r.preventDefault=r.preventDefault||function(){r.returnValue=!1},r.stopPropagation=r.stopPropagation||function(){r.cancelBubble=!0},r.which=r.which||r.keyCode,n.call(e,r)}}function wrap(e,t,n){var r=unwrap(e,t,n)||wrapperFactory(e,t,n);return hardCache.push({wrapper:r,element:e,type:t,fn:n}),r}function unwrap(e,t,n){var r=find(e,t,n);if(r){var i=hardCache[r].wrapper;return hardCache.splice(r,1),i}}function find(e,t,n){var r,i;for(r=0;r<hardCache.length;r++)if((i=hardCache[r]).element===e&&i.type===t&&i.fn===n)return r}var cache={},start="(?:^|\\s)",end="(?:\\s|$)";function lookupClass(e){var t=cache[e];return t?t.lastIndex=0:cache[e]=t=new RegExp(start+e+end,"g"),t}function addClass(e,t){var n=e.className;n.length?lookupClass(t).test(n)||(e.className+=" "+t):e.className=t}function rmClass(e,t){e.className=e.className.replace(lookupClass(t)," ").trim()}var classes={add:addClass,rm:rmClass},doc=document,documentElement=doc.documentElement;function dragula(e,t){var n,r,i,o,a,s,u,l,c,f,d;1===arguments.length&&!1===Array.isArray(e)&&(t=e,e=[]);var p,h=null,m=t||{};void 0===m.moves&&(m.moves=always),void 0===m.accepts&&(m.accepts=always),void 0===m.invalid&&(m.invalid=function(){return!1}),void 0===m.containers&&(m.containers=e||[]),void 0===m.isContainer&&(m.isContainer=never),void 0===m.copy&&(m.copy=!1),void 0===m.copySortSource&&(m.copySortSource=!1),void 0===m.revertOnSpill&&(m.revertOnSpill=!1),void 0===m.removeOnSpill&&(m.removeOnSpill=!1),void 0===m.direction&&(m.direction="vertical"),void 0===m.ignoreInputTextSelection&&(m.ignoreInputTextSelection=!0),void 0===m.mirrorContainer&&(m.mirrorContainer=doc.body);var v=emitter({containers:m.containers,start:function(e){var t=S(e);t&&E(t)},end:q,cancel:M,remove:P,destroy:function(){$(!0),_({})},canMove:function(e){return!!S(e)},dragging:!1});return!0===m.removeOnSpill&&v.on("over",function(e){classes.rm(e,"gu-hide")}).on("out",function(e){v.dragging&&classes.add(e,"gu-hide")}),$(),v;function g(e){return-1!==v.containers.indexOf(e)||m.isContainer(e)}function $(e){var t=e?"remove":"add";touchy(documentElement,t,"mousedown",x),touchy(documentElement,t,"mouseup",_)}function y(e){touchy(documentElement,e?"remove":"add","mousemove",C)}function w(e){var t=e?"remove":"add";crossvent[t](documentElement,"selectstart",b),crossvent[t](documentElement,"click",b)}function b(e){p&&e.preventDefault()}function x(e){if(s=e.clientX,u=e.clientY,!(1!==whichMouseButton(e)||e.metaKey||e.ctrlKey)){var t=e.target,n=S(t);n&&(p=n,y(),"mousedown"===e.type&&(isInput(t)?t.focus():e.preventDefault()))}}function C(e){if(p)if(0!==whichMouseButton(e)){if(void 0===e.clientX||e.clientX!==s||void 0===e.clientY||e.clientY!==u){if(m.ignoreInputTextSelection){var t=getCoord("clientX",e),r=getCoord("clientY",e);if(isInput(doc.elementFromPoint(t,r)))return}var l=p;y(!0),w(),q(),E(l);var c=getOffset(i);o=getCoord("pageX",e)-c.left,a=getCoord("pageY",e)-c.top,classes.add(f||i,"gu-transit"),function(){if(n)return;var e=i.getBoundingClientRect();(n=i.cloneNode(!0)).style.width=getRectWidth(e)+"px",n.style.height=getRectHeight(e)+"px",classes.rm(n,"gu-transit"),classes.add(n,"gu-mirror"),m.mirrorContainer.appendChild(n),touchy(documentElement,"add","mousemove",O),classes.add(m.mirrorContainer,"gu-unselectable"),v.emit("cloned",n,i,"mirror")}(),O(e)}}else _({})}function S(e){if(!(v.dragging&&n||g(e))){for(var t=e;getParent(e)&&!1===g(getParent(e));){if(m.invalid(e,t))return;if(!(e=getParent(e)))return}var r=getParent(e);if(r)if(!m.invalid(e,t))if(m.moves(e,r,t,nextEl(e)))return{item:e,source:r}}}function E(e){var t,n;t=e.item,n=e.source,("boolean"==typeof m.copy?m.copy:m.copy(t,n))&&(f=e.item.cloneNode(!0),v.emit("cloned",f,e.item,"copy")),r=e.source,i=e.item,l=c=nextEl(e.item),v.dragging=!0,v.emit("drag",i,r)}function q(){if(v.dragging){var e=f||i;A(e,getParent(e))}}function k(){p=!1,y(!0),w(!0)}function _(e){if(k(),v.dragging){var t=f||i,o=getCoord("clientX",e),a=getCoord("clientY",e),s=D(getElementBehindPoint(n,o,a),o,a);s&&(f&&m.copySortSource||!f||s!==r)?A(t,s):m.removeOnSpill?P():M()}}function A(e,t){var n=getParent(e);f&&m.copySortSource&&t===r&&n.removeChild(i),j(t)?v.emit("cancel",e,r,r):v.emit("drop",e,t,r,c),T()}function P(){if(v.dragging){var e=f||i,t=getParent(e);t&&t.removeChild(e),v.emit(f?"cancel":"remove",e,t,r),T()}}function M(e){if(v.dragging){var t=arguments.length>0?e:m.revertOnSpill,n=f||i,o=getParent(n),a=j(o);!1===a&&t&&(f?o&&o.removeChild(f):r.insertBefore(n,l)),a||t?v.emit("cancel",n,r,r):v.emit("drop",n,o,r,c),T()}}function T(){var e=f||i;k(),n&&(classes.rm(m.mirrorContainer,"gu-unselectable"),touchy(documentElement,"remove","mousemove",O),getParent(n).removeChild(n),n=null),e&&classes.rm(e,"gu-transit"),d&&clearTimeout(d),v.dragging=!1,h&&v.emit("out",e,h,r),v.emit("dragend",e),r=i=f=l=c=d=h=null}function j(e,t){var o;return o=void 0!==t?t:n?c:nextEl(f||i),e===r&&o===l}function D(e,t,n){for(var o=e;o&&!a();)o=getParent(o);return o;function a(){if(!1===g(o))return!1;var a=R(o,e),s=N(o,a,t,n);return!!j(o,s)||m.accepts(i,o,r,s)}}function O(e){if(n){e.preventDefault();var t=getCoord("clientX",e),s=getCoord("clientY",e),u=t-o,d=s-a;n.style.left=u+"px",n.style.top=d+"px";var p=f||i,g=getElementBehindPoint(n,t,s),$=D(g,t,s),y=null!==$&&$!==h;(y||null===$)&&(h&&C("out"),h=$,y&&C("over"));var w=getParent(p);if($!==r||!f||m.copySortSource){var b,x=R($,g);if(null!==x)b=N($,x,t,s);else{if(!0!==m.revertOnSpill||f)return void(f&&w&&w.removeChild(p));b=l,$=r}(null===b&&y||b!==p&&b!==nextEl(p))&&(c=b,$.insertBefore(p,b),v.emit("shadow",p,$,r))}else w&&w.removeChild(p)}function C(e){v.emit(e,p,h,r)}}function R(e,t){for(var n=t;n!==e&&getParent(n)!==e;)n=getParent(n);return n===documentElement?null:n}function N(e,t,n,r){var i="horizontal"===m.direction;return t!==e?function(){var e=t.getBoundingClientRect();if(i)return o(n>e.left+getRectWidth(e)/2);return o(r>e.top+getRectHeight(e)/2)}():function(){var t,o,a,s=e.children.length;for(t=0;t<s;t++){if(o=e.children[t],a=o.getBoundingClientRect(),i&&a.left+a.width/2>n)return o;if(!i&&a.top+a.height/2>r)return o}return null}();function o(e){return e?nextEl(t):t}}}function touchy(e,t,n,r){commonjsGlobal.navigator.pointerEnabled?crossvent[t](e,{mouseup:"pointerup",mousedown:"pointerdown",mousemove:"pointermove"}[n],r):commonjsGlobal.navigator.msPointerEnabled?crossvent[t](e,{mouseup:"MSPointerUp",mousedown:"MSPointerDown",mousemove:"MSPointerMove"}[n],r):(crossvent[t](e,{mouseup:"touchend",mousedown:"touchstart",mousemove:"touchmove"}[n],r),crossvent[t](e,n,r))}function whichMouseButton(e){if(void 0!==e.touches)return e.touches.length;if(void 0!==e.which&&0!==e.which)return e.which;if(void 0!==e.buttons)return e.buttons;var t=e.button;return void 0!==t?1&t?1:2&t?3:4&t?2:0:void 0}function getOffset(e){var t=e.getBoundingClientRect();return{left:t.left+getScroll("scrollLeft","pageXOffset"),top:t.top+getScroll("scrollTop","pageYOffset")}}function getScroll(e,t){return void 0!==commonjsGlobal[t]?commonjsGlobal[t]:documentElement.clientHeight?documentElement[e]:doc.body[e]}function getElementBehindPoint(e,t,n){var r,i=e||{},o=i.className;return i.className+=" gu-hide",r=doc.elementFromPoint(t,n),i.className=o,r}function never(){return!1}function always(){return!0}function getRectWidth(e){return e.width||e.right-e.left}function getRectHeight(e){return e.height||e.bottom-e.top}function getParent(e){return e.parentNode===doc?null:e.parentNode}function isInput(e){return"INPUT"===e.tagName||"TEXTAREA"===e.tagName||"SELECT"===e.tagName||isEditable(e)}function isEditable(e){return!!e&&("false"!==e.contentEditable&&("true"===e.contentEditable||isEditable(getParent(e))))}function nextEl(e){return e.nextElementSibling||function(){var t=e;for(;t=t.nextSibling,t&&1!==t.nodeType;);return t}()}function getEventHost(e){return e.targetTouches&&e.targetTouches.length?e.targetTouches[0]:e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:e}function getCoord(e,t){var n=getEventHost(t),r={pageX:"clientX",pageY:"clientY"};return e in r&&!(e in n)&&r[e]in n&&(e=r[e]),n[e]}var dragula_1=dragula,template$8='<div>\n    <div class="list-group" dragula-container>\n        <a href="javascript:void(0)" class="list-group-item" ng-repeat="row in list track by row.id">\n            <div class="row">\n                <div class="col-xs-1">\n                    <select ng-init="setupWatch(this)" ng-model="selected" ng-change="$parent.move(row.order, selected, this)">\n                        <option ng-repeat="r in list" ng-selected="r.order === row.order" label="{{r.order+1}}" value="{{r.order}}">{{r.order+1}}</option>\n                    </select>\n                </div>\n                <div class="col-xs-11"> {{row.text}} </div>\n            </div>\n        </a>\n    </div>\n\t<div pi-quest-validation="model.$error.required">{{data.errorMsg.required || "Please respond to this question"}}</div>\n\t<div pi-quest-validation="model.$error.correct">{{data.errorMsg.correct || "You must answer the correct answer!"}}</div>\n</div>\n';function directive$7(){return{replace:!0,require:["ngModel"],controller:"questController",controllerAs:"ctrl",template:template$8,scope:{data:"=questData"},link:function(e,t,n,r){var i=r[0],o=e.ctrl,a=e.data,s=lodash.isArray(a.list)&&a.list.length?lodash.range(1,a.list.length+1):[];o.registerModel(i,{dflt:lodash.get(a,"randomize",!0)?lodash.shuffle(s):s}),i.$isEmpty=function(e){return lodash.isEqual(e,lodash.range(1,c.length+1))};var u,l,c=e.list=o.log.response.map(function(e,t){return{order:t,id:e,text:a.list[e-1]}});e.$watchCollection("list",function(){e.response=lodash.pluck(c,"id")}),e.setupWatch=function(e){e.$watch("$parent.response",function(){e.$evalAsync("selected = row.order")})},e.reset=function(){c=e.list=lodash.sortBy(c,"id")},e.move=function(e,t){var n,r,i,o;i=t,o=(n=c)[r=e],n.splice(r,1),n.splice(i,0,o),c.forEach(function(e,t){e.order=t})};var f=dragula_1({isContainer:function(e){return e.hasAttribute("dragula-container")&&t[0].contains(e)}});function d(e,t){return Array.prototype.indexOf.call(angular.element(t).children(),e)}function p(e){var t=i;return t.$isEmpty(e)?void t.$setValidity("required",!1):(t.$setValidity("required",!0),e)}f.on("drag",function(e,t){u=d(e,t)}),f.on("drop",function(t,n){l=d(t,n),e.move(u,l),e.$digest()}),e.$on("$destroy",f.destroy),a.required&&(i.$formatters.push(p),i.$parsers.unshift(p),p(e.response))}}}directive$7.$inject=["$compile"];var grid='<div ng-form class="table-responsive" ng-class="{\'pi-page-submitted\':$parent.$parent.submitAttempt}">\n\t<table class="table table-hover">\n\t\t<colgroup>\n\t\t\t<col\n\t\t\t\tng-if="!data.rowStemHide"\n\t\t\t></col>\n\t\t\t<col\n\t\t\t\tng-repeat="column in columns"\n\t\t\t\tng-style="column.css"\n\t\t\t></col>\n\t\t</colgroup>\n\t\t<thead ng-if="!data.columnStemHide">\n\t\t\t<tr>\n\t\t\t\t<th\n\t\t\t\t\tng-style="allCss(data.columnStemCss,column.stemCss, data.rowStemCss)"\n\t\t\t\t\tng-if="!data.rowStemHide"\n\t\t\t\t></th>\n\t\t\t\t<th\n\t\t\t\t\tng-repeat="column in columns"\n\t\t\t\t\tng-bind-html="column.stem"\n\t\t\t\t\tng-style="allCss(data.columnStemCss,column.stemCss)"\n\t\t\t\t></th>\n\t\t\t</tr>\n\t\t</thead>\n\t\t<tbody>\n\t\t\t<tr\n\t\t\t\tng-repeat="row in rows"\n\t\t\t\tquest-grid-row="row"\n\t\t\t\tquest-grid-data="data"\n\t\t\t\tng-model="$parent.$parent.current.questions[row.name]"\n\t\t\t\tng-required="{{data.required || row.required}}"\n\t\t\t></tr>\n\t\t</tbody>\n\t</table>\n\t<div pi-quest-validation="form.$error.required">{{data.errorMsg.required || "Please respond to this question"}}</div>\n</div>';function gridDirective$1(e){return{replace:!0,template:grid,require:["ngModel","form"],controller:"questController",controllerAs:"ctrl",scope:{data:"=questData",current:"=questCurrent"},link:function(r,i,o,a){var s,u,l=a[0],c=r.ctrl,f=r.data;r.form=a[1],r.columns=(f.columns||[]).map(n),r.rows=(s=f.rows,u=f,lodash(s||[]).map(n).each(function(e,t){e.hasOwnProperty("name")||(e.name=u.name+function(e,t){var n=Math.abs(e),r=1+Math.floor(Math.log(n)/Math.LN10);if(r>=t)return e;var i=Math.pow(10,t-r).toString().substr(1);return e<0?"-"+i+n:i+n}(t+1,3))}).thru(u.shuffle?e:lodash.identity).value()),r.allCss=t,r.$watchCollection(function(){return lodash.pluck(r.rows,"$response")},function(e){r.response=lodash.reduce(e,function(e,t){return lodash.isFinite(t)?e+t:e},0)}),c.registerModel(l,{dflt:0})}};function t(){var e=lodash.toArray(arguments);return e.unshift({}),lodash.extend.apply(lodash,e)}function n(e){return lodash.isPlainObject(e)?e:{stem:e}}}gridDirective$1.$inject=["questShuffle"];var gridRow='<tr>\n\t<th\n\t\tscope="row"\n\t\tng-if="!data.rowStemHide"\n\t\tng-bind-html="row.stem"\n\t\tng-style="data.rowStemCss"\n\t></th>\n\t<td ng-repeat="column in columns">\n\t\t<div ng-switch="column.type">\n\t\t\t<button\n\t\t\t\tclass="btn btn-default"\n\t\t\t\tng-switch-when="checkbox"\n\t\t\t\tbtn-radio="row.reverse && !column.noReverse ? column.reverseValue : column.value"\n\t\t\t\tng-model="$parent.$parent.response"\n\t\t\t\tng-class="data.checkboxType"\n\t\t\t\tuncheckable\n\t\t\t></button>\n\t\t\t<div\n\t\t\t\tclass="text"\n\t\t\t\tng-switch-when="text"\n\t\t\t\tng-bind-html="row[column.textProperty]"\n\t\t\t></div>\n\t\t\t<div\n\t\t\t\tclass="grid-input input-group input-group-small"\n\t\t\t\tng-switch-when="input"\n                ng-init="response=\'\'"\n                title="insert your response"\n\t\t\t>\n                <span class="input-group-addon">\n                    <span class="glyphicon glyphicon-edit" ng-class="{active:$parent.$parent.response===response}"></span>\n                </span>\n                <input type="text" class="form-control" ng-model="response" ng-change="$parent.$parent.response = response">\n            </div>\n            <div ng-switch-when="dropdown" ng-init="response=\'\'"> \n                <select ng-model="response" ng-change="$parent.$parent.response = response" class="form-control">\n                    <option value="" ng-selected="response===undefined">----</option>\n                    <option ng-repeat="r in column.answers" ng-selected="r.value === $parent.$parent.response" value="{{r.value}}">{{r.text}}</option>\n                </select>\n            </div>\n\t\t</div>\n\t\t<div\n\t\t\tclass="cell-labels"\n\t\t\tng-if="data.cellLabels"\n\t\t\tng-bind-html="column.stem"\n\t\t></div>\n\t</td>\n</tr>\n';function gridRowDirective$1(){return{replace:!0,template:gridRow,require:["ngModel"],controller:"questController",controllerAs:"ctrl",scope:{row:"=questGridRow",data:"=questGridData"},link:function(e,t,n,r){var i=r[0],o=e.ctrl,a=e.columns=e.$parent.columns.map(function(t,n){return lodash.get(e,"row.overwrite["+n+"]")||t}).map(function(e){return e.hasOwnProperty("type")||(e.type="checkbox"),"dropdown"==e.type&&(lodash.isArray(e.answers)||(e.answers=[]),e.answers=e.answers.map(function(e,t){return lodash.isObject(e)||(e={text:e}),"value"in e||(e.value=t+1),e})),e});a.filter(function(e){return"text"!=e.type}).forEach(function(e,t){e.hasOwnProperty("value")||(e.value=t+1)}),a.filter(function(e){return!e.noReverse}).filter(function(e){return"text"!=e.type}).forEach(function(e,t,n){e.reverseValue=n[n.length-t-1].value}),e.model=i,e.$watch("response",function(t){e.row.$response=t}),o.registerModel(i,{data:e.row})}}}var multiGrid='<div ng-form class="table-responsive" ng-class="{\'pi-page-submitted\':$parent.$parent.submitAttempt}">\n\t<table class="table table-hover">\n\t\t<colgroup>\n\t\t\t<col\n\t\t\t\tng-if="!data.rowStemHide"\n\t\t\t></col>\n\t\t\t<col\n\t\t\t\tng-repeat="column in columns"\n\t\t\t\tng-style="column.css"\n\t\t\t></col>\n\t\t</colgroup>\n\t\t<thead ng-if="!data.columnStemHide">\n\t\t\t<tr>\n\t\t\t\t<th\n\t\t\t\t\tng-style="allCss(data.columnStemCss,column.stemCss, data.rowStemCss)"\n\t\t\t\t\tng-if="!data.rowStemHide"\n\t\t\t\t></th>\n\t\t\t\t<th\n\t\t\t\t\tng-repeat="column in columns"\n\t\t\t\t\tng-bind-html="column.stem"\n\t\t\t\t\tng-style="allCss(data.columnStemCss,column.stemCss)"\n\t\t\t\t></th>\n\t\t\t</tr>\n\t\t</thead>\n\t\t<tbody>\n\t\t\t<tr\n\t\t\t\tng-repeat="row in rows"\n\t\t\t\tquest-multi-grid-row="row"\n\t\t\t\tquest-multi-grid-data="data"\n\t\t\t\tng-model="$parent.$parent.current.questions[row.name]"\n\t\t\t></tr>\n\t\t</tbody>\n\t</table>\n\t<div pi-quest-validation="form.$error.required">{{data.errorMsg.required || "Please respond to this question"}}</div>\n\t<div pi-quest-validation="form.$error.pattern">{{data.errorMsg.pattern || "wrong pattern!"}}</div>\n</div>\n';function gridDirective$2(e){return{replace:!0,template:multiGrid,require:["ngModel","form"],controllerAs:"ctrl",scope:{data:"=questData",current:"=questCurrent"},link:function(r,i,o,a){var s,u,l=r.data;r.form=a[1],r.columns=(l.columns||[]).map(n),r.rows=(s=l.rows,u=l,lodash(s||[]).map(n).each(function(e,t){e.hasOwnProperty("name")||(e.name=u.name+function(e,t){var n=Math.abs(e),r=1+Math.floor(Math.log(n)/Math.LN10);if(r>=t)return e;var i=Math.pow(10,t-r).toString().substr(1);return e<0?"-"+i+n:i+n}(t+1,3))}).thru(u.shuffle?e:lodash.identity).value()),r.allCss=t}};function t(){var e=lodash.toArray(arguments);return e.unshift({}),lodash.extend.apply(lodash,e)}function n(e){return lodash.isPlainObject(e)?e:{stem:e}}}gridDirective$2.$inject=["questShuffle"];var multiGridRow='<tr>\n\t<th\n\t\tscope="row"\n\t\tng-if="!data.rowStemHide"\n\t\tng-bind-html="row.stem"\n\t\tng-style="data.rowStemCss"\n\t></th>\n\t<td ng-repeat="column in columns">\n\t\t<div ng-switch="column.type">\n\t\t\t<button\n\t\t\t\tclass="btn btn-default"\n\t\t\t\tng-switch-when="checkbox"\n\t\t\t\tbtn-checkbox\n                btn-checkbox-true="column.value || true"\n\t\t\t\tng-model="$parent.$parent.response[$index]"\n\t\t\t\tng-class="data.checkboxType"\n\t\t\t\tuncheckable\n\t\t\t></button>\n\t\t\t<div\n\t\t\t\tclass="text"\n\t\t\t\tng-switch-when="text"\n\t\t\t\tng-bind-html="row[column.textProperty]"\n\t\t\t></div>\n\t\t\t<div\n\t\t\t\tclass="grid-input input-group input-group-small"\n\t\t\t\tng-switch-when="input"\n                title="insert your response"\n\t\t\t>\n                <span class="input-group-addon glyphicon glyphicon-edit"></span>\n                <input type="text" class="form-control" ng-model="$parent.$parent.response[$index]" >\n            </div>\n            <div ng-switch-when="dropdown"> \n                <select ng-model="$parent.$parent.response[$index]" class="form-control" ng-options="r.value as r.text for r in column.answers">\n                    <option value="">{{column.chooseText || "-- Choose an option --"}}</option>\n                </select>\n            </div>\n\t\t</div>\n\t\t<div\n\t\t\tclass="cell-labels"\n\t\t\tng-if="data.cellLabels"\n\t\t\tng-bind-html="column.stem"\n\t\t></div>\n\t</td>\n</tr>\n';function gridRowDirective$2(){return{replace:!0,template:multiGridRow,require:["ngModel"],controller:"questController",controllerAs:"ctrl",scope:{row:"=questMultiGridRow",data:"=questMultiGridData"},link:function(e,t,n,r){var i=r[0],o=e.ctrl;function a(t){var n=e.columns.every(function(n,r){var i=t[r];if(!e.data.required&&!e.row.required&&!n.required)return!0;switch(n.type){case"text":return!0;case"input":return""!==i;case"dropdown":return!isNaN(i)&&null!==i;default:return i}});return i.$setValidity("required",n),t}e.model=i,e.columns=e.$parent.columns.map(function(t,n){return lodash.get(e,"row.overwrite["+n+"]",t)}).map(function(e){return e.hasOwnProperty("type")||(e.type="checkbox"),"dropdown"==e.type&&(lodash.isArray(e.answers)||(e.answers=[]),e.answers=e.answers.map(function(e,t){return lodash.isObject(e)||(e={text:e}),"value"in e||(e.value=t+1),e})),e}),o.registerModel(i,{data:e.row,dflt:(e.columns||[]).map(mapDefault)}),i.$parsers.unshift(a),i.$parsers.unshift(function(t){var n=e.columns.every(function(e,n){var r=t[n];if("input"!==e.type||!e.pattern)return!0;return!(!lodash.isNumber(r)&&!lodash.isString(r))&&new RegExp(e.pattern).test(r)});return i.$setValidity("pattern",n),t}),a(i.$viewValue),e.$watchCollection("response",function(e){i.$setViewValue(e.slice())})}}}function mapDefault(e){return"string"!=typeof e&&("text"===e.type?null:"input"===e.type?"":"dropdown"===e.type&&NaN)}var slider='<div ng-form>\n\t<div\n\t\tpi-slider\n\t\tng-model="sliderResponse"\n\t\tpi-slider-options="data"\n\t\tng-required="{{data.required}}"\n\t></div>\n\t<h4 ng-if="data.displayValue" class="text-center"><span class="label label-info">{{ sliderResponse | number }}</span></h4>\n\t<div pi-quest-validation="form.$error.required">{{data.errorMsg.required || "Please respond to this question"}}</div>\n</div>\n';function sliderDirective$1(){return{replace:!0,template:slider,require:["form","ngModel"],controller:"questController",controllerAs:"ctrl",scope:{data:"=questData"},link:function(e,t,n,r){var i=r[0],o=r[1],a=e.ctrl,s=e.data;e.form=i,a.registerModel(o,{dflt:void 0}),e.sliderResponse=e.response;var u=e.$on("slider:change",function(t,n){e.$apply(function(){e.response=n,s.autoSubmit&&e.$emit("quest:submit:now")})});e.$on("quest:timeout",u)}}}var slider$1=slider$2();function slider$2(){var e="slider:change";function t(t){return{scope:{options:"=piSliderOptions"},replace:!0,require:"ngModel",template:['<div class="slider" ng-class="{\'slider-ticks\':options.showTicks}" pi-pointerdown="onSliderMouseDown($event)">','<div class="slider-label-left" ng-style="options.leftLabelCss">{{options.leftLabel}}</div>','<div class="slider-label-right" ng-style="options.rightLabelCss">{{options.rightLabel}}</div>','<div class="slider-container">','<div class="slider-bar">','<div class="slider-bar-highlight" ng-style="highlightStyle"></div>',"</div>",'<div class="slider-handle" pi-pointerdown="onHandleMousedown($event)" ng-style="handleStyle"></div>',"</div>",'<ul class="slider-pips" ng-if="!options.hidePips">','<li ng-repeat="i in getNumber(steps) track by $index" ng-style="{width: pipWidth + \'%\'}" ng-class="{last:$last}"></li>',"</ul>",'<ul class="slider-labels">','<li ng-repeat="label in labels track by $index" ng-style="{width: labelsWidth + \'%\'}" ng-class="{first:$first, last:$last}">{{label}}</li>',"</ul>","</div>"].join("\n"),link:function(i,o,a,s){var u,l=i.options||{};function c(e){s.$setViewValue(e),s.$render()}function f(e){return!i.steps||s.$isEmpty(e)?e:Math.round(e*i.steps)/i.steps}function d(r){var a,l;function f(e){n(e),e.preventDefault();var t=a+(e.pageX-l)/(o.prop("clientWidth")-u);t=Math.min(t,1),t=Math.max(t,0),i.$apply(function(){c(t)})}n(r),r.preventDefault(),r.stopPropagation(),l=r.pageX,a=s.$viewValue,t.on("mousemove touchmove",f),t.on("mouseup touchend",function n(r){r.preventDefault();t.off("mousemove touchmove",f);t.off("mouseup touchend",n);i.$emit(e,s.$modelValue)})}u=o[0].querySelector(".slider-handle").clientWidth,i.ngModel=s,i.min=l.min||0,i.max=l.max||i.min+100,i.range=i.max-i.min,i.steps=l.steps?l.steps-1:0,i.pipWidth=l.steps&&100/i.steps,i.labels=l.labels,i.labelsWidth=l.labels&&100/l.labels.length,s.$isEmpty=r,s.$render=function(){var e=f(s.$viewValue),t=!isNaN(e),n=t?"block":"none",r=t&&l.highlight?"block":"none";switch(l.highlightDirection){case"rtl":i.highlightStyle={left:100*e+"%",display:r};break;case"center":i.highlightStyle=e>.5?{left:"50%",width:100*(e-.5)+"%",display:r}:{right:"50%",width:100*(.5-e)+"%",display:r};break;default:i.highlightStyle={right:100-100*e+"%",display:r}}i.handleStyle={left:100*e+"%",display:n}},s.$formatters.push(function(e){if(s.$isEmpty(e))return NaN;return((e=Math.min(Math.max(e,i.min),i.max))-i.min)/i.range}),s.$parsers.push(function(e){return+(i.min+f(e)*i.range).toFixed(4)}),i.onHandleMousedown=d,i.onSliderMouseDown=function(e){n(e),e.preventDefault();var t=o.prop("clientWidth"),r=o[0].getBoundingClientRect().left,i=(e.pageX-r-u/2)/(t-u);i=Math.min(i,1),c(i=Math.max(i,0)),d(e)},i.getNumber=function(e){return new Array(e)}}}}return t.$inject=["$document","$sce"],t;function n(e){var t,n,r;null==e.pageX&&null!=e.clientX&&(n=(t=e.target.ownerDocument||document).documentElement,r=t.body,e.pageX=e.clientX+(n&&n.scrollLeft||r&&r.scrollLeft||0)-(n&&n.clientLeft||r&&r.clientLeft||0),e.pageY=e.clientY+(n&&n.scrollTop||r&&r.scrollTop||0)-(n&&n.clientTop||r&&r.clientTop||0)),null==e.pageX&&e.touches&&(e.pageX=e.touches[0].pageX,e.pageY=e.touches[0].pageY)}function r(e){return isNaN(parseFloat(e))||!isFinite(e)}}var EVENTNAME="touchstart mousedown",DIRECTIVENAME="piPointerdown";function piPointerdownDirective(e){return{compile:function(t,n){var r=e(n[DIRECTIVENAME],!0);return function(e,t){function n(t){e.$apply(function(){r(e,{$event:t})})}t.on(EVENTNAME,n),e.$on("$destroy",function(){t.off(EVENTNAME,n)})}}}}function toRegexFilter(e){return function(t){var n;if(lodash.isUndefined(t))return/(?:)/;{if(lodash.isRegExp(t)||lodash.isString(t))return new RegExp(t);throw n=new Error("Question pattern is not a valid regular expression"),e({tags:"text",type:"error",message:"pattern",error:n,context:t}),n}}}piPointerdownDirective.$inject=["$parse"],toRegexFilter.$inject=["piConsole"];var dfltUnitsFilter=function(){return dfltUnits};function dfltUnits(e,t){return e||0===e||"0"===e?isNumeric(e)?e+(lodash.isUndefined(t)?"px":String(t)):e:""}function isNumeric(e){return!lodash.isArray(e)&&e-parseFloat(e)+1>=0}var module$8=angular.module("questDirectives",[module$9.name,module$10.name,buttons.name,module$6.name,module$7.name,module$11.name]);module$8.controller("questController",questController$1),module$8.factory("questGuid",guidFactory),module$8.directive("piQuest",directive),module$8.directive("piqPage",directive$1),module$8.directive("questWrapper",directive$2),module$8.directive("questInfo",function(){return{}}),module$8.directive("questText",textDirective),module$8.directive("questTextarea",textDirective),module$8.directive("questTextNumber",directive$3),module$8.service("questSelectMixer",selectMixerProvider),module$8.directive("questDropdown",directive$4),module$8.directive("questSelectOne",directive$5),module$8.directive("questSelectMulti",directive$6),module$8.directive("questRank",directive$7),module$8.value("questShuffle",lodash.shuffle),module$8.directive("questGrid",gridDirective$1),module$8.directive("questGridRow",gridRowDirective$1),module$8.directive("questMultiGrid",gridDirective$2),module$8.directive("questMultiGridRow",gridRowDirective$2),module$8.directive("questSlider",sliderDirective$1),module$8.directive("piSlider",slider$1),module$8.directive("piPointerdown",piPointerdownDirective),module$8.config(["$sceProvider",function(e){e.enabled(!1)}]),module$8.directive("piQuestValidation",function(){return{replace:!0,transclude:!0,scope:{unvalid:"=piQuestValidation",postSubmit:"=piPostSubmit"},template:['<div class="alert alert-danger" role="alert" ng-show="unvalid && ($parent.$parent.$parent.submitAttempt || postSubmit)">','<span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>',"<span ng-transclude></span>","</div>"].join("")}}),module$8.filter("toRegex",toRegexFilter),module$8.filter("dfltUnits",dfltUnitsFilter),module$8.directive("piqPage",function(){return{link:function(e,t){e.page.autoFocus&&setTimeout(function(){var e=t[0].querySelector("[quest-wrapper]"),n=e&&e.querySelector("input, textArea, select, button");n&&n.focus()})}}});var module$1=angular.module("piQuest",[module$8.name,module$2.name]);function directive$8(e,t,n,r){return{link:function(i,o){var a,s=i.script,u=i.newScope=i.$new(),l={global:t.global,current:t.current,task:s,tasksData:lodash.get(s,"data",{})};null==s.$template&&r({tags:"message",type:"error",message:"missing template for message",context:s});try{a=lodash.template(s.$template)(l)}catch(e){a=s.$template,r({tags:"message",type:"error",message:"failed to render template",error:e})}function c(e){var t=lodash.isArray(s.keys)?s.keys:[s.keys],n=lodash.map(t,function(e){return lodash.isString(e)?e.toUpperCase().charCodeAt(0):e});~lodash.indexOf(n,e.which)&&i.done()}lodash.extend(i,l),i.done=function(){u.$destroy(),o.empty(),i.$emit("message:done")},n.on("keydown",c),i.$on("$destroy",function(){n.off("keydown",c)}),o.html(a),e(o.contents())(u)}}}function directive$9(){return{link:function(e,t){t.on("click",function(){e.done()})}}}directive$8.$inject=["$compile","$rootScope","$document","piConsole"],directive$9.$inject=[];var module$12=angular.module("pi.message",[module$7.name]);function provider(){var e={};this.$get=taskActivateProvider,this.set=function(t,n){e[t]=n},this.get=function(t){return e[t]}}function taskActivateProvider(e,t,n){var r=this;return function(i,o,a){var s,u,l=e.defer(),c=t.global,f=i.$script;if((lodash.isFunction(f)||lodash.isArray(f))&&(s=f),!s&&f&&lodash.isFunction(f.play)&&((s=lodash.bind(f.play,f)).$inject=n.annotate(f.play)),!s&&f&&lodash.isArray(f.play)&&((s=lodash.bind(f.play[f.play.length-1],f)).$inject=n.annotate(f.play)),!s&&i.type&&(s=r.get(i.type)),!s)throw new Error('Activator function not found for the "'+i.type+'" task');return u=n.invoke(s,null,{done:lodash.bind(l.resolve,l),task:i,script:f,$element:o,$scope:a,global:c}),lodash.isFunction(u)&&l.promise.finally(u),l}}function directive$10(e,t,n,r,i,o){return{scope:{task:"=piTask"},link:function(a,s){var u,l,c,f,d,p=a.task,h=a.$parent.settings||{},m=p.$script||{},v=p.name||m.name,g=window.piGlobal;function $(e){var t=e.which||e.keyCode,r=(e.key||"").toUpperCase();82!=t&&"R"!=r||!e.ctrlKey||(w(e,"current"),e.preventDefault()),27==t&&n.one("keydown",y)}function y(e){var t=e.which||e.keyCode;37==t&&w(e,"prev"),39==t&&w(e,"next")}function w(e,t){e.preventDefault(),d={type:t,bustCache:!0},c.resolve()}p&&(h.skip&&!0===window.DEBUG&&(n.on("keydown",$),a.$on("$destroy",function(){n.off("keydown",$),n.off("keydown",y)})),i.current=g.current=m.current||{},v&&(g[v]&&o({type:"warn",tags:["task"],message:'This taskName has already been in use: "'+v+'"'}),lodash.extend(i.current,g[v]||{}),r.piGlobal[v]=m.current),f=(c=e(p,s,a.$new())).promise,u=t(p.canvas),f.finally(u),p.title&&(l=n[0].title,n[0].title=p.title,f.finally(function(){n[0].title=l})),f.finally(function(){a.$emit("task:done",d)}))}}}function log(){console.log.apply(console,arguments)}module$12.directive("piMessage",directive$8),module$12.directive("piMessageDone",directive$9),taskActivateProvider.$inject=["$q","$rootScope","$injector"],directive$10.$inject=["taskActivate","managerCanvas","$document","$window","$rootScope","piConsole"],Date.now||(Date.now=function(){return(new Date).getTime()}),function(e){var t,n=["now","webkitNow","msNow","mozNow"];if(e.performance)for(var r=0;r<n.length;++r){var i=n[r];if(e.performance[i]){t=function(){return e.performance[i]()};break}}t||(t=Date.now),e.perfNow=t}(window),console.group||(console.group=log),console.groupCollapsed||(console.groupCollapsed=log),console.groupEnd||(console.groupEnd=log),console.table||(console.table=log),function(){for(var e=["webkit","moz"],t=0;t<e.length&&!window.requestAnimationFrame;++t){var n=e[t];window.requestAnimationFrame=window[n+"RequestAnimationFrame"],window.cancelAnimationFrame=window[n+"CancelAnimationFrame"]||window[n+"CancelRequestAnimationFrame"]}if(/iP(ad|hone|od).*OS 6/.test(window.navigator.userAgent)||!window.requestAnimationFrame||!window.cancelAnimationFrame){var r=0;window.requestAnimationFrame=function(e){var t=Date.now(),n=Math.max(r+16,t);return setTimeout(function(){e(r=n)},n-t)},window.cancelAnimationFrame=clearTimeout}}();var PromisePolyfill=function(e){if(!(this instanceof PromisePolyfill))throw new Error("Promise must be called with `new`");if("function"!=typeof e)throw new TypeError("executor must be a function");var t=this,n=[],r=[],i=u(n,!0),o=u(r,!1),a=t._instance={resolvers:n,rejectors:r},s="function"==typeof setImmediate?setImmediate:setTimeout;function u(e,i){return function u(c){var f;try{if(!i||null==c||"object"!=typeof c&&"function"!=typeof c||"function"!=typeof(f=c.then))s(function(){i||0!==e.length||console.error("Possible unhandled promise rejection:",c);for(var t=0;t<e.length;t++)e[t](c);n.length=0,r.length=0,a.state=i,a.retry=function(){u(c)}});else{if(c===t)throw new TypeError("Promise can't be resolved w/ itself");l(f.bind(c))}}catch(e){o(e)}}}function l(e){var t=0;function n(e){return function(n){t++>0||e(n)}}var r=n(o);try{e(n(i),r)}catch(e){r(e)}}l(e)};function styleInject(e,t){void 0===t&&(t={});var n=t.insertAt;if(e&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===n&&r.firstChild?r.insertBefore(i,r.firstChild):r.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}}PromisePolyfill.prototype.then=function(e,t){var n,r,i=this._instance;function o(e,t,o,a){t.push(function(t){if("function"!=typeof e)o(t);else try{n(e(t))}catch(e){r&&r(e)}}),"function"==typeof i.retry&&a===i.state&&i.retry()}var a=new PromisePolyfill(function(e,t){n=e,r=t});return o(e,i.resolvers,n,!0),o(t,i.rejectors,r,!1),a},PromisePolyfill.prototype.catch=function(e){return this.then(null,e)},PromisePolyfill.resolve=function(e){return e instanceof PromisePolyfill?e:new PromisePolyfill(function(t){t(e)})},PromisePolyfill.reject=function(e){return new PromisePolyfill(function(t,n){n(e)})},PromisePolyfill.all=function(e){return new PromisePolyfill(function(t,n){var r=e.length,i=0,o=[];if(0===e.length)t([]);else for(var a=0;a<e.length;a++)!function(a){function s(e){i++,o[a]=e,i===r&&t(o)}null==e[a]||"object"!=typeof e[a]&&"function"!=typeof e[a]||"function"!=typeof e[a].then?s(e[a]):e[a].then(s,n)}(a)})},PromisePolyfill.race=function(e){return new PromisePolyfill(function(t,n){for(var r=0;r<e.length;r++)e[r].then(t,n)})},void 0===window.Promise&&(window.Promise=PromisePolyfill);var css=".minno-canvas{height:400px;width:500px;position:relative;border:5px solid #fff;margin:auto;margin-top:10px;-webkit-text-size-adjust:none;-webkit-touch-callout:none;-webkit-tap-highlight-color:transparent;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.minno-stimulus{position:absolute;text-align:center;overflow:hidden;visibility:hidden;width:fit-content}.minno-stimulus-visible{visibility:visible}.minno-stimulus-center-x{left:50%;transform:translateX(-50%)}.minno-stimulus-center-y{top:50%;transform:translateY(-50%)}.minno-stimulus-center-y.minno-stimulus-center-x{transform:translate(-50%,-50%)}.minno-progress{background-color:#20201f;border-radius:20px;padding:4px;position:relative;top:50%;width:80%;margin-left:10%;margin-top:-12px}.minno-progress-bar{background-color:#807b7a;width:0;height:16px;border-radius:10px}";styleInject(css);var glob=window.piGlobal||(window.piGlobal={});function global$3(){return glob}function go$1(e,t,n){var r=this.mixerSequence;switch(e){case"nextWhere":case"previousWhere":where("next",t,n,r);break;case"current":break;case"first":for(;r.prev(n),r.current(n););break;case"last":for(;r.next(n),r.current(n););r.prev();break;case"end":for(;r.next(n),r.current(n););break;case"next":r.next(n);break;default:throw new Error('Unknow destination "'+e+'" for goto.')}return this}function where(e,t,n,r){for(var i;r[e](),(i=r.current(n))&&!lodash.callback(t)(i.data););}function createDB$1(e){var t=new Database$2;if(t.createColl("trial"),t.createColl("stimulus"),t.createColl("media"),t.add("trial",e.trialSets||[]),t.add("stimulus",e.stimulusSets||[]),t.add("media",e.mediaSets||[]),!lodash.isArray(e.sequence))throw new Error("You must set a sequence array.");var n=t.sequence("trial",e.sequence);return n.go=go$1,t.currentSequence=n,t}function getSize$1(e){var t=window.getComputedStyle(e);return{height:parse$1(e.offsetHeight)-parse$1(t.borderTopWidth)-parse$1(t.borderBottomWidth),width:parse$1(e.offsetWidth)-parse$1(t.borderLeftWidth)-parse$1(t.borderRightWidth)}}function parse$1(e){return parseFloat(e,10)||0}function adjust_canvas(e,t){return lodash.throttle(function(e){"orientationchange"==e.type?setTimeout(n,500):n()},16);function n(){var n=getTargetSize(t,e),r=window.getComputedStyle(e);n.height-=parse(r.borderTopWidth)+parse(r.borderBottomWidth)+parse(r.marginTop),n.width-=parse(r.borderLeftWidth)+parse(r.borderRightWidth),e.style.width=n.width+"px",e.style.height=n.height+"px",e.style.fontSize=n.height*(t.textSize||3)/100+"px",window.scrollTo(0,1)}}function getProportions(e){if(!lodash.isPlainObject(e))return e||.8;if([e.height,e.width].every(lodash.isFinite))return e.height/e.width;throw new Error("The canvas proportions object`s height and a width properties must be numeric")}function getTargetSize(e,t){var n=getProportions(e.proportions);if(e.width)return{width:e.width,height:e.width*n};var r=window.document.documentElement,i=r.clientHeight,o=Math.min(e.maxWidth||1/0,r.clientWidth,getSize$1(t.parentNode).width);return i>n*o?{height:o*n,width:o}:{height:i,width:i/n}}function parse(e){return parseFloat(e,10)||0}function canvasContructor(e,t){var n;if(!lodash.isPlainObject(e))throw new Error("canvas(map): You must set a rule map for canvas to work properly");if(lodash.isUndefined(t))return lodash.noop;if(!lodash.isPlainObject(t))throw new Error("canvas(settings): canvas settings must be an object");return n=lodash.map(t,function(t,n){var r=e[n];if(r)return on(r.element,r.property,t);throw new Error("canvas("+n+"): unknow key in canvas object.")}),function(){lodash.forEach(n,function(e){e.call()})}}function on(e,t,n){var r=e.style[t];return e.style[t]=n,function(){e.style[t]=r}}var css_1=css$2;function css$2(e,t){var n,r=e.style;if(t)for(var i in t)r[(n=i,n.replace(/-([a-z])/g,function(e){return e[1].toUpperCase()}))]=t[i]}function setupCanvas(e,t){t||(t={});var n=stream();if(!lodash.isElement(e))throw new Error("Minno-time: canvas is not a DOM element");e.classList.add("minno-canvas");var r=canvasContructor({background:{element:document.body,property:"backgroundColor"},canvasBackground:{element:e,property:"backgroundColor"},borderColor:{element:e,property:"borderColor"},borderWidth:{element:e,property:"borderWidth"}},lodash.pick(t,["background","canvasBackground","borderColor","borderWidth"]));return t.css&&css_1(e,t.css),n.map(adjust_canvas(e,t)),n({}),window.addEventListener("orientationchange",n),window.addEventListener("resize",n),n.end.map(function(){e.classList.remove("minno-canvas")}).map(function(){window.removeEventListener("orientationchange",n),window.removeEventListener("resize",n)}).map(r),n}function setup$1(e,t){var n=setupCanvas(e,lodash.get(t,"settings.canvas",{})),r=createDB$1(t);return setupVars(t),{db:r,$resize:n,canvas:e,script:t,settings:t.settings||{}}}function setupVars(e){var t=global$3(global$3()),n=e.name||"anonymous minno-time",r=e.current?e.current:{};r.logs||(r.logs=[]),t[n]=t.current=r}var srcStack=[],defStack=[],stackDone=0,getText=lodash.memoize(getXhr),loader={load:load,all:function(){return Promise.all(defStack)},progress:function(){return defStack.length?stackDone/defStack.length:1}};function load(e,t){if(-1!==srcStack.indexOf(e))return!1;var n="template"==t?getText(e):getImage(e);return n.then(function(){stackDone++}).then(function(){loader.onload&&loader.onload()}),defStack.push(n),srcStack.push(e),n}function getImage(e){return new Promise(function(t,n){var r=document.createElement("img");r.onload=function(){t(r)},r.onerror=function(){n(new Error("Image not found: "+e))},r.src=e})}function getXhr(e){return new Promise(function(t,n){var r=new XMLHttpRequest;r.open("GET",e,!0),r.onreadystatechange=function(){4===this.readyState&&(this.status>=200&&this.status<400?t(this.responseText):n(new Error("Template not found:"+e)))},r.send()})}function buildUrl(e,t,n){return"image"==n&&/^data:image/.test(t)?t:(lodash.isObject(e)&&(e=e[n]),e?"/"!=e[e.length-1]&&(e+="/"):e="",e+t)}function preloadScript(e,t){return getScriptMedia(e).forEach(function(e){lodash.isUndefined(e.image)||loader.load(buildUrl(t,e.image,"image"),"image");lodash.isUndefined(e.template)||loader.load(buildUrl(t,e.template,"template"),"template")}),loader}function getScriptMedia(e){var t=e.mediaSets,n=lodash.map(e.stimulusSets,getStimMedia),r=lodash.map(e.trialSets,getTrialMedia),i=lodash.filter(e.sequence,notMixer).map(getTrialMedia);return lodash.flattenDeep([t,n,r,i]).filter(notUndefined)}function getTrialMedia(e){return[lodash.map(e.input,function(e){return e.element}),lodash.map(e.stimuli,getStimMedia),lodash.map(e.layout,getStimMedia)]}function getStimMedia(e){return e.media}function notMixer(e){return!e.mixer}function notUndefined(e){return!lodash.isUndefined(e)}var fastdom=createCommonjsModule(function(e){!function(t){var n=function(){},r=t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.msRequestAnimationFrame||function(e){return setTimeout(e,16)};function i(){this.reads=[],this.writes=[],this.raf=r.bind(t)}function o(e){e.scheduled||(e.scheduled=!0,e.raf(function(e){var t,r=e.writes,i=e.reads;try{n("flushing reads",i.length),a(i),n("flushing writes",r.length),a(r)}catch(e){t=e}e.scheduled=!1,(i.length||r.length)&&o(e);if(t){if(n("task errored",t.message),!e.catch)throw t;e.catch(t)}}.bind(null,e)))}function a(e){for(var t;t=e.shift();)t()}function s(e,t){var n=e.indexOf(t);return!!~n&&!!e.splice(n,1)}i.prototype={constructor:i,measure:function(e,t){var n=t?e.bind(t):e;return this.reads.push(n),o(this),n},mutate:function(e,t){var n=t?e.bind(t):e;return this.writes.push(n),o(this),n},clear:function(e){return s(this.reads,e)||s(this.writes,e)},extend:function(e){if("object"!=typeof e)throw new Error("expected object");var t=Object.create(this);return function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}(t,e),t.fastdom=this,t.initialize&&t.initialize(),t},catch:null};var u=t.fastdom=t.fastdom||new i;e.exports=u}("undefined"!=typeof window?window:commonjsGlobal)});function preloadPhase$1(e,t){var n=preloadScript(t,t.base_url);if(1==n.progress())return Promise.resolve().then(i);e.innerHTML='<div class="minno-progress"><div class="minno-progress-bar"></div></div>';var r=e.getElementsByClassName("minno-progress-bar")[0].style;return r.width=n.progress()+"%",n.onload=function(){fastdom.mutate(function(){r.width=100*n.progress()+"%"})},n.all().then(i).catch(function(e){throw new Error("loading resource failed, do something about it! (you can start by checking the error log, you are probably reffering to the wrong url - "+e+")")});function i(){for(;e.firstChild;)e.removeChild(e.firstChild)}}function mouseEvents$1(e,t,n){var r=stream(),i=t.element;return i&&(css_1(i,t.css),fastdom.mutate(function(){n.appendChild(i)})),n.addEventListener(e,function(e){var n=e.target;return i&&n===i?r(e):i||n.getAttribute("data-handle")!==t.stimHandle?void 0:r(e)}),r.end.map(function(){i&&n.removeChild(i);n.removeEventListener(e,r)}),r}var keyDownArr=[];function keypressed$1(e){var t=stream(),n=(Array.isArray(e.key)?e.key:[e.key]).map(function(e){return"string"==typeof e?e.toUpperCase().charCodeAt(0):e});return document.addEventListener("keydown",r),t.end.map(function(){document.removeEventListener("keydown",r)}),t;function r(e){keyDownArr[e.which]||-1===n.indexOf(e.which)||(e.preventDefault(),keyDownArr[e.which]=!0,t(e))}}function keyup$1(e){var t=stream(),n=(Array.isArray(e.key)?e.key:[e.key]).map(function(e){return"string"==typeof e?e.toUpperCase().charCodeAt(0):e});return document.addEventListener("keyup",function(e){if(-1===n.indexOf(e.which))return;return e.preventDefault(),t(e)}),t.end.map(function(){document.removeEventListener("keyup",t)}),t}function simpleRandomize(e,t){if(lodash.isArray(e))return e[Math.floor(Math.random()*e.length)];if(lodash.isFunction(e))return e.call(t);if(lodash.isPlainObject(e)){if(!lodash.isNumber(e.min)||!lodash.isNumber(e.max)||e.min>e.max)throw new Error("randomization objects need both a max and a minimum property, also max has to be larger than min");return e.min+(e.max-e.min)*Math.random()}return e}function timeout$1(e){var t,n=stream(),r=simpleRandomize(e.duration)||0;return n.end.map(function(){clearTimeout(t)}),r?setTimeout(n.bind(null,{}),r):n({}),n}function inputBinder(e,t){var n=e.on;switch(n){case"keypressed":return keypressed$1(e);case"keyup":return keyup$1(e);case"click":case"mousedown":return mouseEvents$1("mousedown",e,t);case"mouseup":return mouseEvents$1("mouseup",e,t);case"mouseenter":return mouseEvents$1("mouseenter",e,t);case"mouseleave":return mouseEvents$1("mouseleave",e,t);case"timeout":return timeout$1(e);case"enter":return keypressed$1(lodash.assign({key:13},e));case"space":return keypressed$1(lodash.assign({key:32},e));case"esc":return keypressed$1(lodash.assign({key:27},e));case"leftTouch":return e.element=r(e.css,{position:"absolute",left:0,width:"30%",height:"100%",background:"#00FF00",opacity:.3}),mouseEvents$1("mousedown",e,t);case"rightTouch":return e.element=r(e.css,{position:"absolute",right:0,width:"30%",height:"100%",background:"#00FF00",opacity:.3}),mouseEvents$1("mousedown",e,t);case"topTouch":return e.element=r(e.css,{position:"absolute",top:0,width:"100%",height:"30%",background:"#00FF00",opacity:.3}),mouseEvents$1("mousedown",e,t);case"bottomTouch":return e.element=r(e.css,{position:"absolute",bottom:0,width:"100%",height:"30%",background:"#00FF00",opacity:.3}),mouseEvents$1("mousedown",e,t);default:throw new Error('You have an input element with an unrecognized "on" property: '+n)}function r(e,t){var n=document.createElement("div");return css_1(n,t),css_1(n,e),n}}function createListener$1(e,t){var n=getListener(e,t);if(!isStream(n))throw new Error("Input functions must return valid streams: "+logObj(e));return"handle"in e&&(n.handle=e.handle),n}function getListener(e,t){var n;if(lodash.isFunction(e))return e(e,t,stream);if(lodash.isPlainObject(e)){if(lodash.isString(e.on))return inputBinder(e,t,stream);lodash.isFunction(e.on)&&(n=e.on(e,t,stream)),lodash.isFunction(e.off)&&n.end.map(e.off)}throw new Error("Input must only contain objects and functions, do you have an undefined value?")}function logObj(e){return lodash.isFunction(e)?e.toString():JSON.stringify(e)}function isStream(e){return e._state}document.addEventListener("keyup",function(e){keyDownArr[e.which]=!1});var now=window.performance.now?window.performance.now.bind(window.performance):Date.now.bind(Date);function interfaceFn(e,t){var n=[],r=0;return{add:function(i){if(!i)throw new Error("Missing input element. Could not add input listener");var o=createListener$1(i,t);o.map(function(e){return{handle:o.handle,event:e,timestamp:+new Date,latency:now()-r}}).map(e),n.push(o)},remove:function(e){for(var t=n.length-1;t>=0;t--){var r=n[t];r.handle===e&&(r.end(!0),n.splice(t,1))}},removeAll:function(){n.forEach(function(e){e.end(!0)}),n.length=0},resetTimer:function(){r=now()}}}function getMedia$1(e){var t,n=e.html||e.inlineTemplate||e.template;return lodash.isFunction(e)?customMedia(e):(lodash.isString(e)&&(e={word:e}),e.word?((t=document.createElement("div")).textContent=e.word,Promise.resolve(t)):n?((t=document.createElement("div")).innerHTML=n,Promise.resolve(t)):e.image?new Promise(function(n,r){(t=document.createElement("img")).onload=function(){n(t)},t.onerror=function(){r(new Error("Image not found: "+t.src))},t.src=e.image}):e.jquery?Promise.reject(new Error("Jquery is no longer supported in minno-time")):Promise.reject(new Error("Unrecognized media type")))}function customMedia(e){var t,n=e();return(t=n)&&lodash.isFunction(t.then)?n.then(function(e){return lodash.isElement(e)?e:Promise.reject("Custom media must resolve with an element")}):Promise.reject(new Error("Custom media must return a promise"))}function setSize$1(e,t){var n=e.style,r=t.size||{};return r.font_size&&(n.fontSize=r.font_size),isSet("height",r)&&!isWordMedia(t.media)&&(n.height=r.height+"%"),isSet("width",r)&&(n.width=r.width+"%"),e}function isSet(e,t){return e in t}function isWordMedia(e){return lodash.isString(e)||lodash.isString(e.word)}var YCLASS="minno-stimulus-center-y",XCLASS="minno-stimulus-center-x";function setPlace$1(e,t){var n=t.location||{};("center"==n.top||"center"==n.bottom||void 0===n.top&&void 0===n.bottom)&&e.classList.add(YCLASS),("center"==n.left||"center"==n.right||void 0===n.left&&void 0===n.right)&&e.classList.add(XCLASS),["top","bottom","left","right"].forEach(function(t){r=n[t],isNaN(+r)||(e.style[t]=n[t]+"%");var r})}function fixIE(e,t){var n=e.style,r=e.classList.contains(XCLASS),i=e.classList.contains(YCLASS);if(!r&&!i)return t(e);fastdom.measure(function(){var t=window.getComputedStyle(e),o=parseFloat(t.width),a=parseFloat(t.height);fastdom.mutate(function(){n.transform="none",r&&(n.marginLeft="-"+o/2+"px"),i&&(n.marginTop="-"+a/2+"px")})})}function Stimulus$1(e,t,n){var r={el:null,source:e,trial:t,canvas:n,init:init,show:show,hide:hide,name:name,mediaName:mediaName,destroy:destroy$1};return r.data=e.data||{},r.handle=r.data.handle=r.data.handle||e.handle||e.set,r}function init(){var e=this.source,t=this.trial.$messages;if(!this.source.media)throw new Error("Media object not defined for "+this.name());return getMedia$1(this.source.media).then(setupElement.bind(this,this.canvas),function(n){throw t({type:"error",message:"trial.stimulus error",error:n,context:e}),n})}function setupElement(e,t){var n=this;return this.el=t,new Promise(function(r){fastdom.mutate(function(){t.classList.add("minno-stimulus"),t.setAttribute("data-handle",n.handle),setSize$1(t,n.source),setPlace$1(t,n.source),css_1(t,n.source.css||{}),n.source.isLayout&&t.classList.add("minno-stimulus-visible"),e.appendChild(t),document.documentMode?fixIE(t,r):r(t)})})}function show(){var e=this.el;if(!e)throw new Error("A stimulus can not be shown before init is called");fastdom.mutate(function(){e.classList.add("minno-stimulus-visible")})}function hide(){var e=this.el;if(!e)throw new Error("A stimulus can not be hidden before init is called");fastdom.mutate(function(){e.classList.remove("minno-stimulus-visible")})}function destroy$1(){var e=this.el,t=this.canvas;fastdom.mutate(function(){t.removeChild(e)})}function name(){var e=this.source;return e.alias?e.alias:this.data.alias?this.data.alias:e.inherit&&e.inherit.set?e.inherit.set:this.handle?this.handle:void 0}function mediaName(e){var t=this.source.media,n=e&&e.fullpath;if(t.alias)return t.alias;for(var r in t){if(contains$1(["image","template"],r))return n?t[r]:t[r].replace(/^.*[\\/]/,"");if(contains$1(["word","html","inlineTemplate"],r)&&t[r])return t[r]}}function contains$1(e,t){return-1!=e.indexOf(t)}function stimCollection(e,t){validateStimuli("stimuli",e._source),validateStimuli("layout",e._source);var n=e._source,r=lodash.map(n.stimuli,a),i=lodash.map(n.layout,function(e){return e.isLayout=!0,e}).map(a),o=Promise.all(r.concat(i).map(function(e){return e.init()}));return{canvas:t,stimuli:r,layout:i,ready:o,getStimlist:getStimlist,getMedialist:getMedialist,destroy:destroy};function a(n){return Stimulus$1(n,e,t)}}function getStimlist(){return this.stimuli.filter(function(e){return!e.source.nolog}).map(function(e,t){return e.name()||"stim"+t})}function getMedialist(e){return this.stimuli.filter(function(e){return!e.source.nolog}).map(function(t,n){return t.mediaName(e)||"media"+n})}function destroy(){this.stimuli.concat(this.layout).forEach(function(e){e.destroy()})}function validateStimuli(e,t){var n=t[e];if(n){if(!Array.isArray(n))throw new Error(e+" must be an array");if(!n.every(function(e){return"media"in e}))throw new Error("Each "+e+" stimulus must have a media property")}}var global$4=global$3(),conditionHash={begin:begin,inputEquals:inputEquals,inputEqualsTrial:inputEqualsTrial,inputEqualsStim:inputEqualsStim,trialEquals:trialEquals,inputEqualsGlobal:inputEqualsGlobal,globalEquals:globalEquals,globalEqualsTrial:globalEqualsTrial,globalEqualsStim:globalEqualsStim,currentEquals:currentEquals,currentEqualsTrial:currentEqualsTrial,currentEqualsStim:currentEqualsStim,inputEqualsCurrent:inputEqualsCurrent,fn:fn,custom:custom};function getConditonFn(e){if(lodash.isFunction(e))return e;if(lodash.isFunction(conditionHash[e.type]))return conditionHash[e.type];throw new Error("Unknown condition type: "+JSON.stringify(e))}function begin(e){return"begin"===e.type}function inputEquals(e,t){return-1!==(Array.isArray(t.value)?t.value:[t.value]).indexOf(e.handle)}function inputEqualsTrial(e,t,n){return e.handle===n.data[t.property]}function inputEqualsStim(e,t,n){var r={};return t.handle&&(r.handle=t.handle),r[t.property]=e.handle,hasData(r,n)}function trialEquals(e,t,n){if(lodash.isUndefined(t.property)||lodash.isUndefined(t.value))throw new Error('trialEquals requires both "property" and "value" to be defined');return t.value===n.data[t.property]}function inputEqualsGlobal(e,t){if(lodash.isUndefined(t.property))throw new Error('inputEqualsGlobal requires "property" to be defined');return e.handle===global$4[t.property]}function globalEquals(e,t){if(void 0===t.property||void 0===t.value)throw new Error('globalEquals requires both "property" and "value" to be defined');return t.value===global$4[t.property]}function globalEqualsTrial(e,t,n){if(void 0===t.globalProp||void 0===t.trialProp)throw new Error('globalEqualsTrial requires both "globalProp" and "trialProp" to be defined');return global$4[t.globalProp]!==n.data[t.trialProp]}function globalEqualsStim(e,t,n){if(void 0===t.globalProp||void 0===t.stimProp)throw new Error('globalEqualsStim requires both "globalProp" and "stimProp" to be defined');var r={};return t.handle&&(r.handle=t.handle),r[t.stimProp]=global$4[t.globalProp],hasData(r,n)}function inputEqualsCurrent(e,t){var n=global$4.current;if(void 0===t.property)throw new Error('inputEqualsCurrent requires "property" to be defined');return e.handle===n[t.property]}function currentEquals(e,t){var n=global$4.current;if(void 0===t.property||void 0===t.value)throw new Error('currentEquals requires both "property" and "value" to be defined');return t.value!==n[t.property]}function currentEqualsTrial(e,t,n){var r=global$4.current;if(void 0===t.currentProp||void 0===t.trialProp)throw new Error('currentEqualsTrial requires both "currentProp" and "trialProp" to be defined');return r[t.currentProp]===n.data[t.trialProp]}function currentEqualsStim(e,t,n){var r=global$4.current;if(void 0===t.currentProp||void 0===t.stimProp)throw new Error('currentEqualsStim requires both "currentProp" and "stimProp" to be defined');var i={};return t.handle&&(i.handle=t.handle),i[t.stimProp]=r[t.currentProp],hasData(i,n)}function fn(e,t,n){return t.value.apply(n,[t,e,n])}function custom(e,t,n){return t.fn.apply(null,[t,e,n])}function hasData(e,t){return t.stimulusCollection.stimuli.some(function(t){var n=t.data;for(var r in e)if(e[r]!==n[r])return!1;return!0})}function conditionsEvaluate(e,t,n){return e=Array.isArray(e)?e:[e],("begin"!=t.type||!e.every(function(e){return"begin"!=e.type}))&&e.every(function(e){return getConditonFn(e)(t,e,n)})}var actions={showStim:function(e,t,n){var r=e.handle||e;n.stimulusCollection.stimuli.forEach(function(e){"All"!=r&&e.handle!=r||e.show()})},hideStim:function(e,t,n){var r=e.handle||e;n.stimulusCollection.stimuli.forEach(function(e){"All"!=r&&e.handle!=r||e.hide()})},setStimAttr:function(e,t,n){var r=e.handle,i=e.setter;n.stimulusCollection.stimuli.forEach(function(e){"All"!=r&&e.handle!=r||(lodash.isFunction(i)?i.apply(e):lodash.extend(e.data,i))})},setTrialAttr:function(e,t,n){var r=e.setter;if(void 0===r)throw new Error("The setTrialAttr action requires a setter property");lodash.isFunction(r)?r.apply(n,[n.data,t]):lodash.extend(n.data,r)},setInput:function(e,t,n){if(void 0===e.input)throw new Error("The setInput action requires an input property");n.input.add(e.input)},trigger:function(e,t,n){if(void 0===e.handle)throw new Error("The trigger action requires a handle property");n.input.add({handle:e.handle,on:"timeout",duration:+e.duration||0})},removeInput:function(e,t,n){var r=n.input,i=e.handle;if(void 0===i)throw new Error("The removeInput action requires a handle property");"All"==i||lodash.include(i,"All")?r.removeAll():r.remove(i)},goto:function(e,t,n){n._next=[e.destination,e.properties]},endTrial:function(){},resetTimer:function(e,t,n){function r(){t.latency=0,n.input.resetTimer()}e.immidiate?r():fastdom.mutate(r)},log:function(e,t,n){n.$logs(arguments)},setGlobalAttr:function(e){switch(typeof e.setter){case"function":e.setter.apply(null,[global$3(),e]);break;case"object":lodash.extend(global$3(),e.setter);break;default:throw new Error('setGlobalAttr requires a "setter" property')}},custom:function(e,t,n){if("function"!=typeof e.fn)throw new Error("The custom action requires a fn propery");e.fn(e,t,n)},canvas:function(e,t,n){var r=n.cavnas,i=canvasContructor({background:{element:document.body,property:"backgroundColor"},canvasBackground:{element:r,property:"backgroundColor"},borderColor:{element:r,property:"borderColor"},borderWidth:{element:r,property:"borderWidth"}},lodash.pick(e,["background","canvasBackground","borderColor","borderWidth"]));n.$end.map(i)}};function applyActions(e,t,n){var r=!1;return e=lodash.isArray(e)?e:[e],lodash.forEach(e,function(e){var i=lodash.isFunction(e)?e:actions[e.type];if(!i)throw new Error("unknown action: "+e.type);"endTrial"===e.type&&(r=!0),i(e,t,n)}),r}var MAX_RECURSION_DEPTH=50;function interactions$1(e){var t=0,n=e._source.interactions;try{validateInteractions(n)}catch(t){throw e.$messages({type:"error",message:"trial.interactions error",error:t,context:e._source}),t}return function(r){var i,o,a,s,u="Event: "+(r.handle||r.type),l=[];if(t>MAX_RECURSION_DEPTH)throw new Error("It seem you have created an infinite loop. Minno has been halted");t++;try{for(i=0;i<n.length&&(o=n[i],a=conditionsEvaluate(o.conditions,r,e),l.push([a,o.conditions]),a&&(s=applyActions(o.actions,r,e)),!s);i++);}catch(t){throw e.$messages({type:"error",message:"trial.interactions error",error:t}),t}t--,e.$messages({type:"debug",message:u,rows:l}),s&&e.end();return r}}function validateInteractions(e){if(!Array.isArray(e))throw new Error("Interactions must be an array");if(!e.length)throw new Error("There are no interactions defined");if(!e.every(lodash.isPlainObject))throw new Error("Interactions must be plain objects");if(!e.every(t("conditions")))throw new Error("Conditions must be either an array or a function");if(!e.every(t("actions")))throw new Error("Actions must be either an array or a function");function t(e){return function(t){return Array.isArray(t[e])||lodash.isFunction(t[e])}}}var gid=0;function Trial$1(e,t,n){if(!e.interactions)throw new Error("Interactions not defined");this.canvas=t,this.settings=n,this._source=e,this.$logs=stream(),this.$messages=stream(),this.$events=stream(),this.$end=this.$events.end,this.data=e.data||{},this._id=lodash.uniqueId("trial_"),this.counter=gid++,this.input=interfaceFn(this.$events,t),this.stimulusCollection=stimCollection(this,t),this._next=["next",{}]}function addTrialDetails(e){return function(t){return lodash.assign(t,{trialId:e._id,counter:e.counter})}}function nextTrial$1(e,t,n){var r,i=n[0],o=n[1],a=e.currentSequence,s=global$3(),u={global:s,current:s.current};return a.go(i,o,u),(r=a.current(u,{skip:["layout","stimuli"]}))?(r.stimuli=lodash.map(r.stimuli||[],c,u),r.layout=lodash.map(r.layout||[],c,u),u.trialData=null,{value:r}):{done:!0};function l(n,r,i){var o=n[r];if(lodash.isUndefined(o))return!1;lodash.isString(o)&&(o={word:o}),(o=e.inflate("media",o,i)).image&&(o.image=buildUrl(t.base_url,o.image,"image")),o.template&&(o.inlineTemplate=requirejs("text!"+buildUrl(t.base_url,o.template,"template")),o.inlineTemplate=lodash.template(o.inlineTemplate)(i)),n[r]=o,i.mediaData=null,i.mediaMeta=null}function c(t){return l(t=e.inflate("stimulus",t,this,{skip:["media","touchMedia"]}),"media",this),l(t,"touchMedia",this),this.stimulusData=null,this.stimulusMeta=null,t}}function post$4(e,t){return new Promise(function(n,r){var i=new XMLHttpRequest;i.open("POST",e,!0),i.setRequestHeader("Content-Type","application/json; charset=UTF-8"),i.onreadystatechange=function(){4===this.readyState&&(this.status>=200&&this.status<400?n(this.responseText):r(new Error("Failed posting to: "+e)))},i.send(serialize$3(t))})}function serialize$3(e){return"string"==typeof e?e:JSON.stringify(e)}function poster$3(e,t){var n=[],r=t.url;function i(e){var n=(t.serialize||(t.newServelet?buildPost$1:buildPostOld$1))(e,t.metaData);return post$4(r,n).catch(function(){return post$4(r,n)}).catch(t.error||lodash.noop)}r&&(e.map(function(e){if(n.push(e),!t.pulse)return;n.length>=t.pulse&&(i(n),n.length=0)}),e.end.map(function(){n.length&&i(n)}))}function buildPost$1(e,t){var n=lodash.assign({data:e},t);return JSON.stringify(n)}function buildPostOld$1(e,t){var n="json="+JSON.stringify(e),r=serialize$2(t);return n+(r?"&"+r:"")}function serialize$2(e){var t,n=[];for(t in e)n.push(encodeURIComponent(t)+"="+encodeURIComponent(e[t]));return n.join("&").replace(/%20/g,"+")}function createLogs$2(e,t,n){var r,i=e.map((r=t.logger||t.logMap||n,function(e){return r.apply(null,e)}));return t.poster?t.poster(i,t,poster$3):poster$3(i,t),i}function transformLogs(e,t,n){var r=window.piGlobal,i=n.data,o=t,a=r.current.logs,s=lodash.get(n,"settings.logger.fullpath",!1),u=n.stimulusCollection.getStimlist(),l=n.stimulusCollection.getMedialist({fullpath:s});return{log_serial:a.length,trial_id:n.counter,name:n.name(),responseHandle:o.handle,latency:Math.floor(o.latency),stimuli:u,media:l,data:i}}function playerPhase(e){var t,n=e.canvas,r=e.db,i=e.settings,o=stream(),a=o.map(function(e){var r=t,o=t=new Trial$1(e,n,i);return o.$logs.map(s),o.$messages.map(u),e.DEBUG&&window.DEBUG&&setupDebug(o),o.$end.map(function(){f(o._next)}),o.start(),r&&fastdom.mutate(function(){r.stimulusCollection.destroy()}),o}),s=stream(),u=stream(),l=createLogs$2(s,composeLoggerSettings(e.script,global$3()),transformLogs);l.map(function(e){global$3().current.logs.push(e)});var c=lodash.get(i,"hooks.endTask",i.onEnd||lodash.noop);return o.end.map(function(){var e=a();e&&e.stimulusCollection.destroy()}).map(c),lodash.extend({$trial:a,end:o.end.bind(null,!0),$logs:l,$messages:u,start:f.bind(null,["next",{}]),onEnd:function(e){o.end.map(e)}},e);function f(e){var t=nextTrial$1(r,i,e);t.done?o.end(!0):o(t.value)}}function setupDebug(e){var t="Trial :"+e.counter;console.group(t),e.$messages.map(function(e){if("debug"!==e.type)return e;e.rows?(console.groupCollapsed(e.message),e.rows.forEach(function(e){console.log.apply(console,e)}),console.groupEnd(e.message)):console.log(e.message);return e}),e.$events.end.map(function(){console.groupEnd(t)})}function composeLoggerSettings(e,t){var n=lodash.assign({},lodash.get(e,"settings.logger")),r=lodash.assign({taskName:e.name},t.$meta,n.metaData);return n.metaData=r,n}function activate$2(e,t){var n=playerPhase(setup$1(e,t));return n.$trial.end.map(n.$resize.end.bind(null,!0)),preloadPhase$1(e,t).then(n.start),n}function harvest(e){return toCsv(createMatrix(getLogs(e)))}function getLogs(e){return lodash.reduce(e,function(e,t,n){return e.concat(harvestTask(n,t))},[])}function harvestTask(e,t){return"current"!==e&&lodash.isPlainObject(t)&&Array.isArray(t.logs)?t.logs.map(function(t){return t.taskName=e,t}):[]}function createMatrix(e){var t,n=GetIndex(),r=e.map(function(e){var t=[];return lodash.forEach(e,function(e,r){t[n(r)]="object"==typeof e?JSON.stringify(e):e}),t}),i=n();return r.forEach((t=i.length,function(e){e.length=t})),[i].concat(r)}function GetIndex(){var e={taskName:0},t=1;return function(n){return arguments.length?n in e?e[n]:e[n]=t++:lodash.keys(e)}}lodash.extend(Trial$1.prototype,{start:function(){var e=this;return e.stimulusCollection.ready.then(function(){e.$events.map(addTrialDetails(e)).map(interactions$1(e)),lodash.forEach(e._source.input,e.input.add),e.input.resetTimer(),e.$events({type:"begin",latency:0})})},end:function(){this.input.removeAll(),this.$end(!0)},name:function(){return this.alias?this.alias:this.data.alias?this.data.alias:lodash.isString(this._source.inherit)?this._source.inherit:lodash.isPlainObject(this._source.inherit)?this._source.inherit.set:void 0}});var quotableRgx=/(\n|,|")/;function toCsv(e){return e.map(buildRow).join("\n")}function buildRow(e){return e.map(normalize).join(",")}function normalize(e){return quotableRgx.test(e)?'"'+e.replace(/"/g,'""')+'"':e}var module$14=angular.module("pi.task",[]);function canvasContructor$1(e,t){var n;if(!lodash.isPlainObject(e))throw new Error("canvas(map): You must set a rule map for canvas to work properly");if(lodash.isUndefined(t))return lodash.noop;if(!lodash.isPlainObject(t))throw new Error("canvas(settings): canvas settings must be an object");return n=lodash.map(t,function(t,n){var r=e[n];if(r)return on$1(r.element,r.property,t);throw new Error("canvas("+n+"): unknow key in canvas object.")}),function(){lodash.forEach(n,function(e){e.call()})}}function on$1(e,t,n){var r=e.css(t);return e.css(t,n),lodash.bind(e.css,e,t,r)}function managerCanvasService(e,t){var n={background:{element:angular.element(t[0].body),property:"backgroundColor"},canvasBackground:{element:e,property:"backgroundColor"},fontSize:{element:e,property:"fontSize"},fontColor:{element:e,property:"color"}};return lodash.bind(canvasContructor$1,null,n)}module$14.provider("taskActivate",provider),module$14.directive("piTask",directive$10),module$14.config(["taskActivateProvider",function(e){function t(e,t,n,r,i,o){var a;return o.name&&(i.name=o.name),n.script=i,t.append("<div pi-quest></div>"),r(a=t.contents())(n),a.controller("piQuest").task.promise.finally(e),function(){a.scope().$destroy(),a.remove()}}t.$inject=["done","$element","$scope","$compile","script","task"],e.set("quest",t)}]),module$14.config(["taskActivateProvider",function(e){function t(e,t,n,r,i){var o;return r.script=n,t.append("<div pi-message></div>"),i(o=t.contents())(r),r.$on("message:done",function(){e()}),function(){r.$destroy(),o.remove()}}t.$inject=["done","$element","task","$scope","$compile"],e.set("message",t)}]),module$14.config(["taskActivateProvider",function(e){function t(e,t,n,r,i,o){var a=r.defer(),s=i.global,u=t.path?lodash.get(s,t.path):t.data;return n.post(t.url,u,{timeout:a.promise}).then(e,function(n){var r=new Error('Post error("'+t.url+'"): '+n.statusText);throw e(),o({type:"error",error:r,message:"Post error",context:t}),r}),a.resolve}t.$inject=["done","task","$http","$q","$rootScope","piConsole"],e.set("post",t)}]),module$14.config(["taskActivateProvider",function(e){function t(e,t,n,r,i){var o=r.defer(),a=harvest(i.global);return n.post(t.url,a,{timeout:o.promise}).then(e,e),o.resolve}t.$inject=["done","task","$http","$q","$rootScope"],e.set("postCsv",t)}]),module$14.config(["taskActivateProvider",function(e){function t(e,t,n){lodash.result(t,"condition",!0)?(n.deactivate(),location.href=t.url):e()}t.$inject=["done","task","managerBeforeUnload"],e.set("redirect",t)}]),module$14.config(["taskActivateProvider",function(e){function t(e,t,n,r,i){var o,a,s;return n.version>.4?(n.name&&(r.name=n.name),t.append("<div pi-player></div>"),(o=t.contents()).addClass("pi-spinner"),requirejs$1([n.baseUrl+"/dist/time.js"],function(t){(s=t(o[0],r)).onEnd(e),s.$messages.map(i),o.removeClass("pi-spinner")}),function(){o.remove(),s&&s.end()}):(a=requirejs$1.config({context:lodash.uniqueId(),baseUrl:n.baseUrl||"../bower_components/PIPlayer/dist/js",paths:{text:["//cdnjs.cloudflare.com/ajax/libs/require-text/2.0.3/text.min","../../bower_components/require-text/text"],jquery:["//cdnjs.cloudflare.com/ajax/libs/jquery/1.10.2/jquery.min","../../bower_components/jquery/dist/jquery.min"],underscore:["//cdnjs.cloudflare.com/ajax/libs/lodash.js/3.10.1/lodash.min","../../bower_components/lodash-compat/lodash.min"],backbone:["//cdnjs.cloudflare.com/ajax/libs/backbone.js/1.1.2/backbone-min","../../bower_components/backbone/backbone"]},deps:["jquery","backbone","underscore"]}),n.name&&(r.name=n.name),t.append("<div pi-player></div>"),(o=t.contents()).addClass("pi-spinner"),a(["activatePIP"],function(t){o.removeClass("pi-spinner"),t(r,e)}),function(){o.remove(),a(["app/task/main_view"],function(e){e.deferred.resolve(),e.destroy()})})}t.$inject=["done","$element","task","script","piConsole"],e.set("pip",t)}]),module$14.config(["taskActivateProvider",function(e){function t(e,t,n,r,i){var o,a;return n.name&&(r.name=n.name),t.append("<div pi-player></div>"),o=t.contents(),(a=activate$2(o[0],r)).onEnd(e),a.$messages.map(i),function(){o.remove(),a.end()}}t.$inject=["done","$element","task","script","piConsole"],e.set("time",t)}]),managerCanvasService.$inject=["$rootElement","$document"];var module$15=angular.module("pi.canvas",[]);function swapControler(e){this.$scope=e}function swapDirective(e,t,n){return{transclude:!0,controller:swapControler,controllerAs:"ctrl",compile:function(){return{pre:this.pre,post:function(){}}},pre:function(e,r,i,o,a){e.enter=function(r,i){var o=i||{};if(o.pre&&o.pre(),!r)return f(o);var l=lodash.extend(e.$new(),r);a(l,function(e){!function(e,t){if(!t)return;var r=t.split(" ");lodash.each(r,function(e){if(!n.has("."+e+"-animation"))throw new Error('Unknown animation type: "'+e+'"')}),e.addClass(t)}(e,o.animate),f(o),u=e,s=l,t.enter(u,c,null,function(){o.post&&o.post()})})},e.empty=f,e.refresh=function(e){lodash.extend(s,e)};var s,u,l,c=r;function f(e){var n=e||{};l&&(l.remove(),l=null),s&&(s.$destroy(),s=null),u&&(t.leave(u,function(){l=null,n.postLeave&&n.postLeave()}),l=u,u=null)}}}}module$15.service("managerCanvas",managerCanvasService),swapControler.$inject=["$scope"],lodash.extend(swapControler.prototype,{next:function(e,t){this.$scope.enter(e,t)},prev:function(e,t){this.$scope.enter(e,t)},refresh:function(e){this.$scope.refresh(e)},empty:function(e){this.$scope.empty(e)}}),swapDirective.$inject=["$compile","$animate","$injector"];var template$9='<div>\n\t<img ng-if="spinner" class="pi-logo" src="img/loader.gif" />\n\t<div ng-if="!spinner" ng-transclude></div>\n</div>\n';function directive$11(){return{transclude:!0,replace:!0,template:template$9,require:[],scope:{spinner:"=piSpinner"}}}directive$11.$inject=[];var module$16=angular.module("piHelperDirective",[]);function managerService(e,t,n,r,i){function o(e,t){var r=this,a=t.settings||{};if(!(this instanceof o))return new o(e,t);this.$scope=e,this.script=t,this.sequence=new n(t),function(e,t){var n,r,o=i.get("managerCanvas"),a=i.get("$document"),s=i.get("piPreloadImages"),u=i.get("managerBeforeUnload"),l=i.get("managerInjectStyle"),c=i.get("$rootElement"),f=t.skin||"default",d=i.get("piConsole");u.activate(),e.$on("$destroy",u.deactivate),n=o(t.canvas),e.$on("$destroy",n),r=l(t.injectStyle),e.$on("$destroy",r),s(t.preloadImages||[]),t.title&&(a[0].title=t.title);c.addClass(f+"-skin"),d.settings=t.DEBUG||{}}(e,a),e.$on("manager:next",function(e,t){switch(t||(t={type:"next"}),t.type){case"current":r.load(t);break;case"prev":r.prev(t);break;case"next":default:r.next(t)}}),e.$on("manager:prev",function(){r.prev()})}return lodash.extend(o.prototype,{next:function(e){this.sequence.next(),this.load(e)},prev:function(e){this.sequence.prev(),this.load(e)},current:function(){return this.sequence.current()},load:function(e){var t=this.current(),n=this.$scope,i={baseUrl:this.baseUrl,bustCache:e&&e.bustCache};t?r(t,i).then(function(){n.$emit("manager:loaded")}):n.$emit("manager:loaded")},setBaseUrl:function(e){this.baseUrl=e}}),o}function sequenceProvider(e,t,n,r){function i(o){var a,s;if(!(this instanceof i))return new i(o);(a=this.db=new e).createColl("tasks"),a.add("tasks",o.tasksSets||[]),s={global:t.global},lodash.extend(n,s),lodash.extend(r,s),this.sequence=a.sequence("tasks",o.sequence)}return lodash.extend(i.prototype,{next:function(){return this.sequence.next(),this},prev:function(){return this.sequence.prev(),this},current:function(){return this.sequence.current()}}),i}function managerLoadService(e,t){return function(n){var r=lodash.isString(n)?t(n):n;return e.when(r)}}function getScriptProvider(){var e=lodash.memoize(function(e){return new Promise(function(t,n){var r=new XMLHttpRequest;r.open("GET",e,!0),r.onreadystatechange=function(){4===this.readyState&&(this.status>=200&&this.status<400?t(this.responseText):n(new Error("Failed posting to: "+e)))},r.send()})});return function(t,n){n||(n={});var r,i=(o=t,a=n,s="",a.baseUrl&&!/^\/|:/.test(o)&&(s+=a.baseUrl+"/"),s+=o,a.bustCache&&(s+="?bust="+ +new Date),s);var o,a,s;return n.isText?e(i):(r=i,new Promise(function(e,t){require([r],e,t)}))}}function taskLoadService(e,t,n){function r(e,r){return t(e,r).then(function(t){if(!lodash.isUndefined(t))return t;var r=new Error("Could not load task "+e);throw n({tags:"task",type:"error",message:"Make sure that you returned the script and that your script does not have any errors",error:r}),r})}return function(t,i){var o,a,s;return a=t.scriptUrl?r(t.scriptUrl,i):t.script,s=t.templateUrl?r(t.templateUrl,lodash.extend({isText:!0},i)):t.template,(o=e.all({script:e.when(a),template:e.when(s)})).then(function(e){return t.$script=e.script,t.$template=e.template,t},function(e){throw n({tags:"load",type:"error",message:"Failed to load task script - make sure that your URLs are all correct and that your script does not have any errors.",context:t}),e}),o}}module$16.directive("piSwap",swapDirective),module$16.directive("piSpinner",directive$11),managerService.$inject=["$rootScope","$q","managerSequence","managerTaskLoad","$injector"],sequenceProvider.$inject=["Database","$rootScope","mixerDefaultContext","templateDefaultContext"],managerLoadService.$inject=["$q","managerGetScript"],taskLoadService.$inject=["$q","managerGetScript","piConsole"];var addEvent$1=window.attachEvent||window.addEventListener,removeEvent$1=window.detachEvent||window.removeEventListener,chkevent=window.attachEvent?"onbeforeunload":"beforeunload",proto={activate:function(){addEvent$1(chkevent,leaveEvent)},deactivate:function(){removeEvent$1(chkevent,leaveEvent)}};function leaveEvent(e){var t="Are you sure you want to leave this page? You may have some unsaved data here.";return(e||window.event).returnValue=t,t}function beforeunloadFactory(){return lodash.create(proto)}function injectStyle(e){var t=document.head||document.querySelector("head"),n=document.createElement("style");return n.type="text/css",n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e)),t.appendChild(n),function(){t.removeChild(n)}}function managerControler(e,t,n,r){this.init=function(i){var o,a=this;try{o=e.$eval(i)}catch(e){}finally{o||(o=i)}n(o).then(function(n){e.script=n,e.settings=n&&n.settings||{},a.manager=new t(e,n),a.manager.setBaseUrl((r=o,lodash.isString(r)?r.substring(0,r.lastIndexOf("/")):void 0)),e.$emit("manager:next");var r},function(e){r({type:"error",message:"Failed to load "+o,tags:["manager"],error:e})})}}function directive$12(e,t,n){return{priority:1e3,replace:!0,template:["<div pi-swap ng-cloak ng-class=\"{'pi-spinner':loading}\">",'<div ng-bind-html="task.preText"></div>','<div pi-task="task"></div>','<div ng-bind-html="task.postText"></div>',"</div>"].join("\n"),controller:managerControler,require:["piManager","piSwap"],link:function(r,i,o,a){var s,u,l=a[1],c=a[0];function f(r,i){var o=e.when();lodash(r).map(function(n){return function(){var r=lodash.isFunction(n)?t.invoke(n,null,i||{}):n;return e.when(r)}}).reduce(function(e,t){return e.then(t,function(e){n({type:"error",message:"There was an error in the task sequence.",tags:["manager"],error:e})})},o)}c.init(o.piManager),r.$on("manager:loaded",function(){r.loading=!1,u=s,s=c.manager.current(),n({tags:["manager"],type:"debug",message:"Manager:currentTask",context:s}),s?(t={prevTask:u,currentTask:s,managerSettings:r.settings},f([r.settings.onPreTask,lodash.get(u,"post"),s.pre,lodash.bind(l.next,l,{task:s,settings:r.settings}),s.load,function(){r.loading=!1}],t)):(e={prevTask:u,currentTask:s},f([u&&u.post,lodash.bind(l.empty,l),r.settings.onEnd,function(){r.loading=!1,r.$emit("manager:done"),r.$destroy()}],e));var e;var t}),r.$on("task:done",function(e,t){e.stopPropagation(),r.loading=!0,r.$emit("manager:next",t)}),r.loading=!0}}}function directive$13(){return{priority:1e3,template:'<div pi-manager="script"></div>',compile:function(){return{pre:function(e,t,n){var r,i=n.piManagerTask;try{r=e.$eval(i)}catch(e){}var o=r||{scriptUrl:i};e.script={sequence:[{script:["done","managerBeforeUnload",function(e,t){t.deactivate(),e()}]},o]}}}}}}function piLinkDirective(e){return{link:function(t,n){n.on("click",function(){e.deactivate()})}}}managerControler.$inject=["$scope","managerService","managerLoad","piConsole"],directive$12.$inject=["$q","$injector","piConsole"],piLinkDirective.$inject=["managerBeforeUnload"];var module$13=angular.module("taskManager",[module$14.name,module$15.name,module$10.name,module$16.name,module$7.name]),Pqb,Qqb,Rqb;module$13.service("managerService",managerService),module$13.service("managerSequence",sequenceProvider),module$13.service("managerLoad",managerLoadService),module$13.service("managerGetScript",getScriptProvider),module$13.service("managerTaskLoad",taskLoadService),module$13.factory("managerBeforeUnload",beforeunloadFactory),module$13.constant("managerInjectStyle",injectStyle),module$13.directive("piManager",directive$12),module$13.directive("piManagerTask",directive$13),module$13.directive("piLink",piLinkDirective),Pqb=window,Qqb=window.angular,Qqb.module("ngAnimate",["ng"]).directive("ngAnimateChildren",function(){var e="$$ngAnimateChildren";return function(t,n,r){var i=r.ngAnimateChildren;Qqb.isString(i)&&0===i.length?n.data(e,!0):t.$watch(i,function(t){n.data(e,!!t)})}}).factory("$$animateReflow",["$$rAF","$document",function(e,t){var n=t[0].body;return function(t){return e(function(){n.offsetWidth,t()})}}]).config(["$provide","$animateProvider",function(e,t){var n=Qqb.noop,r=Qqb.forEach,i=t.$$selectors,o=1,a="$$ngAnimateState",s="$$ngAnimateChildren",u="ng-animate",l={running:!0};function c(e){for(var t=0;t<e.length;t++){var n=e[t];if(n.nodeType==o)return n}}function f(e){return e&&Qqb.element(e)}function d(e){return Qqb.element(c(e))}function p(e,t){return c(e)==c(t)}e.decorator("$animate",["$delegate","$injector","$sniffer","$rootElement","$$asyncCallback","$rootScope","$document",function(e,o,h,m,v,g,$){var y=0;m.data(a,l),g.$$postDigest(function(){g.$$postDigest(function(){l.running=!1})});var w=t.classNameFilter(),b=w?function(e){return w.test(e)}:function(){return!0};function x(e){var t=e.data(a)||{};t.running=!0,e.data(a,t)}function C(e,t,a){var s=e[0];if(s){var u,l,c="setClass"==t,f=c||"addClass"==t||"removeClass"==t;Qqb.isArray(a)&&(u=a[0],l=a[1],a=u+" "+l);var d=e.attr("class")+" "+a;if(b(d)){var p=n,m=[],v=[],g=n,$=[],y=[],w=(" "+d).replace(/\s+/g,".");return r(function(e){if(e){var t=[],n={},r=e.substr(1).split(".");(h.transitions||h.animations)&&t.push(o.get(i[""]));for(var a=0;a<r.length;a++){var s=r[a],u=i[s];u&&!n[s]&&(t.push(o.get(u)),n[s]=!0)}return t}}(w),function(e){!x(e,t)&&c&&(x(e,"addClass"),x(e,"removeClass"))}),{node:s,event:t,className:a,isClassBased:f,isSetClassOperation:c,before:function(e){p=e,C(v,m,function(){p=n,e()})},after:function(e){g=e,C(y,$,function(){g=n,e()})},cancel:function(){m&&(r(m,function(e){(e||n)(!0)}),p(!0)),$&&(r($,function(e){(e||n)(!0)}),g(!0))}}}}function x(e,t){var n=e[t],r=e["before"+t.charAt(0).toUpperCase()+t.substr(1)];if(n||r)return"leave"==t&&(r=n,n=null),y.push({event:t,fn:n}),v.push({event:t,fn:r}),!0}function C(t,i,o){var s=[];r(t,function(e){e.fn&&s.push(e)});var c=0;r(s,function(t,r){var f=function(){!function(e){if(i){if((i[e]||n)(),++c<s.length)return;i=null}o()}(r)};switch(t.event){case"setClass":i.push(t.fn(e,u,l,f));break;case"addClass":i.push(t.fn(e,u||a,f));break;case"removeClass":i.push(t.fn(e,l||a,f));break;default:i.push(t.fn(e,f))}}),i&&0===i.length&&o()}}return{enter:function(t,r,i,o){t=Qqb.element(t),r=f(r),i=f(i),x(t),e.enter(t,r,i),g.$$postDigest(function(){S("enter","ng-enter",t=d(t),r,i,n,o)})},leave:function(t,n){E(t=Qqb.element(t)),x(t),g.$$postDigest(function(){S("leave","ng-leave",d(t),null,null,function(){e.leave(t)},n)})},move:function(t,r,i,o){t=Qqb.element(t),r=f(r),i=f(i),E(t),x(t),e.move(t,r,i),g.$$postDigest(function(){S("move","ng-move",t=d(t),r,i,n,o)})},addClass:function(t,n,r){t=d(t=Qqb.element(t)),S("addClass",n,t,null,null,function(){e.addClass(t,n)},r)},removeClass:function(t,n,r){t=d(t=Qqb.element(t)),S("removeClass",n,t,null,null,function(){e.removeClass(t,n)},r)},setClass:function(t,n,r,i){t=d(t=Qqb.element(t)),S("setClass",[n,r],t,null,null,function(){e.setClass(t,n,r)},i)},enabled:function(e,t){switch(arguments.length){case 2:if(e)q(t);else{var n=t.data(a)||{};n.disabled=!0,t.data(a,n)}break;case 1:l.disabled=!e;break;default:e=!l.disabled}return!!e}};function S(e,t,n,i,o,c,f){var d=C(n,e,t);if(!d)return D(),M(),T(),void O();t=d.className;var h=Qqb.element._data(d.node);h=h&&h.events,i||(i=o?o.parent():n.parent());var g,$=n.data(a)||{},w=$.active||{},b=$.totalActive||0,x=$.last;if(d.isClassBased&&(g=$.running||$.disabled||x&&!x.isClassBased),g||function(e,t){if(l.disabled)return!0;if(p(e,m))return l.running;var n,r,i;do{if(0===t.length)break;var o=p(t,m),u=o?l:t.data(a)||{};if(u.disabled)return!0;if(o&&(i=!0),!1!==n){var c=t.data(s);Qqb.isDefined(c)&&(n=c)}r=r||u.running||u.last&&!u.last.isClassBased}while(t=t.parent());return!i||!n&&r}(n,i))return D(),M(),T(),void O();var S=!1;if(b>0){var E=[];if(d.isClassBased){if("setClass"==x.event)E.push(x),q(n,t);else if(w[t]){var k=w[t];k.event==e?S=!0:(E.push(k),q(n,t))}}else if("leave"==e&&w["ng-leave"])S=!0;else{for(var _ in w)E.push(w[_]),q(n,_);w={},b=0}E.length>0&&r(E,function(e){e.cancel()})}if(!d.isClassBased||d.isSetClassOperation||S||(S="addClass"==e==n.hasClass(t)),S)return D(),M(),T(),void j();"leave"==e&&n.one("$destroy",function(e){var t=Qqb.element(this),n=t.data(a);if(n){var r=n.active["ng-leave"];r&&(r.cancel(),q(t,"ng-leave"))}}),n.addClass(u);var A=y++;function P(r){var i="$animate:"+r;h&&h[i]&&h[i].length>0&&v(function(){n.triggerHandler(i,{event:e,className:t})})}function M(){P("before")}function T(){P("after")}function j(){P("close"),f&&v(function(){f()})}function D(){D.hasBeenRun||(D.hasBeenRun=!0,c())}function O(){if(!O.hasBeenRun){O.hasBeenRun=!0;var e=n.data(a);e&&(d&&d.isClassBased?q(n,t):(v(function(){var e=n.data(a)||{};A==e.index&&q(n,t)}),n.data(a,e))),j()}}b++,w[t]=d,n.data(a,{last:d,active:w,index:A,totalActive:b}),M(),d.before(function(r){var i=n.data(a);r=r||!i||!i.active[t]||d.isClassBased&&i.active[t].event!=e,D(),!0===r?O():(T(),d.after(O))})}function E(e){var t=c(e);if(t){var n=Qqb.isFunction(t.getElementsByClassName)?t.getElementsByClassName(u):t.querySelectorAll("."+u);r(n,function(e){var t=(e=Qqb.element(e)).data(a);t&&t.active&&r(t.active,function(e){e.cancel()})})}}function q(e,t){if(p(e,m))l.disabled||(l.running=!1,l.structural=!1);else if(t){var n=e.data(a)||{},r=!0===t;!r&&n.active&&n.active[t]&&(n.totalActive--,delete n.active[t]),!r&&n.totalActive||(e.removeClass(u),e.removeData(a))}}}]),t.register("",["$window","$sniffer","$timeout","$$animateReflow",function(e,t,i,a){var s,u,l,f,d="";Pqb.ontransitionend===Rqb&&Pqb.onwebkittransitionend!==Rqb?(d="-webkit-",s="WebkitTransition",u="webkitTransitionEnd transitionend"):(s="transition",u="transitionend"),Pqb.onanimationend===Rqb&&Pqb.onwebkitanimationend!==Rqb?(d="-webkit-",l="WebkitAnimation",f="webkitAnimationEnd animationend"):(l="animation",f="animationend");var p,h="Duration",m="Property",v="Delay",g="IterationCount",$="$$ngAnimateKey",y="$$ngAnimateCSS3Data",w="ng-animate-block-transitions",b=3,x=1.5,C=1e3,S={},E=0,q=[];function k(){p||(p=a(function(){q=[],p=null,S={}}))}function _(e,t){p&&p(),q.push(t),p=a(function(){r(q,function(e){e()}),q=[],p=null,S={}})}var A=null,P=0,M=[];function T(e,t){var o=c(e);e=Qqb.element(o),M.push(e);var a=Date.now()+t;a<=P||(i.cancel(A),P=a,A=i(function(){r(M,function(e){var t=e.data(y);t&&(t.closeAnimationFn||n)()}),M=[]},t,!1))}function j(t,n){var i=n?S[n]:null;if(!i){var a,u,c,f,d=0,p=0,$=0,y=0;r(t,function(t){if(t.nodeType==o){var n=e.getComputedStyle(t)||{};c=n[s+h],d=Math.max(D(c),d),f=n[s+m],a=n[s+v],p=Math.max(D(a),p),u=n[l+v],y=Math.max(D(u),y);var r=D(n[l+h]);r>0&&(r*=parseInt(n[l+g],10)||1),$=Math.max(r,$)}}),i={total:0,transitionPropertyStyle:f,transitionDurationStyle:c,transitionDelayStyle:a,transitionDelay:p,transitionDuration:d,animationDelayStyle:u,animationDelay:y,animationDuration:$},n&&(S[n]=i)}return i}function D(e){var t=0,n=Qqb.isString(e)?e.split(/\s*,\s*/):[];return r(n,function(e){t=Math.max(parseFloat(e)||0,t)}),t}function O(e,t,r,i){var o,a,u,f=(a=(o=t).parent(),(u=a.data($))||(a.data($,++E),u=E),u+"-"+c(o).getAttribute("class")),d=f+" "+r,p=S[d]?++S[d].total:0,h={};if(p>0){var v=r+"-stagger",g=f+" "+v,b=!S[g];b&&t.addClass(v),h=j(t,g),b&&t.removeClass(v)}i=i||function(e){return e()},t.addClass(r);var x=t.data(y)||{},C=i(function(){return j(t,d)}),q=C.transitionDuration,k=C.animationDuration;if(0===q&&0===k)return t.removeClass(r),!1;t.data(y,{running:x.running||0,itemIndex:p,stagger:h,timings:C,closeAnimationFn:n});var _,A,P,M=x.running>0||"setClass"==e;return q>0&&(_=t,A=M,"ng-enter"!=(P=r)&&"ng-move"!=P&&"ng-leave"!=P&&A?_.addClass(w):c(_).style[s+m]="none"),k>0&&h.animationDelay>0&&0===h.animationDuration&&(c(t).style[l]="none 0s"),!0}function R(e,t){var n=s+m,r=c(e);r.style[n]&&r.style[n].length>0&&(r.style[n]=""),e.removeClass(w)}function N(e){var t=l,n=c(e);n.style[t]&&n.style[t].length>0&&(n.style[t]="")}function F(e,t,n){var i="";return r(e.split(","),function(e,r){i+=(r>0?",":"")+(n*t+parseInt(e,10))+"s"}),i}function I(e,t,n,r){if(O(e,t,n,r))return function(e){e&&V(t,n)}}function U(e,t,n,i){if(t.data(y))return function(e,t,n,i){var o=c(t),a=t.data(y);if(-1!=o.getAttribute("class").indexOf(n)&&a){var s="";r(n.split(" "),function(e,t){s+=(t>0?" ":"")+e+"-active"});var l=a.stagger,p=a.timings,h=a.itemIndex,m=Math.max(p.transitionDuration,p.animationDuration),v=Math.max(p.transitionDelay,p.animationDelay),g=v*C,$=Date.now(),w=f+" "+u,S="",E=[];if(p.transitionDuration>0){var q=p.transitionPropertyStyle;-1==q.indexOf("all")&&(S+=d+"transition-property: "+q+";",S+=d+"transition-duration: "+p.transitionDurationStyle+";",E.push(d+"transition-property"),E.push(d+"transition-duration"))}if(h>0){if(l.transitionDelay>0&&0===l.transitionDuration){var k=p.transitionDelayStyle;S+=d+"transition-delay: "+F(k,l.transitionDelay,h)+"; ",E.push(d+"transition-delay")}l.animationDelay>0&&0===l.animationDuration&&(S+=d+"animation-delay: "+F(p.animationDelayStyle,l.animationDelay,h)+"; ",E.push(d+"animation-delay"))}if(E.length>0){var _=o.getAttribute("style")||"";o.setAttribute("style",_+"; "+S)}t.on(w,M),t.addClass(s),a.closeAnimationFn=function(){P(),i()};var A=(h*(Math.max(l.animationDelay,l.transitionDelay)||0)+(v+m)*x)*C;return a.running++,T(t,A),P}function P(e){t.off(w,M),t.removeClass(s),V(t,n);var r=c(t);for(var i in E)r.style.removeProperty(E[i])}function M(e){e.stopPropagation();var t=e.originalEvent||e,n=t.$manualTimeStamp||t.timeStamp||Date.now(),r=parseFloat(t.elapsedTime.toFixed(b));Math.max(n-$,0)>=g&&r>=m&&i()}i()}(0,t,n,i);V(t,n),i()}function L(e,t,r,i){var o=I(e,t,r);if(!o)return k(),void i();var a=o;return _(0,function(){R(t),N(t),a=U(0,t,r,i)}),function(e){(a||n)(e)}}function V(e,t){e.removeClass(t);var n=e.data(y);n&&(n.running&&n.running--,n.running&&0!==n.running||e.removeData(y))}return{enter:function(e,t){return L("enter",e,"ng-enter",t)},leave:function(e,t){return L("leave",e,"ng-leave",t)},move:function(e,t){return L("move",e,"ng-move",t)},beforeSetClass:function(e,t,n,r){var i=B(n,"-remove")+" "+B(t,"-add"),o=I("setClass",e,i,function(r){var i=e.attr("class");e.removeClass(n),e.addClass(t);var o=r();return e.attr("class",i),o});if(o)return _(0,function(){R(e),N(e),r()}),o;k(),r()},beforeAddClass:function(e,t,n){var r=I("addClass",e,B(t,"-add"),function(n){e.addClass(t);var r=n();return e.removeClass(t),r});if(r)return _(0,function(){R(e),N(e),n()}),r;k(),n()},setClass:function(e,t,n,r){return U(0,e,(n=B(n,"-remove"))+" "+(t=B(t,"-add")),r)},addClass:function(e,t,n){return U(0,e,B(t,"-add"),n)},beforeRemoveClass:function(e,t,n){var r=I("removeClass",e,B(t,"-remove"),function(n){var r=e.attr("class");e.removeClass(t);var i=n();return e.attr("class",r),i});if(r)return _(0,function(){R(e),N(e),n()}),r;n()},removeClass:function(e,t,n){return U(0,e,B(t,"-remove"),n)}};function B(e,t){var n="";return e=Qqb.isArray(e)?e:e.split(/\s+/),r(e,function(e,r){e&&e.length>0&&(n+=(r>0?" ":"")+e+t)}),n}}])}]);for(var vendors=["webkit","moz"],i=0;i<vendors.length&&!window.requestAnimationFrame;++i){var vp=vendors[i];window.requestAnimationFrame=window[vp+"RequestAnimationFrame"],window.cancelAnimationFrame=window[vp+"CancelAnimationFrame"]||window[vp+"CancelRequestAnimationFrame"]}if(/iP(ad|hone|od).*OS 6/.test(window.navigator.userAgent)||!window.requestAnimationFrame||!window.cancelAnimationFrame){var lastTime=0;window.requestAnimationFrame=function(e){var t=+new Date,n=Math.max(lastTime+16,t);return setTimeout(function(){e(lastTime=n)},n-t)},window.cancelAnimationFrame=clearTimeout}function animation(e,t){var n=60,r=300,i=e.requestAnimationFrame,o=e.cancelAnimationFrame;return{enter:function(e,a){var s,u=e[0],l=t();return e.css({top:-n+"px"}),s=i(function e(){var c=t()-l;var f=c/r;if(c>r)return u.style.top=0,o(s),void a();u.style.top=n*(f-1)+"px";s=i(e)}),function(t){t&&(o(s),e.css({top:"0px"}))}},leave:function(e,a){var s,u=e[0],l=t();return s=i(function e(){var c=t()-l;var f=1-c/r;if(c>r)return o(s),void a();u.style.top=n*(f-1)+"px";s=i(e)}),function(e){e&&o(s)}}}}var dropInAnimation=["$window","timerNow",animation];function animation$1(e,t){var n=300,r=e.requestAnimationFrame,i=e.cancelAnimationFrame;return{enter:function(e,o){var a,s=e[0],u=t();return s.style.opacity=0,a=r(function e(){var l=t()-u;var c=l/n;if(l>n)return s.style.opacity=1,i(a),void o();s.style.opacity=c;a=r(e)}),function(e){e&&(i(a),s.style.opacity=1)}},leave:function(e,o){var a,s=e[0],u=t();return a=r(function e(){var l=t()-u;var c=1-l/n;if(l>n)return s.style.opacity=0,i(a),void o();s.style.opacity=c;a=r(e)}),function(e){e&&(i(a),s.style.opacity=0)}}}}var fadeAnimation=["$window","timerNow",animation$1];function animation$2(e,t){var n=300,r=e.requestAnimationFrame,i=e.cancelAnimationFrame;return{enter:function(e,o){var a,s=e[0],u=t();return s.style.left="-100%",a=r(function e(){var l=t()-u;var c=1-l/n;if(l>n)return s.style.left="0%",i(a),void o();s.style.left=100*-c+"%";a=r(e)}),function(e){e&&(i(a),s.style.left="0%")}},leave:function(e,o){var a,s=e[0],u=t();return a=r(function e(){var l=t()-u;var c=l/n;if(l>n)return s.style.left="100%",i(a),void o();s.style.left=100*c+"%";a=r(e)}),function(e){e&&(i(a),s.style.left="100%")}}}}var slideAnimation=["$window","timerNow",animation$2],module$17=angular.module("pi.animate",["ngAnimate"]);module$17.animation(".drop-in",dropInAnimation),module$17.animation(".fade",fadeAnimation),module$17.animation(".slide",slideAnimation);var module$18=angular.module("piConsole",[]);function piConsoleFactory$2(e){return window.DEBUG?function t(n){if(lodash.get(t,"settings.hideConsole",!1))return window.postMessage({type:"kill-console"},"*");e[n.type]&&e[n.type](n.message);window.postMessage((r=n,lodash.cloneDeep(r,function(e){return lodash.isFunction(e)?e.toString():lodash.isError(e)?{name:e.name,message:e.message,stack:e.stack}:void 0})),"*");var r}:lodash.noop}module$18.factory("piConsole",piConsoleFactory$2),piConsoleFactory$2.$inject=["$log"],window.require=require,window.requirejs=requirejs$1,window.define=define;var submodules=[module$1.name,module$12.name,module$13.name,module$17.name,module$18.name],app$1=angular.module("piApp",submodules);function activate$1(e){angular.bootstrap(e,[app$1.name])}return app$1.run(["$rootScope","$rootElement","$parse","$window",function(e,t,n,r){var i=n(t.attr("pi-global"))(r);window.piGlobal||(window.piGlobal={}),e.global=window.piGlobal,i&&lodash.extend(e.global,i)}]),app$1.config(["$provide",function(e){"function"!=typeof Object.getPrototypeOf&&(Object.getPrototypeOf="object"==typeof"test".__proto__?function(e){return e.__proto__}:function(e){return e.constructor.prototype});e.decorator("$rootScope",["$delegate",function(e){var t=Object.getPrototypeOf(e);return t.$new=function(n){var r;return n?((r=new t.constructor).$root=this.$root,r.$$asyncQueue=this.$$asyncQueue,r.$$postDigestQueue=this.$$postDigestQueue):(this.$$childScopeClass||(this.$$childScopeClass=function(){this.$$watchers=this.$$nextSibling=this.$$childHead=this.$$childTail=null,this.$$listeners={},this.$$listenerCount={},this.$id=++e.$id,this.$$childScopeClass=null},this.$$childScopeClass.prototype=this),r=new this.$$childScopeClass),r.this=r,r.$parent=this,r.$$prevSibling=this.$$childTail,this.$$childHead?(this.$$childTail.$$nextSibling=r,this.$$childTail=r):this.$$childHead=this.$$childTail=r,r},e.$new=t.$new,e}])}]),define("managerAPI",lodash.constant(manager)),define("timeAPI",lodash.constant(api$1)),define("pipAPI",lodash.constant(api$1)),define("questAPI",lodash.constant(quest)),define("minno-sequencer",lodash.constant(Database$2)),define("lodash",lodash.constant(lodash)),define("underscore",lodash.constant(lodash)),define("angular",lodash.constant(angular)),define("pipScorer",lodash.constant(Scorer)),define("dscore",lodash.constant(Scorer)),angular.element(document).ready(function(){var e=document.getElementById("minno-app");e&&activate$1(e)}),activate$1}();
//# sourceMappingURL=minno.js.map
