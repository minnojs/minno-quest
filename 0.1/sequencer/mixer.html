<!DOCTYPE html>
<html lang="en">
	<head>

		<!-- Meta, title, CSS, favicons, etc. -->
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta name="description" content="Bootstrap, a sleek, intuitive, and powerful mobile first front-end framework for faster and easier web development.">
		<meta name="keywords" content="HTML, CSS, JS, JavaScript, framework, bootstrap, front-end, frontend, web development">
		<meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">

		<title>
			
				Basics
			
			&middot; V0.0
		</title>

		
		<!-- Bootstrap core CSS -->
		<link href="../../bower_components/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
		<link href="../css/highlight.css" rel="stylesheet">
		<link href="../css/style.css" rel="stylesheet">
		<style type="text/css">
			pre {display:block;overflow-x:auto;padding:0.5em;background:#000;color:#f8f8f8;-webkit-text-size-adjust:none}
			table {padding: 0;}
			table tr {border-top: 1px solid #cccccc;background-color: white;margin: 0;padding: 0;}
			table tr:nth-child(2n) {background-color: #f8f8f8;}
			table tr th {font-weight: bold;border: 1px solid #cccccc;text-align: left;margin: 0;padding: 6px 13px;}
			table tr td {border: 1px solid #cccccc;text-align: left;margin: 0;padding: 6px 13px;}
			table tr th :first-child, table tr td :first-child {margin-top: 0;}
			table tr th :last-child, table tr td :last-child {margin-bottom: 0;}
		</style>
		

		<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
		<!--[if lt IE 9]>
			<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
			<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
		<![endif]-->

		<!-- Favicons -->
		<link rel="apple-touch-icon" href="../apple-touch-icon.png">
		<link rel="icon" href="../favicon.ico">

	</head>

	<body>
		<a id="skippy" class="sr-only sr-only-focusable" href="#content"><div class="container"><span class="skiplink-text">Skip to main content</span></div></a>

		<!-- Docs master nav -->
		<header class="navbar navbar-static-top bs-docs-nav" id="top" role="banner">
			<div class="container">
				<div class="navbar-header">
					<button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target=".bs-navbar-collapse">
						<span class="sr-only">Toggle navigation</span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</button>
					<a href="../../" class="navbar-brand">Minno</a>
				</div>
				<nav class="collapse navbar-collapse bs-navbar-collapse">
					<ul class="nav navbar-nav">
						<li class=" active ">
							<a href="../basics/overview.html">Basics</a>
						</li>
						<li class="">
							<a href="../quest/overview.html">piQuest</a>
						</li>
						<li class="">
							<a href="../manager/overview.html">piManager</a>
						</li>
						<li>
							<a href="/PIPlayer">piPlayer</a>
						</li>
					</ul>
					<ul class="nav navbar-nav navbar-right">
						<li>
							<form class="navbar-form navbar-left" role="search" method="get" action="http://www.google.com/search">
							  <div class="form-group">
							    <input type="text" class="form-control" placeholder="Search" name="q" size="25" maxlength="255">
							  </div>
							  <button type="submit" class="btn btn-default" value="Google Search">
							    <span class="glyphicon glyphicon-search" aria-hidden="true"></span>
							  </button>
							  <input type="hidden" name="sitesearch" value="projectimplicit.github.io" checked />
							</form>
						</li>

						<li>
                            <form class="navbar-form navbar-left" role="search">
                                <div class="form-group">
                                    <select class="form-control" id="version-select">
                                        <option value="0.0">v0.0</option>
                                        <option value="0.1" selected>v0.1</option>
                                    </select>
                                </div>
                            </form>
                        </li>

                        <li><a href="https://github.com/ProjectImplicit/PIquest">Github</a></li>
                    </ul>
                </nav>
            </div>
        </header>

        <div id="content" class="bs-docs-header">
            <div class="container">
                
	<h1>Mixers</h1>
	<p>Controlling the flow of the sequence</p>

            </div>
		</div>

		<div class="container bs-docs-container">
			<div class="row">
				<div class="col-md-9" role="main">
					
	<!-- START doctoc generated TOC please keep comment here to allow auto update -->
<!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->
<ul>
<li><a href="#introduction">Introduction</a><ul>
<li><a href="#syntax">Syntax</a></li>
<li><a href="#nesting">Nesting</a></li>
<li><a href="#real-time-remix">Real time (remix)</a></li>
<li><a href="#sequence-evaluation-wrapper">Sequence evaluation (wrapper)</a></li>
</ul>
</li>
<li><a href="#mixer-types">Mixer types</a><ul>
<li><a href="#repeat">repeat</a></li>
<li><a href="#random">random</a></li>
<li><a href="#choose">choose</a></li>
<li><a href="#weightedchoose">weightedChoose</a></li>
<li><a href="#weightedrandom">weightedRandom</a></li>
<li><a href="#wrapper">wrapper</a></li>
<li><a href="#branch">branch</a></li>
<li><a href="#multibranch">multiBranch</a></li>
</ul>
</li>
<li><a href="#conditions">Conditions</a><ul>
<li><a href="#operators">Operators</a></li>
<li><a href="#aggregation">Aggregation</a></li>
<li><a href="#debugging">Debugging</a></li>
</ul>
</li>
</ul>
<!-- END doctoc generated TOC please keep comment here to allow auto update -->
<h3><a name="introduction" class="header-link" href="#introduction"><span class="glyphicon glyphicon-link"></span></a>Introduction</h3><p>Mixers allow you to control the flow of your sequences within the PI tasks.
In particular they allow you to repeat, randomize and even branch sections of your sequence according to <a href="./variables.html">environmental variables</a>.</p>
<h4><a name="syntax" class="header-link" href="#syntax"><span class="glyphicon glyphicon-link"></span></a>Syntax</h4><p>Each one of the PI tasks is composed of a sequence of elements that is presented sequentially.
For example, the sequence in piManager is composed of elements that each represent a task.
These sequences are created using the <code>API.addSequence</code> method in your script.
Mixers are inserted into the sequence the same way that regular elements are. 
Each mixer represents a sub-sequence that is to be manipulated and then inserted in its place.</p>
<p>For example, in the following sequence the second element is a mixer.
It takes a sub-sequence than includes tasks two and three and randomizes their order.
Note that the mixer element is effectively replaced by the two elements from the sub-sequence, turning this sequence into a four task sequence.</p>
<pre><code class="lang-js">// <span class="hljs-type">The</span> task sequence
<span class="hljs-type">API</span>.addSequence([
    // <span class="hljs-type">First</span> <span class="hljs-type">Element</span>: task <span class="hljs-number">1</span>
    {<span class="hljs-keyword">type</span>:'message', <span class="hljs-keyword">template</span>: '<span class="hljs-type">Task</span> <span class="hljs-number">2</span>', keys: ' '},

    // <span class="hljs-type">Second</span> <span class="hljs-type">Element</span>: the mixer (task <span class="hljs-number">2</span> <span class="hljs-keyword">and</span> <span class="hljs-number">3</span> randomized)
    {
        mixer: 'random',
        data: [
            {<span class="hljs-keyword">type</span>:'message', <span class="hljs-keyword">template</span>: '<span class="hljs-type">Task</span> <span class="hljs-number">2</span>', keys: ' '},
            {<span class="hljs-keyword">type</span>:'message', <span class="hljs-keyword">template</span>: '<span class="hljs-type">Task</span> <span class="hljs-number">3</span>', keys: ' '}
        ]
    },

    // <span class="hljs-type">Third</span> <span class="hljs-type">Element</span>: task <span class="hljs-number">4</span>
    {<span class="hljs-keyword">type</span>:'message', <span class="hljs-keyword">template</span>: '<span class="hljs-type">Task</span> <span class="hljs-number">4</span>', keys: ' '}
]);
</code></pre>
<p>Each mixer has a type associated with it as well as at least one sub-sequence.
The <code>mixer</code> property always holds the mixer type (see below for the available types).
In most cases the <code>data</code> property holds the sub-sequence (the exception is with the branching mixers that may hold multiple sub-sequences).</p>
<p>A typical mixer looks something like this: </p>
<pre><code class="lang-js">{
    mixer: 'random',     // &lt;== The mixer type<span class="hljs-function"> (</span>randomize in this case<span class="hljs-function">)</span>
    data: <span class="hljs-keyword">[</span>elem1, elem2]    // &lt;== The<span class="hljs-instruction"> sub-sequence </span>(holding elem1<span class="hljs-instruction"> and </span>elem2<span class="hljs-function">)</span>
}
</code></pre>
<p>From now on, instead of explicitly writing in the mixed elements we will use arbitrary variable names instead, such as <code>elem1</code> and <code>elem2</code>. 
We are doing this to keep the structures as simple and readable as possible.</p>
<h4><a name="nesting" class="header-link" href="#nesting"><span class="glyphicon glyphicon-link"></span></a>Nesting</h4><p>Mixers may be nested inside each other as much as you like. The following example illustrates a more complex example.
Here, we have an opening and ending element (<code>firstelem</code> and <code>lastelem</code>).
Between them we repeat a set of four elements ten times.
The order within the four objects is randomized, so that <code>elem1</code> always comes first and the order of the following elements is randomized but <code>elem3</code> and <code>elem4</code> are wrapped together and therefore always stay consecutive.</p>
<pre><code class="lang-js">API.addSequence([
    <span class="hljs-comment">// The first element</span>
    firstelem,

    <span class="hljs-comment">// Repeat the structure inside 10 time (so we get 40 objects overall)</span>
    {
        mixer: <span class="hljs-string">'repeat'</span>,
        wrapper:true, <span class="hljs-comment">// Delay the mixing of these elements until after the `repeat`.</span>
        times: <span class="hljs-number">10</span>,
        <span class="hljs-keyword">data</span>: [
            elem1,

            <span class="hljs-comment">// Randomize the order of the elements within.</span>
            {
                mixer: <span class="hljs-string">'random'</span>,
                <span class="hljs-keyword">data</span>: [
                    elem2,
                    <span class="hljs-comment">// Keep obj 3 and 4 together.</span>
                    {
                        mixer: <span class="hljs-string">'wrapper'</span>,
                        <span class="hljs-keyword">data</span>: [
                            elem3,
                            elem4
                        ]
                    }
                ]
            } <span class="hljs-comment">// end random</span>
        ]
    }, <span class="hljs-comment">// end repeat</span>

    <span class="hljs-comment">// the last element</span>
    lastelem
]);
</code></pre>
<h4><a name="real-time-remix" class="header-link" href="#real-time-remix"><span class="glyphicon glyphicon-link"></span></a>Real time (remix)</h4><p>By default each mixer is processed only once, when it is first encountered during the sequence. 
There are only two conditions for when this is relevant.
The first is when your task allows moving back to previous elements; in that case the mixer will keep the mixer elements as they where previously evaluated.
The second condition is when you have a branch that you want to react to live changes (at this time this is relevant only for piQuest answers).</p>
<p>If you want a mixer to react to changes in the environment you need to set <code>remix=true</code>.</p>
<p>The following snippet uses <code>remix</code> to show a second question depending on the response of the first one (in piQuest).</p>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> page = {
    questions: [
        <span class="hljs-comment">// First question</span>
        {
            name: <span class="hljs-symbol">'q1</span>,
            stem: <span class="hljs-symbol">'Please</span> write <span class="hljs-string">"hello"</span>'
        },

        <span class="hljs-comment">// The mixer</span>
        {
            mixer: <span class="hljs-symbol">'branc</span>h',
            remix: <span class="hljs-literal">true</span>,
            conditions: [ {compare: <span class="hljs-symbol">'current</span>.questions.q1', to: <span class="hljs-symbol">'hell</span>o'} ],
            data: [
                <span class="hljs-comment">// Dependent question</span>
                {
                    stem: <span class="hljs-symbol">'You</span> said <span class="hljs-string">"hello"</span>!'
                } 
            ]
        }
    ]
}
</code></pre>
<h4><a name="sequence-evaluation-wrapper" class="header-link" href="#sequence-evaluation-wrapper"><span class="glyphicon glyphicon-link"></span></a>Sequence evaluation (wrapper)</h4><p>Most of the time, mixers are lazily processed. 
This means that the sequencer waits until it reaches the mixer before expanding it.
This behaviour allows us to use branching mixers - we don’t decide which branch to take until we reach it.
The exception to this rule is randomizing mixers (such as <code>randomize</code> or <code>choose</code>), that in order to randomize <em>everything</em> inside them, must pre-mix all their content.</p>
<p>This behaviour may cause some problematic results.
For instance, a branching mixer within a randomization mixer, will be calculated according to the state of the task when it first reaches the randomizer, and not according to the state when it reaches the branch itself.
If you have a randomizer &gt; repeat &gt; randomizer then the repeat will process an already randomized random mixer, and the repeated units will all be the same.
The solution in this case is to wrap the inner mixer within a <a href="#wrapper">wrapper mixer</a> (or set the <code>wrapper</code> property to true).
This way the randomizer will treat anything within the wrapper as a single unit and will not pre-mix it.</p>
<p>Random randomizes the order of all the elements under the random mixer’s data array, even if they are inside a mixer. 
For example, consider the following code:</p>
<pre><code class="lang-js"><span class="hljs-collection">{
    mixer:'random',
    data: <span class="hljs-collection">[
        elem1,
        <span class="hljs-collection">{
            mixer:'repeat',
            times:2,
            data:<span class="hljs-collection">[
                elem2
            ]</span>
        }</span>
    ]</span>
}</span>
</code></pre>
<p>It will form one of the following sequences: </p>
<ul>
<li>[elem1,elem2,elem2]</li>
<li>[elem2,elem1,elem2]</li>
<li>[elem2,elem2,elem1]</li>
</ul>
<p>If you want to keep some of the elements in the data together (and not randomized), use the <code>wrapper</code> mixer. For instance:</p>
<pre><code class="lang-js">var mixer = {
    mixer:<span class="hljs-string">'random'</span>,
    data: [
        ele<span class="hljs-title">m1</span>
        {
            mixer:<span class="hljs-string">'wrapper'</span>,
            data:[
                ele<span class="hljs-title">m2</span>,
                ele<span class="hljs-title">m3</span>,
                ele<span class="hljs-title">m4</span>
            ]
        }
    ]
}
</code></pre>
<p>This code will keep elem2, elem3, and elem4 together, in that same order (elem2, elem3, elem4), and will randomly present elem1 before or after these three objects.</p>
<p>Sometimes you may want to make a mixer be a <code>wrapper</code> enen though it is already another kind of mixer.
You can do that by adding <code>wrapper:true</code>. For example: </p>
<pre><code class="lang-js"><span class="hljs-built_in">var</span> mixer <span class="hljs-subst">=</span> {
    mixer:<span class="hljs-string">'random'</span>,
    <span class="hljs-built_in">data</span>: <span class="hljs-preprocessor">[</span>
        elem1,
        {
            mixer:<span class="hljs-string">'repeat'</span>,
            times:<span class="hljs-number">2</span>,
            wrapper:<span class="hljs-literal">true</span>,
            <span class="hljs-built_in">data</span>:<span class="hljs-preprocessor">[</span>
                elem2,
                elem3
            <span class="hljs-preprocessor">]</span><span class="hljs-markup">
        }
    ]
}</span>
</code></pre>
<p>This code will results in one of the following sequences:</p>
<ul>
<li>[elem1,elem2,elem3,elem2,elem3]</li>
<li>[elem2,elem3,elem2,elem3,elem1]</li>
</ul>
<p>If you want to randomize the order of two lists, and randomize the objects within each list but without mixing the two lists together, the following code will do the trick: </p>
<pre><code class="lang-js">var mixer = {
    mixer:<span class="hljs-string">'random'</span>,
    data: [
        {
            mixer:<span class="hljs-string">'random'</span>,
            wrapper:true,
            data:[ele<span class="hljs-title">m1</span>,ele<span class="hljs-title">m2</span>]
        },
        {
            mixer:<span class="hljs-string">'random'</span>,
            wrapper:true,
            data:[ele<span class="hljs-title">m3</span>,ele<span class="hljs-title">m4</span>]
        }
    ]
}
</code></pre>
<p>This code will create one of the following sequences: </p>
<ul>
<li>[elem1,elem2,elem3,elem4]</li>
<li>[elem1,elem2,elem4,elem3]</li>
<li>[elem2,elem1,elem3,elem4]</li>
<li>[elem2,elem1,elem4,elem3]</li>
<li>[elem3,elem4,elem1,elem2]</li>
<li>[elem4,elem3,elem1,elem2]</li>
<li>[elem3,elem4,elem2,elem1]</li>
<li>[elem4,elem3,elem2,elem1]</li>
</ul>
<p>The following snippet uses the wrapper property to keep the content of the repeat mixer together.
@TODO: find a good example for the use of wrappers.</p>
<pre><code class="lang-js"><span class="hljs-collection">{
    mixer: 'random',
    data: <span class="hljs-collection">[
        elem1,
        <span class="hljs-collection">{
            mixer: 'repeat',
            times: <span class="hljs-number">2</span>,
            wrapper: <span class="hljs-literal">true</span>,
            data: <span class="hljs-collection">[elem2]</span>
        }</span>
    ]</span>
}</span>
</code></pre>
<h3><a name="mixer-types" class="header-link" href="#mixer-types"><span class="glyphicon glyphicon-link"></span></a>Mixer types</h3><h4><a name="repeat" class="header-link" href="#repeat"><span class="glyphicon glyphicon-link"></span></a>repeat</h4><p>Repeats the sub-sequence in <code>data</code> <code>times</code> times.
So that the following mixer:</p>
<pre><code class="lang-js">{
    <span class="hljs-attribute">mixer</span>:<span class="hljs-string">'repeat'</span>, 
    <span class="hljs-attribute">times</span>:<span class="hljs-number">3</span>, 
    <span class="hljs-attribute">data</span>: [elem1,elem2]
}
</code></pre>
<p>Will be transformed into:</p>
<ul>
<li>[elem1,elem2,elem1,elem2,elem1,elem2]</li>
</ul>
<h4><a name="random" class="header-link" href="#random"><span class="glyphicon glyphicon-link"></span></a>random</h4><p>Randomizes the order of elements in <code>data</code>. 
So that the following mixer:</p>
<pre><code class="lang-js">{
    <span class="hljs-attribute">mixer</span>:<span class="hljs-string">'random'</span>,
    <span class="hljs-attribute">data</span>:[elem1,elem2]
}
</code></pre>
<p>Will be transformed into one of the following:</p>
<ul>
<li>[elem1, elem2]</li>
<li>[elem2, elem1]</li>
</ul>
<p>Please note that the <code>random</code> mixer pre-mixes all the content in <code>data</code>, please see <a href="#evaluation">sequence evaluation</a> and the <a href="#wrapper">wrapper mixer</a> for more details and related problems.</p>
<h4><a name="choose" class="header-link" href="#choose"><span class="glyphicon glyphicon-link"></span></a>choose</h4><p>Choose one or more (<code>n</code>) elements out of <code>data</code>.
By default, <code>choose</code> picks a single element form the <code>data</code> subsequence:</p>
<pre><code class="lang-js">{
    mixer:<span class="hljs-string">'choose'</span>,
    data: [ele<span class="hljs-title">m1</span>, ele<span class="hljs-title">m2</span>, ele<span class="hljs-title">m3</span>]
}
</code></pre>
<p>Will be transformed into one of the following:</p>
<ul>
<li>[elem1]</li>
<li>[elem2]</li>
<li>[elem3]</li>
</ul>
<p>You can choose more than one element by setting <code>n</code>:</p>
<pre><code class="lang-js">{
    <span class="hljs-attribute">mixer</span>:<span class="hljs-string">'choose'</span>,
    <span class="hljs-attribute">n</span>: <span class="hljs-number">2</span>,
    <span class="hljs-attribute">data</span>: [elem1, elem2, elem3]
}
</code></pre>
<p>That will return one of the following:</p>
<ul>
<li>[elem1, elem2]</li>
<li>[elem1, elem3]</li>
<li>[elem2, elem3]</li>
</ul>
<h4><a name="weightedchoose" class="header-link" href="#weightedchoose"><span class="glyphicon glyphicon-link"></span></a>weightedChoose</h4><p>Choose one or more (<code>n</code>) elements out of <code>data</code>. Using a weighted random algorithm.
Each element in <code>data</code> is given the appropriate weight from <code>weights</code>.
<code>weightedChoose</code> does inclusive randomization. This means that elements may be picked more than once.</p>
<p>In the following example elem2 has four times the probability of being selected as elem1;</p>
<pre><code class="lang-js">{
    <span class="hljs-attribute">mixer</span>:<span class="hljs-string">'weightedChoose'</span>,
    <span class="hljs-attribute">n</span>: <span class="hljs-number">2</span>,
    <span class="hljs-attribute">weights</span>: [<span class="hljs-number">0.2</span>,<span class="hljs-number">0.8</span>],
    <span class="hljs-attribute">data</span>: [elem1,elem2]}
}
</code></pre>
<p>This code will create one of the following sequences: </p>
<ul>
<li>[elem1,elem1] - 4% of cases</li>
<li>[elem1,elem2] - 16% of cases</li>
<li>[elem2,elem1] - 16% of cases</li>
<li>[elem2,elem2] - 64% of cases</li>
</ul>
<h4><a name="weightedrandom" class="header-link" href="#weightedrandom"><span class="glyphicon glyphicon-link"></span></a>weightedRandom</h4><p>Alias (synonym) that can be used interchangeably with <a href="#weightedChoose"><code>weightedChoose</code></a>.</p>
<h4><a name="wrapper" class="header-link" href="#wrapper"><span class="glyphicon glyphicon-link"></span></a>wrapper</h4><p>The wrapper mixer serves a sort of parenthesis for the mixer.
It is used to keep a sub-sequence of elements to be randomized within one of the randomizing mixers (such as <a href="#random">random</a> or <a href="#choose">choose</a>).
In case you want to keep a sub-sequence as a block (when randomizing) simply wrap them and they’ll stay together.
You can find more use cases in the <a href="#evaluation">sequence evaluation</a> section.</p>
<p>The following snippet uses a wrapper to keep two elements together despite a being in a randomizer;</p>
<pre><code class="lang-js">{
    mixer: <span class="hljs-string">'random'</span>,
    data: [
        ele<span class="hljs-title">m1</span>,
        {
            mixer: <span class="hljs-string">'wrapper'</span>,
            data: [ele<span class="hljs-title">m2</span>, ele<span class="hljs-title">m3</span>]
        }
    ]
}
</code></pre>
<p>It will return one of the following (elem2 and elem3 are always kept together):</p>
<ul>
<li>[elem1, elem2, elem3]</li>
<li>[elem2, elem3, elem1]</li>
</ul>
<p>The wrapper mixer is special in that it has an alternative syntax.
You can add a <code>wrapper</code> property to any existing mixer, and it contents will be treated as if they were wrapped in a wrapper.
This will look like this:</p>
<pre><code class="lang-js">{
    <span class="hljs-attribute">mixer</span>:<span class="hljs-string">'repeat'</span>,
    <span class="hljs-attribute">time</span>:<span class="hljs-number">10</span>,
    <span class="hljs-attribute">wrapper</span>:true,
    <span class="hljs-attribute">data</span>: [elem1]
}
</code></pre>
<h4><a name="branch" class="header-link" href="#branch"><span class="glyphicon glyphicon-link"></span></a>branch</h4><p>The branch mixer allows you to choose the flow of your sequence according to environmental conditions.
You can learn about environmental conditions <a href="./variables.html">here</a> and about how to create conditions <a href="#conditions">here</a>.
This section will deal only with the stucture and use of the <code>branch</code> mixer itself.</p>
<p>The branch mixer evaluates the <code>conditions</code> if they are true it returns the sequence in <code>data</code>, if they are false it returns the sequence in <code>elseData</code>.
If <code>elseData</code> is not defined, or is left empty, then nothing happen in case the conditions are not true (see <a href="#conditions">conditions</a> to learn more about how conditions work).</p>
<p>The following mixer:</p>
<pre><code class="lang-js">{
    <span class="hljs-attribute">mixer</span>:<span class="hljs-string">'branch'</span>,
    <span class="hljs-attribute">conditions</span>:[cond],
    <span class="hljs-attribute">data</span>:[elem1,elem2],
    <span class="hljs-attribute">elseData</span>:[elem3,elem4] <span class="hljs-comment">// optional</span>
}
</code></pre>
<p>Will return</p>
<ul>
<li>[elem1,elem2] - if the condition is true</li>
<li>[elem3,elem4] - if the condition is false</li>
</ul>
<h4><a name="multibranch" class="header-link" href="#multibranch"><span class="glyphicon glyphicon-link"></span></a>multiBranch</h4><p><code>multiBranch</code> is similar to the <a href="#branch"><code>branch</code></a> mixer, only it allows you to switch between a list of conditions instead of only one.
The mixer will attempt to find the first object within the <code>branches</code> array for which <code>conditions</code> is true, and select the sub-sequence in that objects <code>data</code>.
If no object is selected then select the sub-sequence in <code>elseData</code>.</p>
<pre><code class="lang-js"><span class="hljs-collection">{
    mixer: 'multiBranch',
    branches: <span class="hljs-collection">[
        <span class="hljs-collection">{conditions: <span class="hljs-collection">[cond1]</span>,data: <span class="hljs-collection">[elem1]</span>}</span>,
        <span class="hljs-collection">{conditions: <span class="hljs-collection">[cond2]</span>,data: <span class="hljs-collection">[elem2]</span>}</span>
    ]</span>,
    elseData: <span class="hljs-collection">[elem3]</span> // optional
}</span>
</code></pre>
<p>Will return</p>
<ul>
<li>[elem1] - if cond1 is true</li>
<li>[elem2] - if cond2 is true (but not cond1)</li>
<li>[elem3] - if both cond1 and cond2 are false</li>
</ul>
<h4><a name="custom" class="header-link" href="#custom"><span class="glyphicon glyphicon-link"></span></a>custom</h4><p><code>custom</code> allows you to create arbitrary sub-sequences.
It uses the sub-sequence that is returned from the <code>fn</code> function.
<code>fn</code> must return an array of elements.</p>
<p><code>fn</code> has two arguments available: the mixer object itself, and the mixer context (as defined <a href="./variables.html">here</a>).
You can either use them to create your elments or create elements arbitrarily.</p>
<p>``js
{
    mixer: ‘custom’,
    prop: ‘Custom property’
    fn: function(obj, context){
        return [elem1, elem2]
    }
}</p>
<pre><code>### Conditions
The conditional mixers ([`branch`](#branch) &amp; [`multiBranch`](#multibranch)) allow you to <span class="hljs-operator"><span class="hljs-keyword">change</span> the content <span class="hljs-keyword">of</span> your sequence depending <span class="hljs-keyword">on</span> [environmental <span class="hljs-keyword">variables</span>](./<span class="hljs-keyword">variables</span>.html). 
This <span class="hljs-keyword">is</span> done <span class="hljs-keyword">by</span> settings <span class="hljs-string">`conditions`</span>.
A condition <span class="hljs-keyword">is</span> a statement that <span class="hljs-keyword">is</span> evaluated either <span class="hljs-keyword">as</span> <span class="hljs-string">`true`</span> <span class="hljs-keyword">or</span> <span class="hljs-string">`false`</span>.
We <span class="hljs-keyword">choose</span> the branch we advance <span class="hljs-keyword">to</span> according <span class="hljs-keyword">to</span> the result.
You can think <span class="hljs-keyword">of</span> <span class="hljs-keyword">each</span> condition <span class="hljs-keyword">as</span> an equation that compares two <span class="hljs-keyword">values</span>.
Conditions <span class="hljs-keyword">are</span> <span class="hljs-keyword">each</span> represented <span class="hljs-keyword">by</span> an object <span class="hljs-keyword">as</span> follows:

Property        | Description
<span class="hljs-comment">--------------- | -------------------</span>
compare         | The <span class="hljs-keyword">left</span> side <span class="hljs-keyword">of</span> the equation.
<span class="hljs-keyword">to</span>              | The <span class="hljs-keyword">right</span> side <span class="hljs-keyword">of</span> the equation.
operator        | The type <span class="hljs-keyword">of</span> comparison <span class="hljs-keyword">to</span> <span class="hljs-keyword">do</span> (defaults <span class="hljs-keyword">to</span> <span class="hljs-string">'equals'</span>. <span class="hljs-keyword">Read</span> more about operators [here](#operators)).

The <span class="hljs-keyword">values</span> <span class="hljs-keyword">set</span> <span class="hljs-keyword">into</span> <span class="hljs-string">`compare`</span> <span class="hljs-keyword">and</span> <span class="hljs-string">`to`</span> can be <span class="hljs-keyword">set</span> either <span class="hljs-keyword">as</span> plain <span class="hljs-keyword">values</span> <span class="hljs-keyword">or</span> <span class="hljs-keyword">as</span> <span class="hljs-keyword">references</span> <span class="hljs-keyword">to</span> environmental <span class="hljs-keyword">variables</span>:
<span class="hljs-keyword">When</span> you want <span class="hljs-keyword">to</span> reference an environmental variable, you <span class="hljs-keyword">use</span> <span class="hljs-built_in">text</span> <span class="hljs-keyword">with</span> dots: <span class="hljs-string">`global.var`</span>, <span class="hljs-string">`questions.q1.response`</span>
(questions.q1.response<span class="hljs-string">` will retrieve the value of the response for q1 from the questions object).

The following condition object `</span>compare<span class="hljs-string">'s **global.var** `to` **current.otherVar** and checks if they are equal.
It is equivalent to the following equation: `global.myVar === current.myOtherVar`.

```js
var cond = {
    compare: '</span><span class="hljs-keyword">global</span>.myVar<span class="hljs-string">',
    to: '</span><span class="hljs-keyword">current</span>.myOtherVar<span class="hljs-string">'
}</span></span>
</code></pre><p>Here are some examples of comparing variables with plain values:</p>
<pre><code class="lang-js">//Compares the variable time to the value 12
var cond1 = {
    compare: 'global.time',
    to: '12'
}

//Compare the variable <span class="hljs-keyword">gender</span> to the value 'Female'
var cond2 = {
    compare: 'Female',
    to: 'local.<span class="hljs-keyword">gender</span>'
}
</code></pre>
<p>Sometimes the standard conditions are not enough.
More advanced users may want to replace the whole condition object with a custom function that returns true or false. 
The context (<code>this</code>) for the function is an object holding the <em>global</em> and <em>current</em> objects 
(there are some cases where additional properties are available, they are documented in their own docs).</p>
<pre><code class="lang-js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">cond</span><span class="hljs-params">()</span></span>{
    <span class="hljs-keyword">var</span> <span class="hljs-keyword">global</span> = this.<span class="hljs-keyword">global</span>; <span class="hljs-comment">// get the global from the context</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">global</span>.skip;
}
</code></pre>
<h4><a name="operators" class="header-link" href="#operators"><span class="glyphicon glyphicon-link"></span></a>Operators</h4><p>The default comparison for a condition is to check equality (supports comparison of objects and arrays too). You can use the <code>operator</code> property to change the comparison method. The following checks if var is greater than otherVar:</p>
<pre><code class="lang-js">var cond = {
    compare: <span class="hljs-symbol">'global</span>.var',
    <span class="hljs-keyword">to</span>: <span class="hljs-symbol">'local</span>.otherVar',
    operator: <span class="hljs-symbol">'greaterThan'</span>
}
</code></pre>
<table>
<thead>
<tr>
<th>Operator</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>equals</td>
<td>This is the default operator. It checks if <em>compare</em> is equal to <em>to</em> (supports comparison of objects and arrays too)</td>
</tr>
<tr>
<td>exactly</td>
<td>Checks if <em>compare</em> is exactly equal to <em>to</em> (uses ===)</td>
</tr>
<tr>
<td>greaterThan</td>
<td><em>compare</em> &gt; <em>to</em></td>
</tr>
<tr>
<td>greaterThanOrEquals</td>
<td><em>compare</em> &gt;= <em>to</em></td>
</tr>
<tr>
<td>in</td>
<td><em>compare</em> is in the Array <em>to</em>;</td>
</tr>
<tr>
<td>function(){}</td>
<td>This operator allows you to use a custom function of the form: <code>function(compareValue, toValue, context){return {Boolean}}</code>. The context is an object holding the <em>global</em>, <em>current</em> and <em>questions</em> objects.</td>
</tr>
</tbody>
</table>
<h4><a name="aggregation" class="header-link" href="#aggregation"><span class="glyphicon glyphicon-link"></span></a>Aggregation</h4><p>Sometimes you will want a branch to be activated only if more than one condition is true, or in some other complex specific condition.
For cases like this, the mixer supports aggregation.
The mixer supports applying logical operations on conditions in the following way:</p>
<p>An aggregator object has a single property, denoting the type of aggregation, holding an array of conditions to aggregate.
The following condition will only be true if <code>cond1</code> and <code>cond2</code> are both true:</p>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> cond = {<span class="hljs-keyword">and</span>:[cond1, cond2]};
</code></pre>
<p>The mixer supports several types of aggregators:</p>
<table>
<thead>
<tr>
<th>Aggregator</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>and</td>
<td>If all conditions are true</td>
</tr>
<tr>
<td>or</td>
<td>If at least one condition is true</td>
</tr>
<tr>
<td>nor</td>
<td>If all conditions are false</td>
</tr>
<tr>
<td>nand</td>
<td>If at least one condition is false</td>
</tr>
</tbody>
</table>
<p>By default, if the mixer runs into an array instead of an object, it will treat it as an <code>and</code> aggregator and be true only if all conditions within the array are true.</p>
<p>Following are several examples for how to create different aggregations:</p>
<pre><code class="lang-js"><span class="hljs-comment">// cond1 &amp;&amp; cond2</span>
<span class="hljs-variable"><span class="hljs-keyword">var</span> conds</span> = [cond1, cond2];

<span class="hljs-comment">// cond1 &amp;&amp; (cond2 || cond3)</span>
<span class="hljs-variable"><span class="hljs-keyword">var</span> conds</span> = [cond1, {or:[cond2,cond3]}];

<span class="hljs-comment">// (cond1 &amp;&amp; cond2) || cond2</span>
<span class="hljs-variable"><span class="hljs-keyword">var</span> conds</span> = [{or:[{and:[cond1,cond2]},cond3]}]
</code></pre>
<h4><a name="debugging" class="header-link" href="#debugging"><span class="glyphicon glyphicon-link"></span></a>Debugging</h4><p>Conditions are notoriously difficult to get just right.
If they aren’t working as you expected, you might want to see exactly which values you are getting for each of your conditions.
The mixer provides you with an easy way to do this. Just set <code>DEBUG=true</code> on your condition, and you will see all the said values being printed into your <a href="../basics/javascript.html#errors-and-debugging">console</a>.</p>
<pre><code class="lang-js"><span class="hljs-type">API</span>.addGlobal({
    <span class="hljs-keyword">value</span>: <span class="hljs-number">123</span>,
    otherVar: <span class="hljs-number">345</span>
});

var cond = {
    compare: <span class="hljs-symbol">'global</span>.var',
    <span class="hljs-keyword">to</span>: <span class="hljs-symbol">'global</span>.otherVar',
    <span class="hljs-type">DEBUG</span>: <span class="hljs-literal">true</span>
}
</code></pre>
<p>The debugger will log something like <code>Conditions: 123 equals 345</code> as well as the full condition object as it appears in your code.</p>


				</div>

				<div class="col-md-3" role="complementary">
					<nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm">

						

						

						

						<ul class="nav bs-docs-sidenav">
						

							
							<li class="">
							<li class="">

								<a href="../basics/overview.html">Overview</a>
							</li>
						
							
							<li class="">
							<li class="">

								<a href="../basics/javascript.html">Javascript</a>
							</li>
						
							
							<li class="">
							<li class="">

								<a href="../basics/create.html">Creating a task</a>
							</li>
						
                            <li>
								<a href="../sequencer/introduction.html">Sequencer</a>
                                <ul class="nav">
									
							<li class="">
                                <a href="../sequencer/introduction.html">Introduction</a>
							</li>
						
									
							<li class=" active ">
                                <a href="../sequencer/mixer.html">Mixer</a>
							</li>
						
									
							<li class="">
                                <a href="../sequencer/templates.html">Templates</a>
							</li>
						
									
							<li class="">
                                <a href="../sequencer/variables.html">Variables</a>
							</li>
						
									
							<li class="">
                                <a href="../sequencer/inheritance.html">Inheritance</a>
							</li>
						
                                </ul>
                            </li>
							
							<li class="">
							<li class="">

								<a href="../basics/API.html">API</a>
							</li>
						
							
							<li class="">
							<li class="">

								<a href="../basics/resources.html">Resources</a>
							</li>
						

							<li>
								<a href="javascript:void(0)">Inheritance</a>
								<ul class="nav">
									
							<li class="">
								<div>
									<a href="../basics/inheritanceAbstractionDocco.html">Abstraction</a>
									<a href="../basics/inheritanceAbstraction.js" download="../basics/inheritanceAbstraction.js" title="Download"><span class="glyphicon glyphicon-download"></span></a>
									<a href="../basics/inheritanceAbstractionPlay.html" title="Play"><span class="glyphicon glyphicon-play-circle"></span></a>
								</div>
							</li>
						
									
							<li class="">
								<div>
									<a href="../basics/inheritanceRandomDocco.html">Random</a>
									<a href="../basics/inheritanceRandom.js" download="../basics/inheritanceRandom.js" title="Download"><span class="glyphicon glyphicon-download"></span></a>
									<a href="../basics/inheritanceRandomPlay.html" title="Play"><span class="glyphicon glyphicon-play-circle"></span></a>
								</div>
							</li>
						
									
							<li class="">
								<div>
									<a href="../basics/inheritanceExRandomDocco.html">Exclusive Random</a>
									<a href="../basics/inheritanceExRandom.js" download="../basics/inheritanceExRandom.js" title="Download"><span class="glyphicon glyphicon-download"></span></a>
									<a href="../basics/inheritanceExRandomPlay.html" title="Play"><span class="glyphicon glyphicon-play-circle"></span></a>
								</div>
							</li>
						
									
							<li class="">
								<div>
									<a href="../basics/inheritanceSequentialDocco.html">Sequential</a>
									<a href="../basics/inheritanceSequential.js" download="../basics/inheritanceSequential.js" title="Download"><span class="glyphicon glyphicon-download"></span></a>
									<a href="../basics/inheritanceSequentialPlay.html" title="Play"><span class="glyphicon glyphicon-play-circle"></span></a>
								</div>
							</li>
						
									
							<li class="">
								<div>
									<a href="../basics/inheritanceByDataDocco.html">By Data</a>
									<a href="../basics/inheritanceByData.js" download="../basics/inheritanceByData.js" title="Download"><span class="glyphicon glyphicon-download"></span></a>
									<a href="../basics/inheritanceByDataPlay.html" title="Play"><span class="glyphicon glyphicon-play-circle"></span></a>
								</div>
							</li>
						
									
							<li class="">
								<div>
									<a href="../basics/inheritanceCustomDocco.html">Custom</a>
									<a href="../basics/inheritanceCustom.js" download="../basics/inheritanceCustom.js" title="Download"><span class="glyphicon glyphicon-download"></span></a>
									<a href="../basics/inheritanceCustomPlay.html" title="Play"><span class="glyphicon glyphicon-play-circle"></span></a>
								</div>
							</li>
						

									
							<li class="">
								<div>
									<a href="../basics/inheritanceSeedDocco.html">Seed</a>
									<a href="../basics/inheritanceSeed.js" download="../basics/inheritanceSeed.js" title="Download"><span class="glyphicon glyphicon-download"></span></a>
									<a href="../basics/inheritanceSeedPlay.html" title="Play"><span class="glyphicon glyphicon-play-circle"></span></a>
								</div>
							</li>
						
									
							<li class="">
								<div>
									<a href="../basics/inheritanceRepeatDocco.html">Repeat</a>
									<a href="../basics/inheritanceRepeat.js" download="../basics/inheritanceRepeat.js" title="Download"><span class="glyphicon glyphicon-download"></span></a>
									<a href="../basics/inheritanceRepeatPlay.html" title="Play"><span class="glyphicon glyphicon-play-circle"></span></a>
								</div>
							</li>
						
								</ul>
							</li>

							<li>
								<a href="javascript:void(0)">Mixers</a>
								<ul class="nav">
									
							<li class="">
								<div>
									<a href="../basics/mixerRandomDocco.html">Random</a>
									<a href="../basics/mixerRandom.js" download="../basics/mixerRandom.js" title="Download"><span class="glyphicon glyphicon-download"></span></a>
									<a href="../basics/mixerRandomPlay.html" title="Play"><span class="glyphicon glyphicon-play-circle"></span></a>
								</div>
							</li>
						
									
							<li class="">
								<div>
									<a href="../basics/mixerRepeatDocco.html">Repeat</a>
									<a href="../basics/mixerRepeat.js" download="../basics/mixerRepeat.js" title="Download"><span class="glyphicon glyphicon-download"></span></a>
									<a href="../basics/mixerRepeatPlay.html" title="Play"><span class="glyphicon glyphicon-play-circle"></span></a>
								</div>
							</li>
						
									
							<li class="">
								<div>
									<a href="../basics/mixerWeightedRandomDocco.html">Weighted Random</a>
									<a href="../basics/mixerWeightedRandom.js" download="../basics/mixerWeightedRandom.js" title="Download"><span class="glyphicon glyphicon-download"></span></a>
									<a href="../basics/mixerWeightedRandomPlay.html" title="Play"><span class="glyphicon glyphicon-play-circle"></span></a>
								</div>
							</li>
						
									
							<li class="">
								<div>
									<a href="../basics/mixerChooseDocco.html">Choose</a>
									<a href="../basics/mixerChoose.js" download="../basics/mixerChoose.js" title="Download"><span class="glyphicon glyphicon-download"></span></a>
									<a href="../basics/mixerChoosePlay.html" title="Play"><span class="glyphicon glyphicon-play-circle"></span></a>
								</div>
							</li>
						
									
							<li class="">
								<div>
									<a href="../basics/mixerWrapperDocco.html">Wrapper</a>
									<a href="../basics/mixerWrapper.js" download="../basics/mixerWrapper.js" title="Download"><span class="glyphicon glyphicon-download"></span></a>
									<a href="../basics/mixerWrapperPlay.html" title="Play"><span class="glyphicon glyphicon-play-circle"></span></a>
								</div>
							</li>
						
									
							<li class="">
								<div>
									<a href="../basics/mixerBranchDocco.html">Branch</a>
									<a href="../basics/mixerBranch.js" download="../basics/mixerBranch.js" title="Download"><span class="glyphicon glyphicon-download"></span></a>
									<a href="../basics/mixerBranchPlay.html" title="Play"><span class="glyphicon glyphicon-play-circle"></span></a>
								</div>
							</li>
						
									
							<li class="">
								<div>
									<a href="../basics/mixerMultiBranchDocco.html">Multi Branch</a>
									<a href="../basics/mixerMultiBranch.js" download="../basics/mixerMultiBranch.js" title="Download"><span class="glyphicon glyphicon-download"></span></a>
									<a href="../basics/mixerMultiBranchPlay.html" title="Play"><span class="glyphicon glyphicon-play-circle"></span></a>
								</div>
							</li>
						
								</ul>
							</li>

							<li>
								<a href="javascript:void(0)">Variables & Templates</a>
								<ul class="nav">
									
							<li class="">
								<div>
									<a href="../basics/templateGlobalDocco.html">Global</a>
									<a href="../basics/templateGlobal.js" download="../basics/templateGlobal.js" title="Download"><span class="glyphicon glyphicon-download"></span></a>
									<a href="../basics/templateGlobalPlay.html" title="Play"><span class="glyphicon glyphicon-play-circle"></span></a>
								</div>
							</li>
						
									
							<li class="">
								<div>
									<a href="../basics/templateDataDocco.html">Data</a>
									<a href="../basics/templateData.js" download="../basics/templateData.js" title="Download"><span class="glyphicon glyphicon-download"></span></a>
									<a href="../basics/templateDataPlay.html" title="Play"><span class="glyphicon glyphicon-play-circle"></span></a>
								</div>
							</li>
						
									
							<li class="">
								<div>
									<a href="../basics/templateMetaDocco.html">Meta</a>
									<a href="../basics/templateMeta.js" download="../basics/templateMeta.js" title="Download"><span class="glyphicon glyphicon-download"></span></a>
									<a href="../basics/templateMetaPlay.html" title="Play"><span class="glyphicon glyphicon-play-circle"></span></a>
								</div>
							</li>
						
								</ul>
							</li>

						
						</ul>
						<!-- <a class="back-to-top" href="#top">
							Back to top
						</a> -->
					</nav>
				</div>
			</div>
		</div>

		<!-- Footer
		================================================== -->
		<footer class="bs-docs-footer" role="contentinfo">
			<div class="container">
				<p>Created by Project Implicit for the benefit of all.</p>
				<!-- <p>Code licensed under <a href="https://github.com/twbs/bootstrap/blob/master/LICENSE" target="_blank">MIT</a>, documentation under <a href="http://creativecommons.org/licenses/by/3.0/">CC BY 3.0</a>.</p> -->
				<ul class="bs-docs-footer-links text-muted">
					<li>Currently v0.0.45</li>
					<li>&middot;</li>
					<li><a href="https://github.com/ProjectImplicit/PIquest">GitHub</a></li>
					<li>&middot;</li>
					<li><a href="https://github.com/ProjectImplicit/PIquest/releases">Releases</a></li>
				</ul>
			</div>
		</footer>

        <script>
            (function(){
                var select = document.getElementById('version-select');
                select.addEventListener('change', function(event){
                    var version = event.target.value;
                    location.href = location.href.replace(/[0-9]\.[0-9]/, version)
                });
            })();
        </script>
	</body>
</html>
